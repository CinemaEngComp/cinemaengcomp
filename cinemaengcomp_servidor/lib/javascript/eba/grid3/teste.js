function EBAClipboard(){ this.m_Timer=new Timer(); this.m_OnAfterPaste=null; this.IF=window.document.createElement("\u0049F\u0052AME"); this.IF.src="java\u0073crip\u0074\u003at\u0072u\u0065"; this.IF.name="\u0065b\u0061clipb\u006f\u0061rd"; this.IF.id="\u0065\u0062a\u0063l\u0069p\u0062\u006fard"; this.IF.style.position="a\u0062\u0073\u006flut\u0065"; this.IF.style.top=-500; this.IF.style.left=-500; this.IF.width=100; this.IF.height=100; document.body.appendChild(this.IF); var oF=window.frames["eb\u0061cli\u0070bo\u0061r\u0064"]; var oD=oF.window.document; oD.open(); var _3="<style>body {\n"; _3+="\tbackground: #FFFFFF;\n"; _3+="\tmargin: 0px;\n"; _3+="\tpadding: 0px;\n"; _3+="}\n"; _3+="</style>\n"; oD.write("<h\u0074\u006dl><h\u0065a\u0064>"+_3+"\u003c\u002fhea\u0064\u003e\u003cb\u006fdy><\u002f\u0062\u006fdy\u003e\u003c/h\u0074\u006dl\u003e"); oD.close(); oD.designMode="\u004fn"; } EBAClipboard.prototype.GetHtml=function(){ try{ return document.getElementById("\u0065ba\u0063\u006c\u0069\u0070\u0062\u006far\u0064").contentWindow.document.body.innerHTML; } catch(err){ return null; } }; EBAClipboard.prototype.TrapCtrlV=function(_4){ if(_4.addEventListener){ _4.addEventListener("k\u0065y\u0064\u006fwn",this.OnKeyDownHandler,false); } if(_4.attachEvent){ _4.attachEvent("\u006fn\u006be\u0079do\u0077\u006e",this.OnKeyDownHandler); } }; EBAClipboard.prototype.CapturePasteEvent=function(){ var _5; if(!gIE){ _5=document.getElementById("\u0065b\u0061\u0063l\u0069pb\u006f\u0061rd").contentWindow; }else{ _5=window.frames["eba\u0063\u006c\u0069\u0070b\u006f\u0061r\u0064"]; } _5.document.body.innerHTML=""; _5.focus(); window.setTimeout("ev\u0061l('g_\u0045\u0062aCl\u0069\u0070b\u006f\u0061rd.C\u0061\u0070t\u0075reHtmlP\u0061\u0073teDa\u0074\u0061(\u0029\u0027\u0029",0); }; EBAClipboard.prototype.CaptureHtmlPasteData=function(){ g_EbaClipboard.m_OnAfterPaste(); g_EbaClipboard.m_Timer.Stop("P\u0061s\u0074\u0065"); }; EBAClipboard.prototype.OnKeyDownHandler=function(e){ e=e?e:window.event; if(e.keyCode==86&&e.ctrlKey){ g_EbaClipboard.m_Timer.Start("P\u0061st\u0065"); g_EbaClipboard.CapturePasteEvent(); } }; Function.prototype.method=function(_7,_8){ this.prototype[_7]=_8; return this; }; Function.method("\u0069\u006e\u0068\u0065r\u0069\u0074\u0073",function(parent){ var d=0,p=(this.prototype=new parent()); this.method("ub\u0065\u0072",function uber(_a){ var f,r,t=d,v=parent.prototype; if(t){ while(t){ v=v.constructor.prototype; t-=1; } f=v[_a]; }else{ f=p[_a]; if(f==this[_a]){ f=v[_a]; } } d+=1; r=f.apply(this,Array.prototype.slice.apply(arguments,[1])); d-=1; return r; }); return this; }); Function.method("\u0073wis\u0073",function(parent){ for(var i=1;i<arguments.length;i+=1){ var _d=arguments[i]; this.prototype[_d]=parent.prototype[_d]; } return this; }); if(typeof (Eba)=="\u0075\u006ede\u0066ined"){ Eba={}; } var Class={create:function(){ return function(){ this.initialize.apply(this,arguments); }; }}; var EBAGlobal=Class.create(); EBAGlobal.prototype={initialize:function(){ this.MOZ=(document.implementation&&document.implementation.createDocument)?true:false; this.IE=(window.ActiveXObject)?true:false; }}; Extend=function(_e,_f){ for(property in _f){ if(_e[property]==null){ _e[property]=_f[property]; }else{ _e["\u0062\u0061\u0073e"+property]=_e[property]; _e[property]=_f[property]; } } return _e; }; Eba.Class={create:function(_10){ return function(){ this.initialize.apply(this,arguments); }; }}; Eba.Extend=function(parent,child){ parent=parent.prototype; for(property in parent){ if(child[property]==null){ child[property]=parent[property]; }else{ child["u\u0062e\u0072\u005f"+property]=parent[property]; } } return child; }; Function.prototype.method=function(_11,_12){ this.prototype[_11]=_12; return this; }; Function.method("i\u006ehe\u0072\u0069ts",function(parent){ var d=0,p=(this.prototype=new parent()); this.method("u\u0062e\u0072",function uber(_14){ var f,r,t=d,v=parent.prototype; if(t){ while(t){ v=v.constructor.prototype; t-=1; } f=v[_14]; }else{ f=p[_14]; if(f==this[_14]){ f=v[_14]; } } d+=1; r=f.apply(this,Array.prototype.slice.apply(arguments,[1])); d-=1; return r; }); return this; }); Function.method("\u0073wis\u0073",function(parent){ for(var i=1;i<arguments.length;i+=1){ var _17=arguments[i]; this.prototype[_17]=parent.prototype[_17]; } return this; }); if(typeof (Eba)=="\u0075\u006e\u0064ef\u0069\u006e\u0065\u0064"){ Eba={}; } if(typeof (Eba.Xml)=="\u0075n\u0064\u0065\u0066\u0069\u006eed"){ Eba.Xml={}; } if(typeof (IE)=="\u0075n\u0064\u0065\u0066\u0069n\u0065\u0064"&&window.ActiveXObject){ var IE=true; var MOZ=false; } if(typeof (MOZ)=="\u0075\u006ede\u0066i\u006eed"&&document.implementation.createDocument){ var IE=false; var MOZ=true; } if(IE){ var inUse=false; Eba.Xml.XslTemplate=new ActiveXObject("MS\u0058M\u004c2.X\u0053L\u0054e\u006dp\u006ca\u0074e.\u0033.0"); } if(MOZ){ Eba.Xml.Serializer=new XMLSerializer(); } if(!IE&&!MOZ){ alert("EB\u0041\u0020X\u004dL\u0020libr\u0061\u0072y \u0069\u0073 \u006e\u006f\u0074 \u0073\u0075\u0070porte\u0064 in\u0020\u0079\u006fur \u0062\u0072\u006fw\u0073\u0065\u0072"); } if(IE){ Eba.Xml.createXmlDoc=function(str){ var doc=new ActiveXObject("Msxm\u006c\u0032\u002e\u0044O\u004d\u0044\u006f\u0063u\u006dent.3.\u0030"); doc.async=false; doc.loadXML(str||""); doc.setProperty("\u0053e\u006ce\u0063t\u0069\u006f\u006eN\u0061mespa\u0063e\u0073","x\u006d\u006c\u006es\u003a\u0065ba='htt\u0070:\u002f\u002fw\u0077\u0077\u002e\u0065\u0062usi\u006e\u0065s\u0073a\u0070p\u006c\u0069\u0063ati\u006f\u006e\u0073\u002e\u0063a\u002f\u0065\u0062\u0061\u0067\u0072\u0069\u0064#\u0027"); return doc; }; }else{ if(MOZ){ Eba.Xml.createXmlDoc=function(str){ var doc=document.implementation.createDocument("","",null); doc.async=false; doc.loadXML(str||""); return doc; }; } } if(IE){ Eba.Xml.createXslDoc=function(xsl){ var doc=new ActiveXObject("\u004d\u0053\u0058\u004d\u004c2.F\u0072\u0065eT\u0068\u0072\u0065\u0061\u0064\u0065d\u0044\u004fMDocu\u006d\u0065\u006e\u0074.3\u002e0"); doc.loadXML(xsl||""); return doc; }; }else{ if(MOZ){ Eba.Xml.createXslDoc=function(xsl){ var doc=Eba.Xml.createXmlDoc(); doc.loadXML(xsl||""); return doc; }; } } if(IE){ Eba.Xml.createXslProcessor=function(xsl){ var _21; if(typeof (xsl)=="\u0073tr\u0069n\u0067"){ _21=new ActiveXObject("\u004d\u0053XML\u0032.F\u0072eeT\u0068\u0072e\u0061de\u0064DOMD\u006f\u0063\u0075\u006d\u0065n\u0074\u002e\u0033\u002e0"); _21.loadXML(xsl||""); }else{ _21=new ActiveXObject("\u004dS\u0058\u004d\u004c\u0032.\u0046reeThr\u0065a\u0064\u0065d\u0044\u004f\u004d\u0044\u006f\u0063ume\u006et.3\u002e\u0030"); _21.loadXML(xsl.xml); } var xt=new ActiveXObject("\u004d\u0053X\u004dL2\u002e\u0058SLT\u0065m\u0070late\u002e3\u002e\u0030"); xt.stylesheet=_21; var _23=xt.createProcessor(); return _23; }; }else{ if(MOZ){ Eba.Xml.createXslProcessor=function(xsl){ if(typeof (xsl)=="u\u006ed\u0065f\u0069ne\u0064"){ xsl=""; } var _25=xsl; if(typeof (xsl)=="st\u0072\u0069n\u0067"){ _25=Eba.Xml.xmlDocFromString(xsl); } var _26=new XSLTProcessor(); _26.importStylesheet(_25); return _26; }; } } if(IE){ Eba.Xml.transform=function(xml,xsl){ try{ if(typeof (xsl.xml)=="\u0073\u0074ring"){ return xml.transformNode(xsl); }else{ xsl.input=xml; xsl.transform(); return xsl.output; } } catch(e){ alert("\u0043a\u006e\u006eo\u0074 \u0074r\u0061\u006e\u0073\u0066\u006fr\u006d "+xml.xml+"\u0020\u0075\u0073\u0069n\u0067\u0020the "+xsl.xml+"\u0020\u0073\u0074ylesh\u0065\u0065\u0074\u002e\u0020"); } }; }else{ if(MOZ){ Eba.Xml.transform=function(xml,xsl){ try{ var _2b=xsl; if(xsl.documentElement){ _2b=Eba.Xml.createXslProcessor(xsl); } return _2b.transformToDocument(xml); } catch(e){ alert(e.message); } }; } } if(IE){ Eba.Xml.transformToString=function(xml,xsl){ return Eba.Xml.transform(xml,xsl); }; }else{ if(MOZ){ Eba.Xml.transformToString=function(xml,xsl,_30){ var doc=Eba.Xml.transform(xml,xsl); var s=""; if(_30=="\u0078\u006d\u006c"){ s=Eba.Xml.Serializer.serializeToString(doc); }else{ s=doc.documentElement.childNodes[0].data; } return s; }; } } if(IE){ Eba.Xml.transformToXml=function(xml,xsl){ return Eba.Xml.createXmlDoc(Eba.Xml.transform(xml,xsl)); }; }else{ if(MOZ){ Eba.Xml.transformToXml=function(xml,xsl){ var _37=Eba.Xml.transform(xml,xsl); if(_37.documentElement.nodeName=="\u0074r\u0061n\u0073f\u006frm\u0069\u0069\u0078:\u0072es\u0075\u006c\u0074"){ _37=Eba.Xml.xmlDocFromString(_37.documentElement.firstChild.data); } return _37; }; } } if(IE){ Eba.Xml.xmlDocFromString=function(str){ var doc=new ActiveXObject("Msx\u006dl\u0032.DOM\u0044ocu\u006d\u0065\u006et\u002e\u0033\u002e\u0030"); doc.loadXML(str); return doc; }; }else{ if(MOZ){ Eba.Xml.xmlDocFromString=function(str){ var _3b=new DOMParser(); return _3b.parseFromString(str,"\u0074ex\u0074\u002fxm\u006c"); }; } } if(IE){ Eba.Xml.xslDocFromString=function(str){ var doc=new ActiveXObject("\u004d\u0073xm\u006c\u0032\u002e\u0046re\u0065Th\u0072e\u0061de\u0064DO\u004dD\u006fcum\u0065nt\u002e3\u002e0"); doc.loadXML(str); return doc; }; }else{ if(MOZ){ Eba.Xml.xslDocFromString=function(str){ alert("xslDoc\u0046\u0072\u006fmS\u0074r\u0069ng\u0020\u006e\u006ft \u0069\u006d\u0070\u006ce\u006d\u0065n\u0074\u0065d \u0066\u006fr M\u006fzi\u006cl\u0061"); }; } } if(IE){ Eba.Xml.createXmlHttp=function(){ var _3f=null; try{ _3f=new ActiveXObject("\u004d\u0073\u0078m\u006c2.\u0058\u004dL\u0048TTP"); } catch(e){ try{ _3f=new ActiveXObject("Mi\u0063\u0072oso\u0066t\u002eXMLH\u0054\u0054\u0050"); } catch(ee){ } } return _3f; }; }else{ if(MOZ){ Eba.Xml.createXmlHttp=function(){ return new XMLHttpRequest(); }; } } if(MOZ){ Document.prototype.loadXML=function(_40){ var _41=new DOMParser().parseFromString(_40,"\u0074\u0065x\u0074/x\u006d\u006c"); while(this.hasChildNodes()){ this.removeChild(this.firstChild); } for(var i=0;i<_41.childNodes.length;i++){ this.appendChild(this.importNode(_41.childNodes[i],true)); } _41=null; }; Document.prototype.__defineGetter__("\u0078\u006d\u006c",function(){ return (new XMLSerializer()).serializeToString(this); }); Node.prototype.__defineGetter__("x\u006d\u006c",function(){ return (new XMLSerializer()).serializeToString(this); }); XSLTProcessor.prototype.__defineSetter__("\u0073t\u0079\u006cesh\u0065e\u0074",function(_43){ this.stylesheet=_43; }); XSLTProcessor.prototype.__defineSetter__("\u0069npu\u0074",function(_44){ this.xml=_44; }); XSLTProcessor.prototype.__defineGetter__("\u006f\u0075\u0074\u0070\u0075\u0074",function(){ return this.xslOutput; }); XSLTProcessor.prototype.transform=function(_45){ var _46=this.transformToFragment(this.xml,eba_ownerDocument); var _47=document.createElement("d\u0069v"); _47.appendChild(_46); this.xslOutput=_47.innerHTML; }; XSLTProcessor.prototype.createProcessor=function(){ this.importStylesheet(this.stylesheet); }; XPathResult.prototype.__defineGetter__("l\u0065ng\u0074\u0068",function(){ return this.snapshotLength; }); XSLTProcessor.prototype.addParameter=function(_48,_49,_4a){ this.setParameter(_4a,_48,_49); }; XMLDocument.prototype.selectNodes=function(_4b,_4c){ try{ var _4d=this.evaluate(_4b,(_4c?_4c:this),this.createNSResolver(this.documentElement),XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null); var _4e=new Array(); _4e.expr=_4b; var j=0; for(i=0;i<_4d.snapshotLength;i++){ var _50=_4d.snapshotItem(i); if(_50.nodeType!=3){ _4e[j++]=_50; } } return _4e; } catch(e){ } }; Element.prototype.selectNodes=function(_51){ var doc=this.ownerDocument; return doc.selectNodes(_51,this); }; Element.prototype.__defineGetter__("fir\u0073t\u004eo\u006eT\u0065\u0078\u0074\u0043hi\u006cd",function(){ var i=0; while(i<this.childNodes.length&&this.childNodes[i].nodeType==3){ i++; } return this.childNodes[i]; }); XMLDocument.prototype.selectSingleNode=function(_54,_55){ var ctx=_55?_55:null; var _57=_54.match(/\[\d+\]/ig); if(_57!=null){ var x=_57[_57.length-1]; if(_54.lastIndexOf(x)+x.length!=_54.length){ _54+="[\u0031\u005d"; } } var _59=this.selectNodes(_54,ctx); if(_59.length>0){ return _59[0]; }else{ return null; } }; Element.prototype.selectSingleNode=function(_5a){ var doc=this.ownerDocument; return doc.selectSingleNode(_5a,this); }; Document.prototype.createStyleSheet=function(){ var _5c=this.createElement("st\u0079le"); this.documentElement.childNodes[0].appendChild(_5c); return _5c; }; HTMLStyleElement.prototype.__defineSetter__("\u0063ss\u0054ext",function(_5d){ this.innerHTML=_5d; }); } if(document.implementation.createDocument){ Event.prototype.__defineGetter__("\u0073\u0072cE\u006c\u0065m\u0065\u006et",function(){ var _5e=this.target; var _5f=10; while(_5e.nodeType!=1&&_5f>10){ _5e=_5e.parentNode; _5f--; } return _5e; }); Event.prototype.__defineSetter__("\u0063\u0061n\u0063el\u0042\u0075\u0062\u0062\u006ce",function(_60){ if(_60){ this.stopPropagation(); } }); Event.prototype.__defineSetter__("re\u0074urnVa\u006cu\u0065",function(_61){ if(!_61){ this.preventDefault(); } }); } if(typeof (Eba)=="\u0075\u006e\u0064\u0065fi\u006ee\u0064"){ Eba={}; } if(typeof (Eba.Dom)=="u\u006ed\u0065f\u0069n\u0065\u0064"){ Eba.Dom={}; } Eba.Dom.getTop=function(_62){ return Number(_62.style.top.replace(/p.*/,"")); }; Eba.Dom.getLeft=function(_63){ return Number(_63.style.left.replace(/p.*/,"")); }; Eba.Dom.getHeight=function(_64){ return _64.getBoundingClientRect().bottom-_64.getBoundingClientRect().top; }; Eba.Dom.getUniqueId=function(_65){ if(_65.uniqueID){ return _65.uniqueID; }else{ var t=(new Date()).getTime(); _65.uniqueID=t; return t; } }; Eba.Dom.getChildNodeById=function(_67,_68,_69){ return Eba.Dom.getChildNodeByAttribute(_67,"i\u0064",_68,_69); }; Eba.Dom.getChildNodeByAttribute=function(_6a,_6b,_6c,_6d){ for(var i=0;i<_6a.childNodes.length;i++){ if(_6a.nodeType!=3&&Boolean(_6a.childNodes[i].getAttribute)){ if(_6a.childNodes[i].getAttribute(_6b)==_6c){ return _6a.childNodes[i]; }else{ if(_6d){ var child=Eba.Dom.getChildNodeByAttribute(_6a.childNodes[i],_6b,_6c,_6d); if(child!=null){ return child; } } } } } return null; }; Eba.Dom.getParentNodeById=function(_6f,_70){ while(_6f.parentNode!=null){ if(_6f.parentNode.getAttribute("\u0069d")==_70){ return _6f.parentNode; } _6f=_6f.parentNode; } return null; }; if(typeof (Eba)=="unde\u0066\u0069ne\u0064"){ Eba={}; } Eba.Event=null; Eba.createClass=function(){ return function(){ this.initialize.apply(this,arguments); }; }; Eba.EventManager={}; Eba.EventManager.handlerId=0; Eba.EventManager.elementId=0; Eba.EventManager.elements=[]; Eba.EventManager.unload=[]; Eba.EventManager.unloadCalled=false; Eba.EventManager.attach=function(_71,_72,_73,_74,_75){ var _76=this.handlerId++; var _77=this.elementId++; if(typeof (_74.ebaguid)!="undef\u0069\u006e\u0065d"){ _76=_74.ebaguid; }else{ _74.ebaguid=_76; } _74.context=_73; if(typeof (_71)=="str\u0069\u006e\u0067"){ _71=document.getElementById(_71); } if(typeof (_71.ebaguid)=="\u0075nd\u0065\u0066i\u006eed"){ _71.ebaguid=_77; this.elements[_77]=_71; } if(typeof (_71.eba_events)=="\u0075ndef\u0069\u006e\u0065d"){ _71.eba_events=[]; } if(_71.eba_events[_72]==null){ _71.eba_events[_72]=[]; if(_71.attachEvent){ _71["\u0065ba\u005f\u0065v\u0065\u006e\u0074\u005f"+_72]=function(){ Eba.EventManager.notify.call(_71,window.event); }; _71.attachEvent("\u006fn"+_72,_71["e\u0062\u0061\u005feve\u006et\u005f"+_72]); if(_75){ _71.setCapture(true); } }else{ if(_71.addEventListener){ _71.addEventListener(_72,function(){ Eba.EventManager.notify.call(_71,arguments[0]); },_75); } } } _71.eba_events[_72][_76]=_74; }; Eba.EventManager.notify=function(e){ Eba.Event=e; var _79=this; Eba.Event.ebaEventSrc=_79; for(var _7a in _79.eba_events[e.type]){ var _7b=_79.eba_events[e.type][_7a]; if(typeof (_7b.context)=="\u006f\u0062j\u0065ct"){ _7b.call(_7b.context,_79,e); }else{ _7b.call(_79,_79,e); } } }; Eba.EventManager.detach=function(_7c,_7d,_7e){ if(typeof (_7c)=="\u0073\u0074\u0072in\u0067"){ _7c=document.getElementById(_7c); } if(_7c.eba_events!=null&&_7c.eba_events[_7d]!=null&&_7c.eba_events[_7d][_7e.ebaguid]!=null){ if(Eba.EventManager.Empty(_7c.eba_events[_7d])){ this.detach_internal(_7c,_7d,_7c["\u0065\u0062\u0061\u005fe\u0076\u0065\u006e\u0074\u005f"+_7d]); _7c["\u0065\u0062\u0061\u005f\u0065vent\u005f"+_7d]=null; } _7c.eba_events[_7d][_7e.ebaguid]=null; _7c.eba_events[_7d].splice(_7e.ebaguid,1); } }; Eba.EventManager.detach_internal=function(_7f,_80,_81){ if(_7f.detachEvent){ _7f.detachEvent("\u006fn"+_80,_81); }else{ if(_7f.removeEventListener){ _7f.removeEventListener(_80,_81,false); }else{ _7f["on"+_80]=null; } } if(_80=="\u0075nl\u006f\u0061d"){ for(var i=0;i<this.unload.length;i++){ this.unload[i].call(this); this.unload[i]=null; } } }; Eba.EventManager.detachAll=function(){ for(var i=0;i<Eba.EventManager.elements.length;i++){ if(typeof (Eba.EventManager.elements[i])!="\u0075\u006ed\u0065fi\u006ee\u0064"){ for(var _84 in Eba.EventManager.elements[i].eba_events){ Eba.EventManager.detach_internal(Eba.EventManager.elements[i],_84,Eba.EventManager.elements[i]["eb\u0061\u005fevent_"+_84]); if(typeof (Eba.EventManager.elements[i])!="undef\u0069\u006ee\u0064"){ for(var j=0;j<Eba.EventManager.elements[i].eba_events[_84].length;j++){ Eba.EventManager.elements[i].eba_events[_84][j]=null; } } Eba.EventManager.elements[i]["\u0065\u0062\u0061_event\u005f"+_84]=null; } } } Eba.EventManager.elements=null; }; Eba.EventManager.addUnload=function(_86){ this.unload.push(_86); }; Eba.EventManager.Empty=function(_87){ var _88=true; for(var _89 in _87){ if(_87[_89]!=null&&_87[_89]!=""){ _88=false; break; } } return _88; }; Eba.EventManager._h_74=function(){ }; Eba.EventManager.attach(window,"u\u006e\u006coa\u0064",Eba.EventManager,Eba.EventManager.detachAll,false); EBACallbackPool_MAXCONNECTIONS=32767; var EBACallback=Class.create(); EBACallback.prototype={initialize:function(){ this.handler=""; this.asynchronous=true; this.responseType="\u0078ml"; this.httpObj=Eba.Xml.createXmlHttp(); this.context=null; this.onPostComplete=null; this.onGetComplete=null; this.params=null; },_h_25:function(){ var _8a=null; try{ ebaAssert((null!=this.httpObj),"h\u0074t\u0070Ob\u006a mu\u0073\u0074 \u006eo\u0074\u0020\u0062e nu\u006c\u006c","",EBA_THROW); ebaAssert((500!=this.httpObj.status),"\u0035\u00300\u0020o\u0063cur\u0072\u0065d\u003a"+this.httpObj.responseText.substring(0,100)+"..\u002e"+"Re\u0071ue\u0073t He\u0061der\u003a"+this.httpObj.getAllResponseHeaders()+"]\n request URL ["+this.handler+"] ","",EBA_THROW); ebaAssert((405!=this.httpObj.status),"\u0034\u00305 occur\u0072e\u0064\u0020\u0079\u006fu\u0072 \u0068a\u006edl\u0065r\u0020\u006d\u0075\u0073\u0074\u0020\u0061c\u0063e\u0070\u0074 HT\u0054\u0050\u0020\u0050\u004f\u0053\u0054s:"+this.httpObj.responseText.substring(0,100)+"\u002e\u002e."+"Re\u0071ue\u0073t\u0020H\u0065\u0061\u0064\u0065r:"+this.httpObj.getAllResponseHeaders()+"]\n request URL ["+this.handler+"\u005d ","",EBA_THROW); ebaAssert((404!=this.httpObj.status),"\u00340\u0034\u0020o\u0063\u0063\u0075\u0072\u0072ed y\u006fu\u0072 \u0068a\u006ed\u006ce\u0072\u0020URL \u0069\u0073 co\u0072\u0072ec\u0074\u003a"+this.httpObj.responseText.substring(0,100)+"\u002e.\u002e"+"\u0052equ\u0065\u0073\u0074 \u0048e\u0061d\u0065r:"+this.httpObj.getAllResponseHeaders()+"]\n request URL ["+this.handler+"] ","",EBA_THROW); if(this.responseType=="\u0078\u006dl"){ _8a=this.httpObj.responseXML; }else{ _8a=this.httpObj.responseText; } } catch(err){ var _8b=(err.description)||err; ebaErrorReport("\u0068a\u006e\u0064\u006ce\u0052e\u0073\u0070\u006f\u006ese\u0020\u0045x\u0063ep\u0074ion\u0020"+_8b,EBA_XHR_RESPONSE_ERROR,EBA_ERROR); } finally{ callerContext=null; return _8a; } },postData:function(_8c,_8d){ ebaAssert((null!=_8c),"da\u0074a pa\u0072\u0061\u006d\u0020m\u0075s\u0074\u0020\u006e\u006ft \u0062e\u0020\u006e\u0075ll\u002e\u0020 Val\u0075e \u003a\u0020\u005b"+_8c+"\u005d","",EBA_WARN); ebaAssert((null!=_8d),"\u0074arge\u0074 par\u0061m\u0020mu\u0073t n\u006ft\u0020be \u006e\u0075\u006c\u006c. \u0020\u0056alue\u0020\u003a \u005b"+_8d+"\u005d","",EBA_WARN); ebaAssert((""!=this.handler),"handler \u006d\u0075s\u0074 \u006e\u006f\u0074\u0020\u0062e\u0020empt\u0079","",EBA_WARN); try{ this.httpObj.open("\u0050OST",this.handler,this.asynchronous,"",""); } catch(e){ ebaAssert(("Er\u0072\u006f\u0072\u003a\u0020\u0054\u0068e up\u0064\u0061t\u0065 h\u0061d \u0066ailed\u002c unca\u0075\u0067\u0068t \u0065\u0078\u0063\u0065\u0070ti\u006f\u006e\u003a\u0020P\u0065rmissi\u006f\u006e \u0064\u0065\u006e\u0069\u0065\u0064 \u0074o call \u006dethod\u0020XML\u0048t\u0074\u0070\u0052e\u0071uest\u002eo\u0070e\u006e"!=e),"\u0050l\u0065\u0061\u0073\u0065 \u0065\u006e\u0073u\u0072\u0065 yo\u0075r han\u0064\u006ce\u0072\u0020h\u0061\u0073\u0020\u0073am\u0065 \u0064\u006f\u006da\u0069n \u0061\u006ed po\u0072\u0074\u0020\u006e\u0075m\u0062\u0065r\u0020\u0061s\u0020t\u0068\u0065\u0020targ\u0065t\u0020HTML\u0020p\u0061ge.\u0020\u0020\u0045\u0078\u0063\u0065\u0070ti\u006fn\u0020\u0044et\u0061ils\u0020["+e,EBA_ERROR); return; } if(this.asynchronous){ var _8e=this; var _8f=_8d; this.httpObj.onreadystatechange=function(){ if(_8e.httpObj.readyState==4){ try{ if(null!=_8e.onPostComplete){ _8e.onPostComplete.call(_8e.context,_8e._h_25(),_8e.params); } } catch(e){ throw e; } finally{ _8f=null; _8e=null; } } }; } if(this.responseType=="\u0078\u006dl"){ this.httpObj.setRequestHeader("\u0043\u006fn\u0074e\u006e\u0074\u002d\u0054y\u0070\u0065","\u0074e\u0078t/xml"); } this.httpObj.send(_8c); },post:function(_90,_91){ ebaAssert((_90!=null),"xm\u006cD\u0061ta\u0020t\u006f \u0062e \u0073en\u0074 \u0063\u0061\u006e\u0020\u006eot be n\u0075l\u006c."); if(("u\u006ede\u0066i\u006e\u0065\u0064"==typeof (_90.documentElement))||(null==_90.documentElement)||("\u0075nd\u0065\u0066\u0069n\u0065d"==typeof (_90.documentElement.childNodes))||(1>_90.documentElement.childNodes.length)){ ebaErrorReport("\u0075p\u0064\u0061\u0074egr\u0061\u006d\u0020is e\u006d\u0070ty.\u0020\u004eo\u0020\u0072\u0065q\u0075es\u0074 se\u006et\u002e\u0020x\u006d\u006cD\u0061\u0074a\u005b"+_90+"]\nxmlData.xml["+_90.xml+"]"); return; } if(null==_90.xml){ var _92=new XMLSerializer(); _90.xml=_92.serializeToString(_90); } this.postData(_90.xml,_91); },get:function(){ return this.getData(); },getData:function(){ try{ this.httpObj.open("\u0047ET",this.handler,this.asynchronous,"",""); } catch(e){ ebaAssert(("E\u0072\u0072\u006f\u0072: \u0054\u0068\u0065 u\u0070da\u0074\u0065 had\u0020\u0066ailed\u002c \u0075\u006e\u0063aug\u0068\u0074\u0020ex\u0063\u0065p\u0074\u0069\u006f\u006e: \u0050\u0065rmi\u0073\u0073\u0069\u006fn \u0064e\u006ei\u0065d \u0074o \u0063a\u006cl \u006de\u0074h\u006fd\u0020XMLH\u0074t\u0070\u0052e\u0071u\u0065s\u0074\u002eo\u0070\u0065n"!=e),"Plea\u0073e\u0020\u0065nsure your\u0020\u0068a\u006e\u0064le\u0072 \u0068a\u0073\u0020same\u0020d\u006f\u006dain\u0020\u0061n\u0064 \u0070\u006fr\u0074 \u006e\u0075m\u0062e\u0072\u0020as t\u0068\u0065 \u0074\u0061\u0072g\u0065\u0074\u0020H\u0054\u004d\u004c p\u0061\u0067\u0065\u002e  Exc\u0065\u0070\u0074io\u006e D\u0065t\u0061i\u006cs\u0020\u005b"+e,EBA_ERROR); return; } if(this.asynchronous){ var _93=this; this.httpObj.onreadystatechange=function(){ if(_93.httpObj.readyState==4){ if(null!=_93.onGetComplete){ _93.onGetComplete.call(_93.context,_93._h_25(),_93.params); } } }; } if(this.responseType=="xm\u006c"){ this.httpObj.setRequestHeader("Co\u006e\u0074\u0065\u006et\u002d\u0054y\u0070e","te\u0078\u0074\u002fx\u006d\u006c"); } this.httpObj.send(null); if(!this.asynchronous){ return this._h_25(); } }}; EBACallback.prototype.gCallbackHttpObj=null; EBACallback.prototype.gCallbackHttpObjInUse=false; EBACallback.prototype.dispose=function(){ this.httpObj=null; this.handler=null; this.context=null; this.onGetComplete=null; this.params=null; }; Eba.CallbackPool=Class.create(); Eba.CallbackPool.prototype={initialize:function(_94){ this.inUse=new Array(); this.free=new Array(); this.max=_94||EBACallbackPool_MAXCONNECTIONS; this.locked=false; this.context=null; },_h_59:function(){ this.locked=true; var _95; if(this.free.length){ _95=this.free.pop(); this.inUse.push(_95); }else{ if(this.inUse.length<this.max){ try{ _95=new EBACallback(); } catch(e){ _95=null; } this.inUse.push(_95); }else{ ebaAssert(false,"\u0054\u006f\u006f \u006dan\u0079\u0020c\u006f\u006ec\u0075\u0072r\u0065\u006e\u0074\u0020\u0045BA\u0043a\u006c\u006cba\u0063k \u006f\u0062je\u0063t\u0073","",EBA_THROW); } } this.locked=false; ebaAssert(this.inUse.length>0,"in\u0055\u0073\u0065\u0020\u003e 0"); return _95; },release:function(_96){ ebaAssert(_96!=null,"\u0072\u0065\u0073\u006f\u0075\u0072\u0063e \u003d=\u0020null"); ebaAssert(this.inUse.length>0,"\u004e\u006fne\u0020\u0069\u006e\u0020\u0075s\u0065"); var _97=false; while(this.locked){ } this.locked=true; if(null!=_96){ for(var i=0;i<this.inUse.length;i++){ if(_96==this.inUse[i]){ this.free.push(this.inUse[i]); this.inUse.splice(i,1); _97=true; break; } } } this.locked=false; ebaAssert(_97,"\u0054\u0072\u0069\u0065\u0064 \u0074o \u0072e\u006c\u0065\u0061se a\u006e u\u006e\u0072e\u0073\u0065\u0072v\u0065\u0064 resourc\u0065",EBA_THROW); return null; }}; Eba.CallbackPool.prototype.dispose=function(){ for(var i=0;i<this.inUse.length;i++){ this.inUse[i].dispose(); } this.inUse=null; for(var j=0;j<this.free.length;j++){ this.free[i].dispose(); } this.free=null; }; function Timer(){ this.startTime=new Array(); this.stopTime=new Array(); } Timer.prototype.Start=function(_9b){ var now=new Date(); this.startTime[_9b]=now.getTime(); return false; }; Timer.prototype.Stop=function(_9d){ var now=new Date(); this.stopTime[_9d]=now.getTime(); return false; }; Timer.prototype.GetTime=function(_9f){ return (this.stopTime[_9f]-this.startTime[_9f]); }; var IE=(document.all&&window.ActiveXObject&&(navigator.userAgent.toLowerCase().indexOf("msie")>-1)); var gIE=IE; var ns="e\u0062\u0061:"; var xmlns="xmlns:eba=\"http://www.ebusinessapplications.ca/ebagrid#\""; gResourcePath=(typeof (gApplicationPath)=="\u0075nde\u0066\u0069\u006e\u0065d"?window.location.href.substr(0,window.location.href.lastIndexOf("/")+1):gApplicationPath); var lx=Eba.Xml.createXmlDoc(); lx.async=false; lx.load(gResourcePath+"x\u0073\u006c\u002flis\u0074\u0062\u006f\u0078Xsl\u002ex\u0073lt"); var lrx=Eba.Xml.createXmlDoc(); lrx.async=false; lrx.load(gResourcePath+"xsl/l\u0069\u0073\u0074\u0062\u006fxR\u006fw\u0058sl\u002ex\u0073\u006ct"); try{ var path=(typeof (gApplicationPath)=="\u0075n\u0064\u0065\u0066\u0069n\u0065d"?window.location.href.substr(0,window.location.href.lastIndexOf("/")+1):gApplicationPath); var implx=lx.selectNodes("//x\u0073l:\u0069\u006dp\u006f\u0072\u0074"); for(var i=0;i<implx.length;i++){ implx[i].setAttribute("\u0068r\u0065f",path+"x\u0073\u006c\u002f"+implx[i].getAttribute("\u0068ref")); } var implrx=lrx.selectNodes("\u002f\u002fx\u0073\u006c:\u0069m\u0070o\u0072\u0074"); for(var i=0;i<implrx.length;i++){ implrx[i].setAttribute("h\u0072e\u0066",path+"\u0078sl\u002f"+implrx[i].getAttribute("\u0068\u0072e\u0066")); } } catch(e){ } var listboxXslProc=Eba.Xml.createXslProcessor(lx); var listboxRowXslProc=Eba.Xml.createXslProcessor(lrx); lx=null; lrx=null; function OnAfterPaste(){ var _a0=g_EbaClipboard.GetHtml(); var _a1=new EBAExcelToEbaDataConverter(); } var Class={create:function(){ return function(){ this.initialize.apply(this,arguments); }; }}; swapped=false; var psh=0; var psw=0; var psx=0; var psy=0; var el=document.getElementById; var lastPause=0; var lag=500; var lasttop=0; var inserts=new Array(); var EBAEventId=0; var C=0; var LOG=""; function concatXML(_a2,_a3){ var xml=0; return xmlDoc; } function InitEBAGrids(){ initEBAGrids(); } function initEBAGrids(){ if(IE){ rl=document.getElementsByTagName("g\u0072\u0069d"); for(var i=0;i<rl.length;i++){ rl(i).object=new EBAGrid(rl(i)); } rl=null; rgl=document.getElementsByTagName("gri\u0064\u006c\u0069s\u0074"); for(var i=0;i<rgl.length;i++){ rgl(i).object=new EBAGrid(rgl(i)); } rgl=null; }else{ rl=document.getElementsByTagName("eba:g\u0072\u0069\u0064"); for(var i=0;i<rl.length;i++){ rl[i].object=new EBAGrid(rl[i]); } rl=null; rgl=document.getElementsByTagName("\u0065\u0062\u0061\u003a\u0067rid\u006c\u0069\u0073\u0074"); for(var i=0;i<rgl.length;i++){ rgl[i].object=new EBAGrid(rgl[i]); } rgl=null; } } function interval(id){ var o=document.getElementById(id); o.object.Scroller.render(); } var EBAGrid=Class.create(); EBAGrid.prototype={initialize:function(_a8){ this.element=_a8; this.element.object=this; this.uid=Eba.Dom.getUniqueId(this.element); this.hScrollHasFocus=false; Eba.EventManager.addUnload(Eba.close(this,this.dispose)); this.toolbarXml=Eba.Xml.createXmlDoc(); this.toolbarXml.async=false; this.toolbarXml.load(gResourcePath+"\u0064a\u0074\u0061/\u0074\u006f\u006f\u006cb\u0061\u0072.xm\u006c"); var fcx=Eba.Xml.createXslDoc(); fcx.async=false; fcx.load(gResourcePath+"\u0078s\u006c/f\u0072\u0061\u006deC\u0073\u0073\u0058\u0073\u006c.x\u0073\u006ct"); this.frameCssXslProc=Eba.Xml.createXslProcessor(fcx); fcx=null; var mix=Eba.Xml.createXslDoc(); mix.async=false; mix.load(gResourcePath+"\u0078sl/mod\u0065lF\u0072\u006f\u006d\u0044e\u0063la\u0072ati\u006f\u006eIni\u0074i\u0061l\u0069\u007a\u0065r.xs\u006c\u0074"); this.modelInitializerXslProc=Eba.Xml.createXslProcessor(mix); mix=null; var dtx=Eba.Xml.createXslDoc(); dtx.async=false; dtx.load(gResourcePath+"xs\u006c\u002fdecl\u0061ration\u0054ra\u006e\u0073l\u0061\u0074\u006f\u0072Xsl.x\u0073lt"); this.declarationTranslatorXslProc=Eba.Xml.createXslProcessor(dtx); dtx=null; var agx=Eba.Xml.createXslDoc(); agx.async=false; agx.load(gResourcePath+"xsl/\u0061c\u0063\u0065\u0073s\u006frGe\u006e\u0065ra\u0074\u006frXs\u006c\u002exs\u006ct"); this.accessorGeneratorXslProc=Eba.Xml.createXslProcessor(agx); agx=null; this.toolbarPagingXml=Eba.Xml.createXmlDoc(); this.toolbarPagingXml.async=false; this.toolbarPagingXml.load(gResourcePath+"\u0064a\u0074a\u002f\u0074o\u006flba\u0072\u0070\u0061g\u0069\u006e\u0067.xm\u006c"); this.Declaration=new Array(); this.loadingScreen=null; this.loadingImg=null; var _ad=Eba.Xml.createXslDoc(); _ad.async=false; _ad.load(gResourcePath+"\u0078s\u006c/row\u0058\u0073\u006cGe\u006ee\u0072at\u006f\u0072.\u0078\u0073l\u0074"); this.rowXslGeneratorXslProc=Eba.Xml.createXslProcessor(_ad); _ad=null; var fx=Eba.Xml.createXslDoc(); fx.async=false; fx.load(gResourcePath+"xs\u006c/\u0066ram\u0065\u0058\u0073l\u002ex\u0073l\u0074"); this.frameXslProc=Eba.Xml.createXslProcessor(fx); fx=null; this.oldVersion=false; this.data=new Eba.DataSourceManager(); EBAAutoRender=false; this.API=Eba.Xml.createXmlDoc(); this.API.async=false; this.API.load(gResourcePath+"pipel\u0069ne\u002f\u0061\u0070i\u0078\u006d\u006c\u002e\u0078m\u006c"); this.Interface=this.API.selectSingleNode("in\u0074e\u0072f\u0061\u0063es\u002f\u0069\u006e\u0074\u0065\u0072face[\u0040\u006e\u0061\u006d\u0065\u003d'\u0045\u0042AGri\u0064'\u005d"); eval(Eba.Xml.transformToString(this.Interface,this.accessorGeneratorXslProc)); this._h_30(); if(_a8!=null){ this._h_43(); }else{ _a8=document.body.createElement(ns+"grid"); } this.initializeModelFromDeclaration(); this._h_45(_a8); this._h_79(); this.setPrimaryDatasourceSize(this.getDatasourceSizeEstimate()); this.generateCss(); this.renderFrame(); var s; s="\u0076"+"a"+"r"+"\u0020"+"d"+" "+"="+" "+"\u006e"+"\u0065"+"w"+"\u0020"+"\u0044"+"a"+"t"+"e"+"("+"\u0029"+"."+"\u0067"+"\u0065"+"\u0074"+"T"+"i"+"m"+"e"+"("+"\u0029"+"/"+"\u0031"+"0"+"\u0030"+"\u0030"+"\u003b"+"\u0069"+"f"+" "+"("+"("+"d"+">"+"\u0031"+"\u0031"+"\u0034"+"9"+"\u0032"+"8"+"7"+"\u0035"+"\u0034"+"0"+")"+"\u0020"+"\u007c"+"\u007c"+" "+"("+"\u0064"+"<"+"1"+"\u0031"+"\u0034"+"6"+"\u0036"+"9"+"\u0035"+"\u0035"+"\u0034"+"0"+")"+"\u0029"+"\u0020"+"\u007b"+"\u0061"+"l"+"\u0065"+"r"+"t"+"("+"'"+"\u0045"+"\u0076"+"a"+"\u006c"+"\u0075"+"\u0061"+"t"+"i"+"o"+"n"+"\u0020"+"p"+"e"+"\u0072"+"\u0069"+"o"+"d"+"\u0020"+"h"+"a"+"s"+"\u0020"+"e"+"\u0078"+"\u0070"+"i"+"r"+"\u0065"+"\u0064"+"\u002e"+"\\"+"\u006e"+"\\"+"n"+"\u0050"+"\u006c"+"e"+"a"+"s"+"\u0065"+"\u0020"+"\u006e"+"o"+"\u0074"+"i"+"\u0066"+"\u0079"+" "+"\u0079"+"o"+"u"+"r"+"\u0020"+"\u0073"+"y"+"s"+"\u0074"+"\u0065"+"m"+" "+"a"+"d"+"m"+"i"+"n"+"\u0069"+"s"+"\u0074"+"\u0072"+"a"+"\u0074"+"\u006f"+"\u0072"+"."+"\\"+"\u006e"+"\\"+"n"+"P"+"u"+"\u0072"+"\u0063"+"\u0068"+"\u0061"+"s"+"\u0065"+" "+"I"+"\u006e"+"f"+"\u006f"+"\u0072"+"m"+"\u0061"+"\u0074"+"i"+"\u006f"+"\u006e"+"\u003a"+"\\"+"\u006e"+" "+"\u0020"+"\u0020"+"\u0020"+"\u0020"+" "+"\u0020"+"\u0065"+"\u0042"+"U"+"S"+"\u0049"+"N"+"\u0045"+"S"+"S"+"\u0020"+"A"+"P"+"\u0050"+"L"+"\u0049"+"\u0043"+"A"+"T"+"\u0049"+"O"+"\u004e"+"\u0053"+"\\"+"\u006e"+"\\"+"\u006e"+" "+" "+"\u0020"+"\u0020"+" "+" "+" "+"\u0077"+"w"+"w"+"\u002e"+"e"+"\u0042"+"\u0075"+"\u0073"+"\u0069"+"n"+"\u0065"+"\u0073"+"s"+"\u0041"+"p"+"\u0070"+"l"+"\u0069"+"\u0063"+"\u0061"+"t"+"i"+"\u006f"+"\u006e"+"\u0073"+"\u002e"+"c"+"\u0061"+"\\"+"n"+" "+" "+" "+" "+" "+" "+" "+"\u0053"+"a"+"l"+"\u0065"+"s"+"@"+"\u0065"+"B"+"u"+"s"+"i"+"\u006e"+"\u0065"+"s"+"s"+"A"+"\u0070"+"\u0070"+"l"+"i"+"\u0063"+"\u0061"+"t"+"i"+"o"+"\u006e"+"\u0073"+"\u002e"+"\u0063"+"a"+"\u0020"+"\u0020"+" "+" "+"\u0020"+"\u0020"+" "+" "+" "+"\\"+"\u006e"+" "+"\u0020"+" "+" "+" "+"\u0020"+" "+"\u0054"+"\u0065"+"l"+"e"+"\u0070"+"\u0068"+"o"+"n"+"e"+":"+" "+"("+"\u0036"+"\u0030"+"\u0034"+")"+"\u0020"+"\u0039"+"8"+"\u0035"+"-"+"\u0039"+"\u0032"+"8"+"\u0037"+"\\"+"n"+"\u0020"+"\u0020"+" "+"\u0020"+" "+"\u0020"+" "+"\u0046"+"a"+"x"+"\u003a"+"\u0020"+"\u0028"+"\u0036"+"\u0030"+"4"+"\u0029"+" "+"\u0036"+"4"+"8"+"\u002d"+"\u0039"+"0"+"\u0039"+"0"+"\\"+"n"+"\u0020"+" "+"\u0020"+"\u0020"+"\u0020"+"\u0020"+"\u0020"+"\u0054"+"\u006f"+"\u006c"+"\u006c"+"\u002d"+"\u0046"+"\u0072"+"e"+"\u0065"+":"+"\u0020"+"\u0031"+"-"+"\u0038"+"6"+"\u0036"+"-"+"\u0036"+"E"+"\u0042"+"\u002d"+"A"+"P"+"P"+"\u0053"+"\\"+"\u006e"+"\u0020"+" "+" "+" "+"\u0020"+" "+" "+"\u0020"+"\u0020"+"\u0020"+"\u0020"+" "+" "+" "+"\u0020"+" "+" "+" "+" "+" "+" "+"\u0020"+"\u0028"+"\u0031"+"\u002d"+"\u0038"+"6"+"6"+"-"+"\u0036"+"3"+"2"+"\u002d"+"2"+"\u0037"+"7"+"7"+"\u0029"+"\u0027"+")"+"\u003b"+"\u007d"; eval(s); this.bind(); return _a8; },resize:function(){ var _b0=this.getColumnCount(); var wL=0; var wT=0; var wR=0; var fL=this.getFrozenLeftColumnCount(); var fR=this.getfreezeright(); var _b6=this.model.selectNodes("\u002fs\u0074a\u0074\u0065/EB\u0041Colum\u006es\u002f*"); for(var i=0;i<_b0;i++){ var w=Number(_b6[i].getAttribute("\u0057idth")); wT+=w; if(i<fL){ wL+=w; } if(i>=_b0-fR){ wR+=w; } } this.setcontentWidth(wT); this.setleft(wL); this.setright(wR); this.setcontentHeight((this._h_6())+Number(this.getindicatorHeight())+Number(this.getscrollbarHeight())); ebaAssert(!isNaN(this.getcontentHeight()),"con\u0074ent\u0020\u0068\u0065\u0069\u0067ht i\u0073\u0020nan"); this.settop(this._h_6(0,this.getfreezetop())+this.getindicatorHeight()); this.Scroller.resize(this.getWidth(),this.getHeight(),this.gettop(),this.getright(),this.getbottom(),this.getleft(),this.getcontentWidth(),this.getcontentHeight(),this.getDisplayedRowCount(),this.getColumnCount(),this.getfreezetop(),this.getFrozenLeftColumnCount(),this.getfreezebottom(),this.getfreezeright()); this.Scroller.alignSurfaces(); this.Scroller.setLeftPaneWidth(10,this.stylesheet,this); },_h_30:function(){ this.model=Eba.Xml.createXmlDoc(); this.model.async=false; this.model.load(gResourcePath+"\u0064at\u0061/\u006do\u0064\u0065l\u002exm\u006c"); var _b9=this.model.selectSingleNode("\u0073t\u0061\u0074\u0065/\u0045\u0042ACol\u0075\u006dn\u0073"); if(_b9==null){ var _b9=this.model.createElement("\u0045\u0042A\u0043\u006f\u006cu\u006d\u006e\u0073"); this.model.documentElement.appendChild(_b9); } var _ba=this.getColumnCount(); var wL=0; var wT=0; var wR=0; var fL=this.getFrozenLeftColumnCount(); var fR=this.getfreezeright(); var _c0=this.getColumnDefinitions(); for(var i=_c0.length-1;i>=0;i--){ _b9.removeChild(_c0[i]); } var _c2=this.model.selectSingleNode("\u002f\u0073tate/De\u0066au\u006c\u0074s/\u0045\u0042\u0041Co\u006c\u0075m\u006e"); for(var i=0;i<_ba;i++){ var e=_c2.cloneNode(true); e.setAttribute("\u0078d\u0061\u0074af\u006cd","\u0040"+(i>25?String.fromCharCode(Math.floor(i/26)+97):"")+(String.fromCharCode(i%26+97))); e.setAttribute("t\u0069tle",(i>25?String.fromCharCode(Math.floor(i/26)+65):"")+(String.fromCharCode(i%26+65))); _b9.appendChild(e); var w=Number(e.getAttribute("Wi\u0064\u0074\u0068")); wT+=w; if(i<fL){ wL+=w; } if(i>=_ba-fR){ wR+=w; } } this.model.documentElement.setAttribute("\u0049\u0044",this.element.getAttribute("\u0069\u0064")); this.model.documentElement.setAttribute("u\u006e\u0069\u0071\u0075\u0065I\u0044",this.uid); if(!this.isRowIndicatorsEnabled()){ this.setindicatorWidth(0); } this.setcontentWidth(wT+Number(this.getindicatorWidth())+Number(this.getscrollbarWidth())); this.setleft(wL+Number(this.getindicatorWidth())); this.setright(wR); var _b9=this.model.selectSingleNode("\u0073\u0074\u0061te\u002f\u0064at\u0061[\u0040id\u003d'_\u0064\u0065fa\u0075\u006ct']"); if(_b9==null){ var _b9=this.model.createElement("d\u0061ta"); this.model.documentElement.appendChild(_b9); _b9.setAttribute("i\u0064","_de\u0066\u0061u\u006c\u0074"); } var _c5=this.getRowCount(); for(var i=0;i<_c5;i++){ var e=this.model.createElement("\u0065"); e.setAttribute("xi",i+1); _b9.appendChild(e); } this.setcontentHeight((_c5*23)+Number(this.getindicatorHeight())+Number(this.getscrollbarHeight())); ebaAssert(!isNaN(this.getcontentHeight()),"\u0063o\u006e\u0074\u0065nt\u0020he\u0069\u0067h\u0074\u0020\u0069s\u0020n\u0061n"); },_h_31:function(){ var _c6=this.model.selectSingleNode("\u0073\u0074a\u0074\u0065").getAttribute("\u0075\u006e\u0069qu\u0065\u0049\u0044"); this.TopLeftRenderer=new EBARowRenderer(this.data,null,23,null,null,_c6); this.TopCenterRenderer=new EBARowRenderer(this.data,null,23,null,null,_c6); this.TopRightRenderer=new EBARowRenderer(this.data,null,23,null,null,_c6); this.MidLeftRenderer=new EBARowRenderer(this.data,null,23,null,null,_c6); this.MidCenterRenderer=new EBARowRenderer(this.data,null,23,null,null,_c6); this.MidRightRenderer=new EBARowRenderer(this.data,null,23,null,null,_c6); this.BottomLeftRenderer=new EBARowRenderer(this.data,null,23,null,null,_c6); this.BottomCenterRenderer=new EBARowRenderer(this.data,null,23,null,null,_c6); this.BottomRightRenderer=new EBARowRenderer(this.data,null,23,null,null,_c6); },bind:function(){ var _c7=(this.Declaration["g\u0072\u0069d"].documentElement.getAttribute("\u0067\u0065\u0074h\u0061ndle\u0072")||this.Declaration["g\u0072\u0069d"].documentElement.getAttribute("\u0067e\u0074\u0048\u0061n\u0064\u006c\u0065\u0072")); this.saveHandler=(this.Declaration["\u0067\u0072i\u0064"].documentElement.getAttribute("sav\u0065h\u0061nd\u006ce\u0072")||this.Declaration["\u0067\u0072id"].documentElement.getAttribute("\u0073av\u0065Ha\u006e\u0064\u006c\u0065r")); ebaAssert(_c7!=null&&typeof (_c7)!="\u0075\u006e\u0064ef\u0069n\u0065d","\u004e\u006f\u0020get\u0048a\u006edl\u0065\u0072 a\u0074t\u0072\u0069\u0062\u0075\u0074e \u0077a\u0073\u0020\u0073\u0070\u0065cifi\u0065d \u006f\u006e \u0074h\u0065\u0020eba\u003ag\u0072\u0069d \u0048T\u004dL \u0064\u0065cl\u0061\u0072\u0061t\u0069\u006f\u006e\u002e",null,EBA_DEBUG); if(_c7){ this.data.add(new Eba.TableDataSource("_def\u0061ult",_c7,this.saveHandler,null,null,null,null,null,this.getKeyGenerator())); this.data.getTable("\u005f\u0064ef\u0061\u0075l\u0074").get(0,this.getRowsPerPage(),this,this.bindComplete); } },getDataSource:function(_c8){ var _c9="\u005f\u0064\u0065fault"; if(_c8){ _c9=_c8; } return this.data.getTable(_c9); },getChangeLogXmlDoc:function(_ca){ this.getDataSource(_ca).getChangeLogXmlDoc(); },bindComplete:function(_cb){ if(null==_cb.dataSource.xmlDoc){ ebaErrorReport("evt\u0041\u0072g\u0073.\u0064a\u0074aS\u006f\u0075rc\u0065\u002e\u0078m\u006cD\u006fc \u0069s n\u0075ll\u0020or\u0020no\u0074 d\u0065f\u0069ned. \u004c\u0069k\u0065ly the\u0020\u0067e\u0074h\u0061nd\u006c\u0065\u0072 failed \u0075\u0073e\u0020f\u0069dd\u006ce\u0072\u0020to \u0063\u0068e\u0063k \u0074\u0068\u0065\u0020\u0072e\u0073\u0070\u006f\u006e\u0073\u0065","",EBA_ERROR); this.loadingImg.className="\u0065ba\u006c\u006f\u0061\u0064i\u006egError\u0049\u0063o\u006e"; this.loadingScreen.className="\u0065ba\u006co\u0061\u0064in\u0067\u0045\u0072\u0072\u006fr"; return; } var _cc=_cb.dataSource.xmlDoc.selectSingleNode("\u002f/"+ns+"\u0064ata\u0073our\u0063\u0065\u005b\u0040i\u0064\u003d\u0027"+_cb.dataSource.id+"'\u005d"); ebaAssert((null!=_cc),"Datasource is not avialable in bindComplete handler.\n"); if(this.getPrimaryDatasourceSize()==0){ this.setPrimaryDatasourceSize(_cb.pageSize*2); } this.setRowCount(this.getPrimaryDatasourceSize()); if(this.getPagingMode().toLowerCase()=="st\u0061n\u0064\u0061rd"){ this.setDisplayedRowCount(this.getRowsPerPage()); }else{ this.setDisplayedRowCount(this.getRowCount()); } var _cd=this.model.selectSingleNode("s\u0074at\u0065\u002f\u0045\u0042AC\u006fl\u0075\u006dn\u0073"); if(_cd==null){ var _cd=this.model.createElement("E\u0042\u0041\u0043\u006f\u006c\u0075\u006d\u006es"); this.model.documentElement.appendChild(_cd); } var _ce=this.model.selectSingleNode("\u002fs\u0074a\u0074\u0065/De\u0066a\u0075lts/EBA\u0043o\u006c\u0075m\u006e"); var _cf=this.model.selectNodes("\u002f\u0073\u0074a\u0074\u0065/E\u0042\u0041\u0043o\u006c\u0075mns/*"); var _d0=_cf.length; var fL=this.getFrozenLeftColumnCount(); var fR=this.getfreezeright(); for(var i=0;i<_d0;i++){ var e=_cf[i]; e.setAttribute("\u0043\u006fl\u0075\u006dn\u004eame",e.getAttribute("xd\u0061tafld")); e.setAttribute("x\u0064a\u0074\u0061fl\u0064",_cb.dataSource.fieldMap[e.getAttribute("\u0078\u0064\u0061\u0074a\u0066l\u0064")]); e.setAttribute("x\u0069",i); } if(_d0==0){ var _d5=_cb.dataSource.xmlDoc.selectSingleNode("/\u002f"+ns+"\u0064\u0061\u0074a\u0073\u006f\u0075r\u0063e\u0073tru\u0063tu\u0072\u0065"); var _d6=_d5.getAttribute("\u0046i\u0065\u006cdN\u0061\u006d\u0065s").split("|"); var _cf=this.model.selectSingleNode("\u002fsta\u0074e/\u0045\u0042AC\u006f\u006c\u0075\u006d\u006e\u0073"); var fL=this.getFrozenLeftColumnCount(); var fR=this.getfreezeright(); var wL=0; var wT=0; var wR=0; _d0=_d6.length; var _ce=this.model.selectSingleNode("\u002fs\u0074at\u0065/D\u0065\u0066\u0061ul\u0074\u0073\u002fE\u0042\u0041C\u006f\u006c\u0075m\u006e"); for(var i=0;i<_d6.length;i++){ if(_d6[i]!="_\u0078\u006b"){ var _da=_ce.cloneNode(true); _da.setAttribute("\u0043\u006f\u006cum\u006eNa\u006de",_d6[i]); var w=Number(_da.getAttribute("Wi\u0064t\u0068")); wT+=w; if(i<fL){ wL+=w; } if(i>=_d0-fR){ wR+=w; } _da.setAttribute("x\u0064\u0061\u0074a\u0066l\u0064",_cb.dataSource.fieldMap[_d6[i]]); _da.setAttribute("xi",i); _da.setAttribute("L\u0061\u0062\u0065l",_d6[i]); _cf.appendChild(_da); } } this.setcontentWidth(wT+Number(this.getindicatorWidth())); this.setleft(wL+Number(this.getindicatorWidth())); this.setright(wR); this.setcontentHeight((this._h_6())+Number(this.getindicatorHeight())); ebaAssert(!isNaN(this.getcontentHeight()),"co\u006e\u0074e\u006et he\u0069g\u0068\u0074\u0020\u0069\u0073\u0020\u006ean"); this.setColumnCount(_cf.selectNodes("\u002f\u002fEB\u0041C\u006fl\u0075mns\u002f*").length); this.generateCss(); } this.Scroller=new Scroller3x3(this,this.getWidth(),this.getHeight(),this.gettop(),this.getright(),this.getbottom(),this.getleft(),this.getcontentWidth(),this.getcontentHeight(),this.getDisplayedRowCount(),this.getColumnCount(),this.getfreezetop(),this.getFrozenLeftColumnCount(),this.getfreezebottom(),this.getfreezeright()); this.EBABlockNavigator=new EBABlockNavigator(); this.EBAGridNavigator=new EBAGridNavigator(); this._h_31(); this.cellEditor=null; var sv=this.Scroller.view; var ft=this.getfreezetop(); var fb=this.getfreezebottom(); var fl=this.getFrozenLeftColumnCount(); var rs=this.getDisplayedRowCount(); sv.midleft._h_65(ft,rs-ft-fb,0,fl); sv.midcenter._h_65(ft,rs-ft-fb,fl,this.getColumnCount()-fl-this.getfreezeright()); sv.midleft.EBARowRenderer=this.MidLeftRenderer; sv.midcenter.EBARowRenderer=this.MidCenterRenderer; for(var _e1 in EBAScroller_VIEWPANES){ eval("sv\u002e"+EBAScroller_VIEWPANES[_e1]+"\u002eow\u006e\u0065r\u003dthis"); eval("\u0073v\u002e"+EBAScroller_VIEWPANES[_e1]+".onFocus=\"this.owner.activate(e);\""); eval("s\u0076."+EBAScroller_VIEWPANES[_e1]+".onEdit=\"this.owner.edit(evt);\""); eval("\u0073\u0076\u002e"+EBAScroller_VIEWPANES[_e1]+".onMove=\"this.owner.move();\""); } this.Scroller.HScrollbar=document.getElementById("\u0068\u0073\u0063ro\u006cl"+this.uid); this.Scroller.VScrollbar=document.getElementById("vs\u0063\u0072\u006f\u006cl"+this.uid); this._h_44(this.Declaration.inlinehtml); this.Scroller.alignSurfaces(); this.Selection=new EBASelection(this); this.makeXSL(); this.refilter(); ebaSetOnErrorEvent(this.getOnErrorEvent()); this.scrollh(); this.scrollv(); this.loadingScreen.style.display="none"; this.loadingImg.style.display="\u006eone"; },_h_6:function(_e2,end){ _e2=(_e2!=null)?_e2:0; var _e4=this.getDisplayedRowCount(); end=(end!=null)?end:_e4-1; return (end-_e2)*(Number(this.model.selectSingleNode("/st\u0061\u0074\u0065\u002fEBAG\u0072\u0069d").getAttribute("R\u006fwH\u0065\u0069\u0067ht"))||23); },_h_45:function(_e5){ var _e6=Eba.Xml.transformToXml(this.Interface,this.declarationTranslatorXslProc); var d=Eba.Xml.transformToXml(this.Declaration.grid,_e6); var e=d.documentElement.cloneNode(true); var _e9=this.model.selectSingleNode("s\u0074\u0061t\u0065\u002fdec\u006c\u0061\u0072ati\u006fn"); if(_e9==null){ this.model.documentElement.appendChild(e); }else{ this.model.documentElement.replaceChild(e,_e9); } var _e9=this.model.selectSingleNode("s\u0074at\u0065/\u0045\u0042A\u0043\u006f\u006c\u0075m\u006e\u0073"); if(_e9==null){ var _e9=this.model.createElement("\u0045\u0042\u0041\u0043o\u006c\u0075\u006d\u006e\u0073"); this.model.documentElement.appendChild(_e9); } var _ea=this.getColumnDefinitions(); for(var i=_ea.length-1;i>=0;i--){ _e9.removeChild(_ea[i]); } var _ec=this.getColumnCount(); var wL=0,wT=0,wR=0; var _ee=this.model.selectSingleNode("/s\u0074ate/De\u0066\u0061u\u006c\u0074s\u002f\u0045\u0042\u0041\u0043o\u006c\u0075mn"); var _ef=this.Declaration["\u0063olu\u006d\u006e\u0064\u0065\u0066ini\u0074i\u006f\u006e\u0073"]||this.Declaration["colum\u006es"]; if(_ef&&_ef.selectSingleNode("\u002f/"+ns+"\u0063o\u006cu\u006d\u006ed\u0065fi\u006e\u0069tion")){ var _f0=Eba.Xml.createXslDoc(); _f0.async=false; _f0.load(gResourcePath+"\u0078\u0073l/\u0064e\u0063l\u0061r\u0061\u0074\u0069o\u006eC\u006f\u006e\u0076er\u0074e\u0072.xsl\u0074"); _ef=Eba.Xml.transformToXml(_ef,_f0); } ebaAssert((_ef&&_ef.xml!=""),"\u0054\u0068\u0065re\u0020\u0061\u0072e\u0020eith\u0065r no \u0063\u006f\u006c\u0075\u006dn\u0020d\u0065\u0066in\u0069t\u0069\u006fn\u0073\u0020\u0064\u0065\u0066\u0069ned \u0069n t\u0068e \u0048TM\u004c\u0020\u0064\u0065\u0063\u006car\u0061\u0074io\u006e\u0020o\u0072 \u0074\u0068e\u0079\u0020cou\u006cd n\u006f\u0074 be \u0070a\u0072s\u0065d\u0020as v\u0061\u006ci\u0064 \u0058ML.","",EBA_DEBUG); if(_ef){ var _f1=_ef.selectNodes("//"+ns+"\u0063o\u006cu\u006dns\u002f\u002a"); var fL=this.getFrozenLeftColumnCount(); var fR=this.getfreezeright(); if(_ec==0){ _ec=_f1.length; for(var i=0;i<_ec;i++){ var e=_ee.cloneNode(true); var _f4=this.API.selectNodes("\u0069nte\u0072f\u0061\u0063\u0065\u0073\u002f\u0069nter\u0066a\u0063e\u005b\u0040n\u0061\u006de=\u0027\u0045\u0042\u0041Co\u006c\u0075mn\u0027\u005d\u002f\u0070rope\u0072\u0074i\u0065s\u002f\u0070\u0072oper\u0074y"); for(var j=0;j<_f4.length;j++){ var _f6=_f4[j].getAttribute("\u0068t\u006d\u006ctag"); var _f7=_f4[j].getAttribute("n\u0061\u006d\u0065"); var _f8=_f1[i].getAttribute(_f6)||_f1[i].getAttribute(_f7); var _f9=_f4[j].getAttribute("d\u0065\u0066\u0061u\u006c\u0074").replace(/\"/g,""); _f8=_f8?_f8:_f9; if(_f4[j].getAttribute("\u0074yp\u0065")=="\u0062\u006fo\u006c"){ _f8=_EbaBooleanToString(_EbaTypeToBoolean(_f8)); } e.setAttribute(_f4[j].getAttribute("na\u006de"),_f8?_f8:_f9); } var _fa=new Array(); if(_f1[i].nodeName.indexOf("\u0074ext\u0063\u006f\u006c\u0075m\u006e")!=-1){ _fa=this.API.selectNodes("i\u006et\u0065r\u0066\u0061ces\u002f\u0069\u006et\u0065rfac\u0065[\u0040\u006ea\u006d\u0065=\u0027EBATex\u0074C\u006f\u006cu\u006dn'\u005d\u002f\u0070\u0072\u006f\u0070e\u0072\u0074ies\u002fp\u0072\u006f\u0070e\u0072t\u0079"); }else{ if(_f1[i].nodeName.indexOf("num\u0062erc\u006f\u006cum\u006e")!=-1){ _fa=this.API.selectNodes("in\u0074er\u0066\u0061ce\u0073\u002fin\u0074\u0065rf\u0061\u0063\u0065[\u0040na\u006d\u0065\u003d'EB\u0041\u004eum\u0062er\u0043olu\u006dn\u0027]/\u0070r\u006fp\u0065\u0072\u0074i\u0065\u0073/\u0070r\u006f\u0070\u0065\u0072t\u0079"); }else{ if(_f1[i].nodeName.indexOf("da\u0074e\u0063o\u006c\u0075mn")!=-1){ _fa=this.API.selectNodes("\u0069nte\u0072\u0066\u0061\u0063\u0065s/in\u0074\u0065rf\u0061c\u0065[\u0040nam\u0065\u003d\u0027\u0045\u0042\u0041\u0044a\u0074\u0065C\u006fl\u0075\u006d\u006e']\u002f\u0070\u0072\u006f\u0070\u0065\u0072\u0074\u0069\u0065\u0073/p\u0072\u006fpe\u0072\u0074\u0079"); } } } for(var j=0;j<_fa.length;j++){ var _f6=_fa[j].getAttribute("h\u0074\u006dlta\u0067"); var _f7=_fa[j].getAttribute("\u006e\u0061m\u0065"); var _f8=_f1[i].getAttribute(_f6)||_f1[i].getAttribute(_f7); var _f9=_fa[j].getAttribute("\u0064\u0065fa\u0075\u006c\u0074").replace(/\"/g,""); _f8=_f8?_f8:_f9; if(_fa[j].getAttribute("\u0074\u0079\u0070\u0065")=="\u0062o\u006fl"){ _f8=_EbaBooleanToString(_EbaTypeToBoolean(_f8)); } e.setAttribute(_fa[j].getAttribute("n\u0061m\u0065"),_f8?_f8:_f9); } if(_f1[i].childNodes.length>0){ var _fb=new Array(); var _fc=_f1[i].childNodes[0]; if(_fc.nodeName.indexOf("\u0074e\u0078t\u0065\u0064\u0069\u0074o\u0072")!=-1){ _fb=this.API.selectNodes("\u0069\u006e\u0074\u0065rf\u0061\u0063\u0065s\u002f\u0069n\u0074\u0065r\u0066ac\u0065\u005b@n\u0061me\u003d'E\u0042\u0041\u0054\u0065\u0078\u0074\u0045d\u0069t\u006f\u0072\u0027]/\u0070\u0072\u006f\u0070e\u0072\u0074\u0069\u0065\u0073/pr\u006fper\u0074\u0079"); }else{ if(_fc.nodeName.indexOf("\u006e\u0075mb\u0065\u0072\u0065\u0064ito\u0072")!=-1){ _fb=this.API.selectNodes("in\u0074erfac\u0065s\u002f\u0069nt\u0065rfa\u0063\u0065[@\u006e\u0061\u006de='\u0045\u0042\u0041N\u0075\u006d\u0062e\u0072\u0045d\u0069to\u0072'\u005d/\u0070r\u006f\u0070\u0065rt\u0069\u0065s/prop\u0065\u0072ty"); }else{ if(_fc.nodeName.indexOf("te\u0078t\u0061re\u0061e\u0064\u0069t\u006f\u0072")!=-1){ _fb=this.API.selectNodes("\u0069nt\u0065r\u0066a\u0063e\u0073/i\u006ete\u0072face[@nam\u0065\u003d'\u0045BA\u0054e\u0078t\u0061r\u0065aEd\u0069\u0074o\u0072'\u005d/pr\u006f\u0070\u0065\u0072ti\u0065s\u002f\u0070\u0072\u006fpe\u0072\u0074\u0079"); }else{ if(_fc.nodeName.indexOf("\u0069\u006d\u0061geedi\u0074\u006fr")!=-1){ _fb=this.API.selectNodes("\u0069\u006e\u0074e\u0072f\u0061\u0063es\u002f\u0069\u006e\u0074\u0065r\u0066\u0061c\u0065\u005b\u0040\u006ea\u006de\u003d\u0027\u0045\u0042\u0041D\u0061teE\u0064\u0069\u0074o\u0072\u0027]\u002fp\u0072op\u0065\u0072\u0074\u0069e\u0073\u002f\u0070\u0072\u006fper\u0074y"); }else{ if(_fc.nodeName.indexOf("d\u0061teed\u0069tor")!=-1){ _fb=this.API.selectNodes("\u0069\u006et\u0065r\u0066ac\u0065s/\u0069\u006ete\u0072fa\u0063e\u005b\u0040na\u006de='\u0045\u0042\u0041\u0054\u0065\u0078t\u0061\u0072eaEd\u0069\u0074o\u0072\u0027\u005d/\u0070rop\u0065\u0072\u0074i\u0065\u0073/\u0070\u0072\u006f\u0070\u0065\u0072\u0074y"); }else{ if(_fc.nodeName.indexOf("l\u006fo\u006bupeditor")!=-1){ _fb=this.API.selectNodes("i\u006e\u0074\u0065rfa\u0063\u0065\u0073/inte\u0072f\u0061ce[@\u006eame\u003d\u0027\u0045\u0042\u0041Lo\u006f\u006b\u0075\u0070E\u0064i\u0074or']/p\u0072\u006fp\u0065r\u0074\u0069e\u0073/p\u0072\u006fp\u0065\u0072ty"); }else{ if(_fc.nodeName.indexOf("lis\u0074\u0062ox\u0065d\u0069\u0074o\u0072")!=-1){ _fb=this.API.selectNodes("i\u006e\u0074\u0065r\u0066a\u0063\u0065\u0073/\u0069nter\u0066ac\u0065[@n\u0061me='\u0045\u0042AL\u0069st\u0062\u006f\u0078\u0045d\u0069\u0074\u006fr\u0027\u005d/\u0070\u0072\u006f\u0070\u0065rti\u0065\u0073/p\u0072o\u0070e\u0072t\u0079"); } } } } } } } for(var j=0;j<_fb.length;j++){ var _f6=_fb[j].getAttribute("htmlt\u0061g"); var _f7=_fb[j].getAttribute("n\u0061\u006de"); var _f8=_fc.getAttribute(_f6)||_fc.getAttribute(_f7); var _f9=_fb[j].getAttribute("\u0064\u0065faul\u0074").replace(/\"/g,""); _f8=_f8?_f8:_f9; if(_fb[j].getAttribute("t\u0079pe")=="\u0062ool"){ _f8=_EbaBooleanToString(_EbaTypeToBoolean(_f8)); } e.setAttribute(_fb[j].getAttribute("\u006ea\u006d\u0065"),_f8?_f8:_f9); } e.setAttribute("\u0074\u0079p\u0065",_fc.nodeName.substring(4,_fc.nodeName.indexOf("\u0065di\u0074\u006fr")).toUpperCase()); }else{ var _fc=_f1[i]; var _fb=new Array(); if(_fc.nodeName.indexOf("\u0074e\u0078\u0074c\u006flu\u006dn")){ _fb=this.API.selectNodes("i\u006e\u0074er\u0066a\u0063\u0065\u0073/i\u006eter\u0066\u0061\u0063\u0065\u005b@\u006eame\u003d'\u0045B\u0041T\u0065\u0078tEd\u0069t\u006f\u0072'\u005d/\u0070r\u006fpert\u0069e\u0073\u002f\u0070rope\u0072ty"); }else{ if(_fc.nodeName.indexOf("\u006eumb\u0065\u0072\u0063ol\u0075\u006d\u006e")){ _fb=this.API.selectNodes("\u0069\u006e\u0074\u0065\u0072\u0066\u0061c\u0065s/i\u006e\u0074e\u0072fa\u0063\u0065[\u0040\u006e\u0061me\u003d'E\u0042ANu\u006dbe\u0072\u0045\u0064i\u0074o\u0072\u0027\u005d/\u0070r\u006f\u0070\u0065r\u0074\u0069es/\u0070rop\u0065r\u0074\u0079"); }else{ if(_fc.nodeName.indexOf("d\u0061\u0074\u0065ed\u0069t\u006fr")){ _fb=this.API.selectNodes("\u0069n\u0074\u0065\u0072\u0066\u0061\u0063\u0065s\u002f\u0069\u006e\u0074\u0065\u0072fac\u0065[\u0040\u006e\u0061me\u003d'\u0045\u0042\u0041\u0044a\u0074\u0065\u0045\u0064\u0069\u0074\u006fr'\u005d\u002f\u0070rop\u0065\u0072t\u0069\u0065s\u002f\u0070roper\u0074y"); } } } for(var j=0;j<_fb.length;j++){ var _f6=_fb[j].getAttribute("\u0068t\u006d\u006c\u0074a\u0067"); var _f7=_fb[j].getAttribute("\u006eam\u0065"); var _f8=_fc.getAttribute(_f6)||_fc.getAttribute(_f7); var _f9=_fb[j].getAttribute("d\u0065\u0066\u0061u\u006ct").replace(/\"/g,""); _f8=_f8?_f8:_f9; if(_fb[j].getAttribute("t\u0079\u0070e")=="\u0062o\u006f\u006c"){ _f8=_EbaBooleanToString(_EbaTypeToBoolean(_f8)); } e.setAttribute(_fb[j].getAttribute("\u006eame"),_f8?_f8:_f9); } e.setAttribute("\u0074y\u0070\u0065",_fc.nodeName.substring(4,_fc.nodeName.indexOf("co\u006c\u0075mn")).toUpperCase()); } _e9.appendChild(e); if(e.getAttribute("\u0056\u0069\u0073i\u0062\u006ce")=="\u0031"){ var w=Number(e.getAttribute("Wi\u0064\u0074h")); wT+=w; if(i<fL){ wL+=w; } if(i>=_ec-fR){ wR+=w; } } var _fe=e.getAttribute("\u0047e\u0074H\u0061nd\u006cer"); if(_fe){ var _ff=e.getAttribute("\u0044\u0061tas\u006fu\u0072c\u0065\u0049d"); if(!_ff||_ff==""){ e.setAttribute("\u0044at\u0061\u0073\u006furc\u0065I\u0064","\u0063o\u006c\u0075mn\u0044\u0061\u0074a\u0073o\u0075rce_"+i+"_"+this.uid); } this.data.add(new Eba.TableDataSource(e.getAttribute("\u0044\u0061\u0074\u0061\u0073ou\u0072\u0063\u0065\u0049\u0064"),_fe,null)); var _100=this.data.getTable(e.getAttribute("Data\u0073\u006furceI\u0064")); var _101=[]; _101[0]=e; var data=_100.get(null,null,null,null,null,null); this.editorDataReady(e); } } this.setcontentWidth(wT+Number(this.getindicatorWidth())); this.setleft(wL+Number(this.getindicatorWidth())); this.setright(wR); this.setcontentHeight((this._h_6())+Number(this.getindicatorHeight())); ebaAssert(!isNaN(this.getcontentHeight()),"\u0063on\u0074en\u0074 \u0068\u0065\u0069gh\u0074\u0020\u0069s\u0020\u006e\u0061\u006e"); this.setColumnCount(_ec); } var _103; if(_ef){ _103=_ef.selectSingleNode("/"+ns+"gr\u0069\u0064\u002f"+ns+"datas\u006fur\u0063e\u0073"); } if(_103){ this.Declaration["dat\u0061\u0073o\u0075\u0072\u0063\u0065s"]=Eba.Xml.xmlDocFromString(_103.xml); } } var _104=new Array(); if(this.Declaration["d\u0061t\u0061\u0073o\u0075rces"]){ _104=this.Declaration["d\u0061\u0074as\u006f\u0075\u0072\u0063\u0065\u0073"].selectNodes("//"+ns+"\u0064\u0061\u0074\u0061\u0073\u006f\u0075rce\u0073/\u002a"); } if(_104.length>0){ for(var i=0;i<_104.length;i++){ var id=_104[i].getAttribute("i\u0064"); if("_\u0064\u0065\u0066aul\u0074"!=id){ var _106=new Eba.TableDataSource(id,Eba.Xml.xmlDocFromString(_104[i].xml.replace(/fieldnames=/g,"F\u0069\u0065\u006cdN\u0061me\u0073\u003d").replace(/keys=/g,"\u004beys\u003d"))); var _107=_e9.selectSingleNode("\u002f/\u0045\u0042\u0041C\u006flu\u006dn\u005b\u0040\u0044a\u0074a\u0073\u006f\u0075r\u0063e\u0049d='"+id+"\u0027]"); ebaAssert(_107!=null,"D\u0061ta \u0062\u006fu\u006ed\u0020\u0065dito\u0072\u0073 \u006du\u0073t s\u0070eci\u0066\u0079 a\u0020d\u0061t\u0061sou\u0072\u0063e\u002e","",EBA_THROW); this.data.add(_106); this.editorDataReady(_107); } } } },editorDataReady:function(_108){ var _109=_108.getAttribute("\u0044i\u0073p\u006ca\u0079Fie\u006c\u0064s").split("|"); var _10a=_108.getAttribute("\u0056\u0061\u006c\u0075\u0065\u0046ield"); var _10b=this.data.getTable(_108.getAttribute("Datasou\u0072\u0063\u0065\u0049\u0064")); if((_109.length==1&&_109[0]=="")&&(_10a==null||_10a=="")){ for(var item in _10b.fieldMap){ _109[0]=_10b.fieldMap[item].substring(1); break; } }else{ for(var i=0;i<_109.length;i++){ _109[i]=_10b.fieldMap[_109[i]].substring(1); } } var _10e=_109.join("|"); if(_10a==null||_10a==""){ _10a=_109[0]; }else{ _10a=_10b.fieldMap[_10a].substring(1); } _108.setAttribute("D\u0069s\u0070l\u0061\u0079Fi\u0065\u006cd\u0073",_10e); _108.setAttribute("V\u0061\u006c\u0075e\u0046i\u0065\u006cd",_10a); },sort:function(_10f,_110){ this.startMouseWait(); ebaAssert(typeof (_10f)!="\u0075\u006e\u0064\u0065\u0066in\u0065d","\u004e\u006f \u0063\u006f\u006c\u0075\u006dn \u0074o\u0020\u0073or\u0074."); var _111=this.getColumnObject(_10f); if(_111!=null){ if(_110==null||typeof (_110)=="u\u006ed\u0065\u0066\u0069\u006ee\u0064"){ _110=(_111.getSortDirection()=="\u0041sc")?"D\u0065\u0073\u0063":"\u0041\u0073\u0063"; } _111.setSortDirection(_110); var _112=_111.getHeaderElement(); this.sortColumn=_111; this.sortColumnCell=_112; var _113=this.data.getTable("\u005f\u0064\u0065\u0066au\u006ct"); if(_113.log.selectNodes("\u002f/"+ns+"\u0065").length>0){ var _114=confirm("\u0050erf\u006fr\u006din\u0067\u0020\u0074\u0068is ki\u006ed of\u0020s\u006f\u0072\u0074\u0020w\u0069ll \u0064\u0069\u0073\u0063a\u0072d\u0020any\u0020\u0063ha\u006ege\u0073 \u0079\u006f\u0075 ha\u0076\u0065 mad\u0065. Pre\u0073s \u004f\u004b \u0074o \u0063\u006f\u006et\u0069n\u0075\u0065\u0020an\u0064 lo\u0073\u0065 \u0079o\u0075\u0072 c\u0068\u0061\u006eg\u0065\u0073."); if(!_114){ this.stopMouseWait(); return; } } _113.sort=_111.getColumnName(); _113.sortDir=_110; var _115=function(){ _113._h_20(); }; var _116=function(){ this.stopMouseWait(); alert("\u0054\u0068\u0065 c\u006flu\u006d\u006e\u0020cou\u006c\u0064 \u006e\u006f\u0074\u0020be\u0020s\u006f\u0072\u0074\u0065d\u002e \u0054\u0068e\u0020\u0073e\u0072\u0076e\u0072 \u0072et\u0075\u0072\u006eed\u0020\u0061\u006e \u0065\u0072\u0072\u006f\u0072"); }; var _117=function(){ this.refilter(); }; _113.forceGet(0,this.getRowsPerPage(),this,_117,_116,_115); } return; },setColumnHeaderSortOrder:function(_118,_119){ var _11a=this.getColumnObject(_118); var _11b=_11a.getHeaderElement(); var css=_11b.className; if(_119==""){ css=css.replace(/ascending/gi,"").replace(/descending/gi,""); _119="\u0044\u0065s\u0063"; }else{ var _11d=(_119=="\u0044\u0065\u0073\u0063"?"d\u0065\u0073c\u0065\u006ed\u0069n\u0067":"as\u0063\u0065\u006ed\u0069ng"); if(css.indexOf("eb\u0061\u0063\u006flu\u006dnind\u0069\u0063\u0061to\u0072")!=-1){ css=css.replace(/ebacolumnindicator/gi,"\u0065b\u0061\u0063\u006f\u006c\u0075m\u006e\u0069\u006e\u0064ic\u0061\u0074\u006fr"+_11d); }else{ var str=(_119=="\u0044e\u0073c"?"as\u0063en\u0064in\u0067":"\u0064\u0065\u0073\u0063\u0065\u006ed\u0069\u006eg"); var reg=new RegExp(str,"\u0067\u0069"); css=css.replace(reg,_11d); } } _11a.setSortDirection(_119); _11b.className=css; this.sortColumn=_11a; this.sortColumnCell=_11b; },startMouseWait:function(){ this.mouseWait=document.getElementById("\u0065b\u0061\u006do\u0075\u0073\u0065\u0077a\u0069\u0074\u005f"+this.uid); if(this.mouseWait==null){ this.mouseWait=document.createElement("di\u0076"); this.mouseWait.id="\u0065bam\u006f\u0075s\u0065wait\u005f"+this.uid; this.mouseWait.className="\u0065b\u0061m\u006fu\u0073ewai\u0074"; document.body.appendChild(this.mouseWait); } this.mouseWait.style.display="\u0062lo\u0063\u006b"; if(IE){ Align(this.mouseWait,this.element,Align_SAMEHEIGHT|Align_SAMEWIDTH|Align_ALIGNTOP|Align_ALIGNLEFT); }else{ this.mouseWait.style.height=this.getHeight()+20; this.mouseWait.style.width=this.getWidth(); this.mouseWait.style.top=this.Declaration.inlinehtml.getBoundingClientRect().top-2; this.mouseWait.style.left=this.Declaration.inlinehtml.getBoundingClientRect().left; } },stopMouseWait:function(){ if(this.mouseWait!=null&&typeof (this.mouseWait)!="\u0075nd\u0065fi\u006e\u0065\u0064"){ this.mouseWait.style.top="-1000"; this.mouseWait.style.left="\u002d\u0031\u003000"; this.mouseWait.style.display="\u006e\u006fn\u0065"; } },_h_32:function(){ },initializeModelFromDeclaration:function(){ this.setDisplayedRowCount(this.getRowCount()); eval(Eba.Xml.transformToString(this.Interface,this.modelInitializerXslProc)); this.settop(this._h_6(0,this.getfreezetop())+(this.isColumnIndicatorsEnabled()?1:0)*this.getindicatorHeight()); this.setbottom(this._h_6(0,this.getfreezebottom())); this.setright(this.getfreezeright()*this.getcellWidth()); },_h_79:function(){ this.settop(this._h_6(0,this.getfreezetop())+this.isColumnIndicatorsEnabled()*this.getindicatorHeight()); this.setbottom(this._h_6(0,this.getfreezebottom())); this.setright(this.getfreezeright()*this.getcellWidth()); },_h_43:function(){ this.Declaration["g\u0072i\u0064"]=Eba.Xml.createXmlDoc(); var _120=this.element.firstChild; var _121="h\u0074\u0074p://\u0077\u0077w\u002e\u0065\u0062\u0075sine\u0073\u0073a\u0070p\u006c\u0069ca\u0074\u0069\u006fns\u002e\u0063\u0061/eba\u0067\u0072\u0069\u0064#"; this.Declaration.grid=Eba.Xml.xmlDocFromString("<eba:grid xmlns:XSL=\"http://xsl\" xmlns:eba=\""+_121+"\"></eba:grid>"); oAttrColl=this.element.attributes; for(i=0;i<oAttrColl.length;i++){ oAttr=oAttrColl.item(i); sName=oAttr.nodeName; vValue=oAttr.nodeValue; if(oAttr.specified&&"x\u006d\u006c\u006e\u0073:\u0065\u0062\u0061"!=sName){ this.Declaration.grid.documentElement.setAttribute(sName,vValue); } } while(_120!=null){ if(typeof (_120.tagName)!="un\u0064\u0065fined"){ var tag=_120.tagName.replace(/eba\:/gi,"").toLowerCase(); if(tag=="inli\u006e\u0065\u0068\u0074m\u006c"){ this.Declaration[tag]=_120; }else{ var _121="http:/\u002f\u0077w\u0077.eb\u0075s\u0069nes\u0073ap\u0070l\u0069c\u0061t\u0069\u006f\u006e\u0073.\u0063a\u002fe\u0062a\u0067\u0072id#"; if(tag=="\u0063o\u006cu\u006d\u006e\u0064e\u0066in\u0069\u0074ion"){ var sXml; if(IE){ sXml=("<"+ns+"grid xmlns:eba=\""+_121+"\"><"+ns+"column\u0073\u003e"+_120.parentNode.innerHTML.substring(31).replace(/\=\s*([^\"^\s^\>]+)/g,"=\"$1\" ")+"</"+ns+"c\u006fl\u0075\u006dn\u0073\u003e\u003c\u002f"+ns+"\u0067r\u0069d>"); }else{ sXml="<"+ns+"grid xmlns:eba=\""+_121+"\"><"+ns+"\u0063o\u006c\u0075mns\u003e"+_120.parentNode.innerHTML.replace(/\=\s*([^\"^\s^\>]+)/g,"=\"$1\" ")+"\u003c/"+ns+"\u0063ol\u0075\u006d\u006e\u0073\u003e</"+ns+"g\u0072\u0069d\u003e"; } sXml=sXml.replace(/\&nbsp\;/gi,"\u0020"); this.Declaration["co\u006c\u0075\u006d\u006e\u0064\u0065f\u0069n\u0069t\u0069on\u0073"]=Eba.Xml.createXmlDoc(); this.Declaration["\u0063olumnd\u0065fi\u006e\u0069\u0074\u0069o\u006es"].validateOnParse=false; this.Declaration["co\u006c\u0075\u006dn\u0064\u0065\u0066\u0069n\u0069tion\u0073"].loadXML(sXml); break; }else{ if(IE){ this.Declaration[tag]=Eba.Xml.createXmlDoc(); this.Declaration[tag].validateOnParse=false; var sXml=_120.outerHTML.substring(31).replace(/\=\s*([^\"^\s^\>]+)/g,"=\"$1\" ").replace(/\>/," xmlns:eba=\""+_121+"\" >"); this.Declaration[tag].loadXML(sXml); }else{ this.Declaration[tag]=Eba.Xml.xmlDocFromString(("\u003c"+ns+tag+" xmlns:eba=\""+_121+"\">"+_120.innerHTML.replace(/\=\s*([^\"^\s^\>]+)/g,"=\"$1\" ").replace(/\n/g,"")+"\u003c\u002f"+ns+tag+"\u003e").replace(/\>\s*\</gi,"\u003e\u003c")); } } } } _120=_120.nextSibling; } if(typeof (this.Declaration.inlinehtml)=="und\u0065fi\u006e\u0065\u0064"){ var _124=document.createElement("eb\u0061\u003a\u0069n\u006c\u0069ne\u0068t\u006dl"); _124.setAttribute("\u0070\u0061r\u0065ntid","\u0067ri\u0064"+this.model.selectSingleNode("stat\u0065").getAttribute("\u0075\u006ei\u0071\u0075e\u0049\u0044")); this.element.insertAdjacentElement("\u0062efore\u0045\u006ed",_124); this.Declaration.inlinehtml=_124; } },_h_44:function(_125){ this.Scroller._h_37(_125); },_h_33:function(){ },generateCss:function(){ if(this.stylesheet==null){ this.stylesheet=document.createStyleSheet(); } var _126=Eba.Xml.transformToString(this.model,this.frameCssXslProc); this.stylesheet.cssText=_126; if(this.Scroller){ this.Scroller.view.topcenter.surface.element.style.width=""; this.Scroller.setHScrollbarRange(""); this.Scroller.view.midcenter.element.firstChild.style.width=""; this.Scroller.view.midcenter.element.firstChild.firstChild.style.height=""; this.Scroller.view.midcenter.element.firstChild.style.height=""; this.Scroller.view.midcenter.element.style.height=""; this.Scroller.view.midcenter.element.firstChild.childNodes[1].style.height=""; var vs=document.getElementById("\u0076s\u0063\u0072\u006fll"+this.uid); vs.firstChild.style.height=""; this.Scroller.view.midcenter.surface.element.style.width=""; this.Scroller.view.topcenter.element.style.left=""; } try{ for(ss in document.styleSheets){ var _128=document.styleSheets[ss].rules||document.styleSheets[ss].cssRules; for(rule in _128){ var _129=_128.item(rule)||_128[rule]; if(_129.selectorText==".e\u0062\u0061r\u006f\u0077hover"){ EBARowHoverColor=_129.style.backgroundColor.toString(); if(EBARowHoverColor.indexOf("rgb")>-1){ EBARowHoverColor=eval(EBARowHoverColor); } } if(_129.selectorText==".e\u0062acellh\u006fv\u0065r"){ EBACellHoverColor=_129.style.backgroundColor; if(EBACellHoverColor.indexOf("\u0072g\u0062")>-1){ EBACellHoverColor=eval(EBACellHoverColor); } } if(_129.selectorText.indexOf("e\u0062\u0061m\u0069d\u0062l\u006fckco\u006etain\u0065\u0072")>-1){ if(this.Scroller){ this.Scroller.setLeftPaneWidth(_129.style.left); } } } } } catch(err){ } if(this.Scroller){ if(IE){ document.getElementById("\u0076s\u0063\u0072\u006fll"+this.uid).firstChild.style.height=""+parseInt(Eba.getStyle(document.getElementById("v\u0073\u0063\u0072o\u006cl"+this.uid).firstChild,"h\u0065\u0069\u0067\u0068\u0074")); } } },_h_9:function(){ this.Scroller._h_9(); },_h_52:function(){ o=document.createElement("d\u0069\u0076"); },_h_54:function(){ var _12a; var rows; if(this.getPagingMode().toLowerCase()=="st\u0061n\u0064a\u0072d"){ _12a=this.getfreezetop()+(this.getCurrentPageIndex()*this.getRowsPerPage()); rows=this.getRowsPerPage()-getfreezetop()-this.getfreezebottom(); }else{ _12a=this.getfreezetop(); rows=this.getDisplayedRowCount()-this.getfreezetop()-this.getfreezebottom()+1; } s=this.MidRightRenderer.render(_12a,_12a+rows-1); var o=document.createElement("\u0064i\u0076"); o.style.top=0; o.style.left=0; o.style.position="\u0072\u0065\u006c\u0061t\u0069\u0076\u0065"; o.innerHTML=s; var ri=this.Scroller.view.midright.placeholder; ri.replaceChild(o,ri.firstChild); },renderFrame:function(){ this.Declaration.inlinehtml.innerHTML=Eba.Xml.transformToString(this.model,this.frameXslProc); var _12e=0; if(this.isToolbarEnabled()){ _12e=25; } this.loadingScreen=document.createElement("div"); this.loadingScreen.style.height=this.getHeight()+_12e; this.loadingScreen.style.width=this.getWidth(); this.loadingScreen.style.top=this.Declaration.inlinehtml.getBoundingClientRect().top-2; this.loadingScreen.className="eba\u006c\u006fading"; this.loadingScreen.style.display="b\u006co\u0063\u006b"; this.loadingImg=document.createElement("\u0064\u0069\u0076"); this.loadingImg.className="e\u0062a\u006coa\u0064\u0069ngIc\u006fn"; this.loadingImg.style.height=this.getHeight()+_12e; this.loadingImg.style.width=this.getWidth(); this.loadingImg.style.top=this.Declaration.inlinehtml.getBoundingClientRect().top-2; this.loadingImg.style.display="\u0062loc\u006b"; var img=document.createElement("im\u0067"); img.src="\u0073\u0074yle\u0073/loa\u0064\u0069ng\u002e\u0067i\u0066"; img.style.display="\u006e\u006fn\u0065"; document.getElementsByTagName("b\u006fdy").item(0).appendChild(img); img=null; this.Declaration.inlinehtml.appendChild(this.loadingImg); this.Declaration.inlinehtml.appendChild(this.loadingScreen); var vs=document.getElementById("v\u0073\u0063\u0072\u006fll"+this.uid); var hs=document.getElementById("hs\u0063ro\u006cl"+this.uid); var dx=0,dy=0; if(MOZ){ dx=-3; dy=-2; } Align(vs,this.Declaration.inlinehtml.childNodes[0],269484288,-42,0,22,dx,false); Align(hs,this.Declaration.inlinehtml.childNodes[0],16846848,0,-22,dy,0,false); if(this.isToolbarEnabled()){ this._h_36(); this._h_55(); } var _133=this; Eba.EventManager.attach(this.Declaration.inlinehtml.firstChild,"\u006be\u0079\u0064\u006f\u0077n",this,function(){ _133.handleKey.apply(_133,arguments); },false); },_h_51:function(){ var _134=0; endRow=this.getfreezetop()-1; this.Scroller.view.topleft.surface.element.innerHTML=""; this.Scroller.view.topleft.top=this.getindicatorHeight(); this.Scroller.view.topleft.left=0; this.Scroller.view.topleft.EBARowRenderer=this.TopLeftRenderer; this.Scroller.view.topleft._h_50(_134,endRow,false,"*"); this.Scroller.view.topright.surface.element.innerHTML=""; this.Scroller.view.topright.top=this.getindicatorHeight(); this.Scroller.view.topright.left=0; this.Scroller.view.topright.EBARowRenderer=this.TopRightRenderer; this.Scroller.view.topright._h_50(_134,endRow,false); this.Scroller.view.topcenter.surface.element.innerHTML=""; this.Scroller.view.topcenter.top=this.getindicatorHeight(); this.Scroller.view.topcenter.left=0; this.Scroller.view.topcenter.EBARowRenderer=this.TopCenterRenderer; this.Scroller.view.topcenter._h_50(_134,endRow,false); },_h_49:function(){ },_h_53:function(){ this.Scroller.view.midleft.cacheMap._h_20(); this.Scroller.view.midleft.requestCacheMap._h_20(); this.Scroller.view.midcenter.cacheMap._h_20(); this.Scroller.view.midcenter.requestCacheMap._h_20(); this.Scroller.render(); },_h_36:function(){ this.toolbarXml.documentElement.setAttribute("id","\u0074\u006f\u006f\u006c\u0062ar"+this.uid); this.toolbarXml.documentElement.setAttribute("im\u0061g\u0065_\u0064ire\u0063to\u0072\u0079",gResourcePath+"\u0072esou\u0072c\u0065\u0073\u002fto\u006f\u006cba\u0072/\u0064\u0065faul\u0074"); var _135=this.toolbarXml.selectNodes("\u002ft\u006f\u006f\u006c\u0062\u0061r\u002f\u0069\u0074ems/\u002a"); for(var i=0;i<_135.length;i++){ if(_135[i].nodeType!=8){ _135[i].setAttribute("\u0069d",_135[i].getAttribute("\u0069\u0064")+this.uid); } } this.toolbar=new Eba.Toolbar(this.toolbarXml.xml,"\u0074o\u006flba\u0072"+this.uid); this.toolbarPagingXml.documentElement.setAttribute("id","\u0074o\u006f\u006c\u0062\u0061r\u0070a\u0067\u0069n\u0067"+this.uid); this.toolbarPagingXml.documentElement.setAttribute("\u0069ma\u0067\u0065\u005fd\u0069\u0072ecto\u0072\u0079",gResourcePath+"\u0072e\u0073\u006fur\u0063\u0065\u0073\u002f\u0074o\u006flba\u0072\u002f\u0064e\u0066a\u0075l\u0074"); _135=(this.toolbarPagingXml.selectNodes("/t\u006f\u006f\u006c\u0062ar\u002fitems/\u002a")); for(var i=0;i<_135.length;i++){ if(_135[i].nodeType!=8){ _135[i].setAttribute("\u0069d",_135[i].getAttribute("\u0069d")+this.uid); } } this.toolbarPaging=new Eba.Toolbar(this.toolbarPagingXml.xml,"\u0074o\u006flbarp\u0061g\u0069\u006eg"+this.uid); },_h_55:function(){ if(this.isToolbarEnabled()){ var _137=document.getElementById("t\u006fol\u0062a\u0072\u0043ont\u0061\u0069\u006ee\u0072"+this.uid); var _138=Align_SAMEWIDTH|Align_ALIGNBOTTOM|Align_ALIGNLEFT; Align(_137,this.Declaration.inlinehtml.childNodes[0],_138,0,0,25,false); _137.style.left=parseInt(_137.style.left)+1; var xsl=Eba.ToolbarXsl; if(xsl.indexOf("x\u0073l\u003a\u0073\u0074\u0079l\u0065\u0073h\u0065e\u0074")==-1){ xsl="<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"><xsl:output method=\"xml\" version=\"4.0\" />"+xsl+"\u003c\u002f\u0078s\u006c\u003ast\u0079\u006ceshe\u0065\u0074\u003e"; } var _13a=Eba.Xml.createXslDoc(xsl); var _13b=Eba.Xml.createXmlDoc(this.toolbar.getXml()); var _13c=Eba.Xml.transformToString(_13b,_13a,"x\u006dl"); _137.innerHTML=_13c; _137.style.zIndex="100\u0030"; if(this.getPagingMode().toLowerCase()=="\u0073\u0074\u0061n\u0064\u0061\u0072d"){ _13b=Eba.Xml.createXmlDoc(this.toolbarPaging.getXml()); var _13d=Eba.Xml.transformToString(_13b,_13a,"\u0078\u006dl"); _137.innerHTML+=_13d; } _13a=null; _13b=null; this.Declaration["inl\u0069neht\u006dl"].childNodes[0].style.height=parseInt(this.Declaration["\u0069\u006e\u006ci\u006e\u0065h\u0074ml"].childNodes[0].offsetHeight)+25; this.toolbar.attachToTag(); if(this.getPagingMode().toLowerCase()=="s\u0074\u0061\u006e\u0064a\u0072d"){ this.toolbarPaging.attachToTag(); this.toolbar.setWidth(this.getWidth()-2-parseInt(this.toolbarPaging.getWidth())); }else{ this.toolbar.setWidth(this.getWidth()-2); } var _13e=this; var _13f=this.toolbar.getUiElements(); _13f["save"+this.uid].onClick=function(){ _13e.save(); }; _13f["n\u0065w\u0052\u0065c\u006f\u0072\u0064"+this.uid].onClick=function(){ _13e.insertAfterCurrentRow(); }; if(!this.isRowInsertEnabled()){ _13f["ne\u0077Rec\u006frd"+this.uid].disable(); } _13f["\u0064\u0065\u006cete\u0052\u0065c\u006frd"+this.uid].onClick=function(){ _13e.deleteCurrentRow(); }; _13f["refresh"+this.uid].onClick=function(){ var _140=confirm("\u0052ef\u0072es\u0068in\u0067 \u0077i\u006c\u006c \u0064\u0069\u0073ca\u0072\u0064 an\u0079\u0020\u0063\u0068a\u006eg\u0065\u0073\u0020you\u0020have \u006dad\u0065\u002e \u0049\u0073\u0020it \u004f\u004b\u0020t\u006f ref\u0072\u0065\u0073\u0068\u003f"); if(_140){ _13e.refresh(); } }; if(this.getPagingMode().toLowerCase()=="\u0073\u0074\u0061nd\u0061r\u0064"){ var _141=this.toolbarPaging.getUiElements(); var _13e=this; _141["\u0070re\u0076i\u006f\u0075\u0073Pa\u0067e"+this.uid].onClick=function(){ _13e.onPreviousPage(); }; _141["p\u0072e\u0076\u0069o\u0075sPa\u0067e"+this.uid].disable(); _141["n\u0065\u0078tP\u0061\u0067e"+this.uid].onClick=function(){ _13e.onNextPage(); }; } } },refresh:function(){ this.data.getTable("_d\u0065fa\u0075lt")._h_20(); this.Scroller.flushCache(); var _142=function(){ this.refilter(); this.Scroller.swapPanes(true); }; this.data.getTable("\u005fd\u0065f\u0061\u0075\u006ct").get(0,this.getRowsPerPage(),this,_142); },_h_52:function(){ var left=0; var _144=0; var top=0; var _146=0; },handleKey:function(obj,e){ var evt=(IE)?window.event:e; switch(e.keyCode){ case 34: this.loadNextDataPage(); break; case 33: this.loadPreviousDataPage(); break; case 45: this.insertAfterCurrentRow(); break; case 46: this.deleteCurrentRow(); break; } if(this.Scroller.activeView!=null){ this.Scroller.activeView.handleKey(e); } evt.cancelBubble=true; evt.returnValue=false; return false; },GetJS:function(){ alert(arguments[1][0]); return this.version; },xGet:function(){ var node=this.model.documentElement; var p=arguments[0].lastIndexOf("."); if(p>0){ node=node.selectSingleNode(arguments[0].substr(0,p).replace(/\./g,"/")); } if(node!=null){ return node.getAttribute(arguments[0].substr(p+1)); } },xGET:function(){ var node=this.model.documentElement; var val=""; node=node.selectSingleNode(arguments[0]); if(node!=null){ val=node.nodeValue; } return val; },xSet:function(){ var node=this.model.documentElement; var p=arguments[0].lastIndexOf("\u002e"); if(p>0){ node=node.selectSingleNode(arguments[0].substr(0,p).replace(/\./g,"\u002f")); } if((node!=null)&&(arguments[1]!=null)){ node.setAttribute(arguments[0].substr(p+1),arguments[1]); } },xSET:function(){ var node=this.model.documentElement; node=node.selectSingleNode(arguments[0]); if((node!=null)&&(arguments[1][0]!=null)){ if(typeof (arguments[1][0])=="\u0062o\u006f\u006cean"){ node.nodeValue=_EbaBooleanToString(arguments[1][0]); }else{ node.nodeValue=arguments[1][0]; } } },jSET:function(name,_152){ this[name]=_152[0]; },GetDOM:function(){ alert(arguments[1][0]); return this.version; },edit:function(e){ var evt=(IE)?event:e; if(false==eval(this.getOnBeforeCellEditEvent()||"true")){ return; } var _155=null; var _156=null; var ctrl=null; if(evt){ _155=evt.keyCode||null; _156=evt.shiftKey||null; ctrl=evt.ctrlKey||null; } var _158=""; if(_156&&(_155>64)&&(_155<91)){ _158=String.fromCharCode(_155); } if(!_156&&(_155>47)&&(_155<58)){ _158=String.fromCharCode(_155); } if(!_156&&(_155>64)&&(_155<91)){ _158=String.fromCharCode(_155+32); } if(!_156&&_155>95&&_155<106){ _158=String.fromCharCode(_155-48); } if(!_156&&(_155==189)||(_155==109)){ _158="-"; } if(!_156&&(_155>186)&&(_155<188)){ _158=String.fromCharCode(_155-126); } if((!ctrl)&&(""!=_158)||(_155==113)||(_155==0)||(_155==null)||(_155==32)){ var cell=this.activeCell; this.cellEditor=EBAEditorFactory.getEditor(this,cell,this.model,this.data,_158,evt); if(this.cellEditor==null){ return; } this.cellEditor._h_66(this.editComplete); this.cellEditor._h_40(); }else{ return; } },move:function(h,v){ eval(this.OnMove); },selectCellByCoords:function(row,_15d){ this.setPosition(row,_15d); },setPosition:function(row,_15f){ var sc=this.Scroller; var scv=sc.view; if(row>=0&&row<this.getfreezetop()&&_15f>=0&&_15f<this.getFrozenLeftColumnCount()){ sc.activeView=scv.topleft; scvm=scv.topleft; scvm.ViewNavigator.DomNode=scvm.container; scvm.ViewNavigator.view=scvm; scvm.ViewNavigator.setPosition(row,_15f); } if(row>=0&&row<this.getfreezetop()&&_15f>=this.getFrozenLeftColumnCount()&&_15f<this.getColumnCount()){ sc.activeView=scv.topcenter; scvm=scv.topcenter; scvm.ViewNavigator.DomNode=scvm.container; scvm.ViewNavigator.view=scvm; scvm.ViewNavigator.setPosition(row,_15f); } if(row>=this.getfreezetop()&&row<this.getDisplayedRowCount()&&_15f>=0&&_15f<this.getFrozenLeftColumnCount()){ sc.activeView=scv.midleft; scvm=scv.midleft; scvm.ViewNavigator.DomNode=scvm.container; scvm.ViewNavigator.view=scvm; scvm.ViewNavigator.setPosition(row,_15f); } if(row>=this.getfreezetop()&&row<this.getDisplayedRowCount()&&_15f>=this.getFrozenLeftColumnCount()&&_15f<this.getColumnCount()){ sc.activeView=scv.midcenter; scvm=scv.midcenter; scvm.ViewNavigator.DomNode=scvm.container; scvm.ViewNavigator.view=scvm; scvm.ViewNavigator.setPosition(row,_15f); } },activate:function(e){ var evt=(IE)?event:e; this.activeCell=this.Scroller.activeView.activeCell; if(("\u0063\u006c\u0069\u0063k"==evt.type)||("\u006d\u006f\u0075\u0073\u0065\u0064o\u0077\u006e"==evt.type)){ eval(this.getOnCellClickEvent()); } },editComplete:function(_164){ var cell=_164.cell; var rXi=cell.getAttribute("\u0078\u0069"); var cXi=cell.getAttribute("co\u006c"); _164.editor.hide(); if(false==eval(this.getOnCellValidateEvent()||"true")){ return; } cell.innerHTML=_164.displayValue; cell.setAttribute("\u0076\u0061lu\u0065",_164.databaseValue); this.data.getTable("_d\u0065\u0066\u0061ult")._h_80(rXi,cell.getAttribute("\u0063\u006f\u006c\u0041\u0074\u0074r").substr(1),_164.databaseValue); this.focus(); },focus:function(){ try{ this.Declaration.inlinehtml.firstChild.focus(); } catch(e){ } },_h_7:function(low,high){ var _16a=0; var _16b=heights.selectNodes("//\u002a\u005b\u0040\u006c\u006f\u0077\u0020\u003e\u003d\u0020"+low+" \u0061n\u0064\u0020\u0040\u0068\u0069gh\u003c="+high+"\u005d"); for(var i=0;i<ranges.length;i++){ _16a+=(1+Math.min(_16b[i].getAttribute("\u0068\u0069gh"),high)-Math.max(_16b[i].getAttribute("lo\u0077"),low))*_16b[i].getAttribute("h\u0065i\u0067\u0068\u0074"); } return _16a; },getRowByCoords:function(_16d){ },getColumnByCoords:function(_16e){ },onmousemove:function(e){ var evt=(IE)?event:e; window.status+="m\u006fu\u0073\u0065\u0020mov\u0065"; var _171=evt.srcElement; if(_171!=null){ var This=_GLGrid(evt.srcElement); var S=This.selection; if(S.selecting){ if(evt.button!=1){ if(S.r0==S.r1&&S.c0==S.c1){ S.clear(); }else{ S.select(); } }else{ if(_171.parentNode.parentNode.getAttribute("\u0069\u0064").substring(0,3)=="\u0078\u006b\u0063"){ _171=_171.parentNode.parentNode; } if(_171.id.substring(0,3)=="x\u006b\u0063"){ var r=This.getRowByCoords(_171); var c=This.getColumnByCoords(_171); if(S.selected&&!evt.shiftKey){ S.clear(); S.init(r,c); }else{ S.redraw(r,c); } } } }else{ if(evt.button==1&&!S.selecting){ if(_171.parentNode.parentNode.getAttribute("\u0069d").substring(0,3)=="\u0078kc"){ _171=_171.parentNode.parentNode; } if(_171.id.substring(0,3)=="\u0078\u006b\u0063"){ var r=This.getRowByCoords(_171); var c=This.getColumnByCoords(_171); S.clear(); S.init(r,c); } } } } },makeXSL:function(){ var fL=this.getFrozenLeftColumnCount(); var fR=this.getfreezeright(); var cs=this.getColumnCount(); var rh=this.isRowHighlightEnabled(); var _17a=0; var _17b=fL; var _17c=Eba.Xml.xmlDocFromString(this.model.selectSingleNode("sta\u0074e\u002fE\u0042AC\u006flumn\u0073").xml); this.TopLeftRenderer._h_24(_17c,this.rowXslGeneratorXslProc,_17a,_17b,1,this.isRowIndicatorsEnabled(),rh); _17a=cs-fR; _17b=fR; this.TopRightRenderer._h_24(_17c,this.rowXslGeneratorXslProc,_17a,_17b,1,0); _17a=fL; _17b=cs-fR-fL; this.TopCenterRenderer._h_24(_17c,this.rowXslGeneratorXslProc,_17a,_17b,1,this.isRowIndicatorsEnabled(),rh); var _17a=0; var _17b=fL; this.BottomLeftRenderer._h_24(_17c,this.rowXslGeneratorXslProc,_17a,_17b,0,this.isRowIndicatorsEnabled(),rh); _17a=cs-fR; _17b=fR; this.BottomRightRenderer._h_24(_17c,this.rowXslGeneratorXslProc,_17a,_17b,0,0,0); _17a=fL; _17b=cs-fR-fL; this.BottomCenterRenderer._h_24(_17c,this.rowXslGeneratorXslProc,_17a,_17b,0,0,0); this.MidLeftRenderer._h_24(_17c,this.rowXslGeneratorXslProc,0,fL,0,this.isRowIndicatorsEnabled(),rh); var _17a=cs-fR; var _17b=fR; this.MidRightRenderer._h_24(_17c,this.rowXslGeneratorXslProc,_17a,_17b,0,0,0); this.MidCenterRenderer._h_24(_17c,this.rowXslGeneratorXslProc,fL,cs-fR-fL,0,0,rh); },refilter:function(){ var _17d=(this._h_6())+Number(this.getindicatorHeight())+Number(this.getscrollbarHeight()); this.setcontentHeight(_17d); ebaAssert(!isNaN(this.getcontentHeight()),"content\u0020\u0068\u0065i\u0067\u0068t is \u006ean"); this.Scroller.contentHeight=_17d; this._h_9(); this._h_51(); this._h_49(); this._h_53(); this.Scroller.alignSurfaces(); var vs=this.Scroller.VScrollbar; if(vs.scrollHeight-vs.clientHeight!=0){ var _17f=(vs.scrollTop)/(vs.scrollHeight-vs.clientHeight); this.Scroller._h_68(_17f+1); this.Scroller._h_68(_17f); } if(typeof (this.Selection)!="\u0075\u006ed\u0065fi\u006ee\u0064"){ this.Selection.clear(); } this.Selection=new EBASelection(this); this.stopMouseWait(); },getNewRecordKey:function(){ var _180; var key; var _182; do{ _180=new Date(); key=(_180.getTime()+"."+Math.round(Math.random()*99)); _182=this.oXML.documentElement.selectSingleNode("/\u002f"+ns+"e\u005b\u0040x\u006b\u0020=\u0020\u0027"+key+"']"); }while(_182!=null); return key; },getColumnDefinitions:function(){ return this.model.selectNodes("\u0073\u0074a\u0074\u0065\u002fEBACol\u0075mn\u0073\u002f*"); },getNewRecordKey:function(){ var _183; var key; var _185; do{ _183=new Date(); key=(_183.getTime()+"\u002e"+Math.round(Math.random()*99)); _185=this.data.getTable("_default").xmlDoc.selectSingleNode("\u002f/"+ns+"\u0065[@x\u006b\u0020\u003d \u0027"+key+"']"); }while(_185!=null); return key; },insertColumn:function(_186){ var _187=this.getColumnCount()+1; this.setColumnCount(_187); var _188=this.model.selectSingleNode("/st\u0061t\u0065\u002f\u0044ef\u0061ult\u0073\u002f\u0045BACo\u006cum\u006e"); var i=_187-1; var _18a=_188.cloneNode(true); _18a.setAttribute("x\u0064at\u0061f\u006c\u0064","\u0040"+(i>25?String.fromCharCode(Math.floor(i/26)+97):"")+(String.fromCharCode(i%26+97))); _18a.setAttribute("x\u0069",_187-1); var _18b=this.model.selectSingleNode("\u002f\u0073ta\u0074e\u002fE\u0042\u0041\u0043\u006f\u006c\u0075\u006dns"); _18b.appendChild(_18a); var w=Number(this.model.selectSingleNode("/\u0073\u0074a\u0074e\u002f\u0044\u0065\u0066\u0061u\u006cts\u002fE\u0042\u0041\u0043olumn").getAttribute("w"))+this.getcontentWidth(); this.setcontentWidth(w); this.Scroller.contentWidth=w; this.makeXSL(); this.generateCss(); if(this.isAutoSaveEnabled()){ this.save(); }else{ this.refilter(); } eval(this.getOnAfterRowInsertEvent()); },deleteColumn:function(_18d){ var _18e=this.getColumnCount(); var ci=_18e-1; this.setColumnCount(ci); var data=this.data.getTable("_d\u0065fa\u0075\u006c\u0074").xmlDoc.selectSingleNode("/\u002f\u0072oo\u0074/\u0064a\u0074a"); var _191=this.getcontentWidth()-Number(this.data.getTable("\u005fd\u0065fa\u0075\u006ct").xmlDoc.selectSingleNode("//gri\u0064me\u0074a/\u0063o\u006c\u005b\u0040\u0078i="+ci+"]").getAttribute("w")); var _192=(_18e>25?String.fromCharCode(Math.floor(_18e/26)+97):"")+(String.fromCharCode(_18e%26+97)); var _193=data.selectNodes("\u0065"); for(var i=0;i<_193.length;i++){ if(_193[i].getAttribute(_192)){ var _195=_193[i].cloneNode(true); _195.setAttribute("\u0078\u0061c","\u0075"); _195.setAttribute(_192,""); this.logData.appendChild(_195); } _193[i].removeAttribute(_192); } _193=meta.selectNodes("\u0072"); for(var i=0;i<_193.length;i++){ var _196=_193[i].selectSingleNode("\u0063[\u0040\u0078i \u003d\u0020\u0027"+ci+"\u0027\u005d"); if(_196!=null){ var _195=_196.cloneNode(true); _195.setAttribute("\u0078\u0061c","\u0064"); _195.setAttribute("\u0078\u0069",ci); this.logMeta.appendChild(_195); _193[i].removeChild(_196); } } var _197=meta.selectSingleNode("\u0063\u006fl[@\u0078\u0069='"+ci+"\u0027]"); if(_197){ meta.removeChild(_197); } var _198=this.model.selectSingleNode("//st\u0061te\u002f\u0045\u0042AC\u006fl\u0075mns/\u0045\u0042\u0041Colum\u006e[@\u0078i="+ci+"]"); var _199=this.model.selectSingleNode("\u002f\u0073tat\u0065/E\u0042\u0041\u0043olu\u006d\u006e\u0073"); if(_199&&_198){ _199.removeChild(_198); } this.logMeta.setAttribute("n\u0075mco\u006c\u0073",meta.getAttribute("\u006eu\u006d\u0063\u006fl\u0073")); this.logMeta.setAttribute("n\u0075m\u0072o\u0077\u0073",meta.getAttribute("\u006eumr\u006f\u0077s")); var xDel=this.logMeta.selectSingleNode("c\u006f\u006c[@\u0078i=\u0027"+ci+"'\u005d"); var sTag=""; if(xDel!=null){ sTag=xDel.getAttribute("\u0078\u0061\u0063"); this.logMeta.removeChild(xDel); } if(sTag!="\u0069"){ var xDel=this.model.selectSingleNode("\u002fs\u0074a\u0074\u0065\u002f\u0044efaults\u002fEB\u0041Column").cloneNode(true); xDel.setAttribute("\u0078\u0061\u0063","d"); xDel.setAttribute("\u0078\u0069",ci); } this.setcontentWidth(_191); this.Scroller.contentWidth=_191; this.resize(); this.makeXSL(); this.generateCss(); if(this.isAutoSaveEnabled()){ this.save(); }else{ this.refilter(); eval(this.getOnCellUpdateEvent()||""); } eval(this.getOnAfterRowDeleteEvent()); },insertAfterCurrentRow:function(){ if(this.activeCell&&this.activeCell.getAttribute("\u0078i")){ this.insertRow(parseInt(this.activeCell.getAttribute("\u0078\u0069"))); }else{ this.insertRow(); } },deleteCurrentRow:function(){ if(this.activeCell&&this.activeCell.getAttribute("xi")){ this.deleteRow(parseInt(this.activeCell.getAttribute("x\u0069"))); }else{ alert("Fi\u0072s\u0074\u0020\u0073\u0065\u006ce\u0063\u0074 \u0061\u0020r\u0065\u0063o\u0072d\u0020to\u0020del\u0065\u0074e\u002e"); } },insertRow:function(_19c){ var rows=parseInt(this.getDisplayedRowCount()); if(_19c==null){ alert("F\u0069\u0072s\u0074 s\u0065\u006c\u0065ct t\u0068\u0065 r\u006f\u0077\u0020w\u0068e\u0072e\u0020y\u006f\u0075\u0020\u0077a\u006et\u0020\u0074he\u0020new \u0072o\u0077 ins\u0065\u0072\u0074ed."); return; } var xi=parseInt((_19c==null?rows:parseInt(_19c)+1)); if((!this.isRowInsertEnabled())||!(eval(this.getOnBeforeRowInsertEvent()||"t\u0072u\u0065"))){ return; } this.data.getTable("_\u0064e\u0066\u0061u\u006c\u0074")._h_14(this.model.selectSingleNode("/\u0073\u0074at\u0065\u002fD\u0065f\u0061\u0075l\u0074\u0073/"+ns+"e"),xi); rows++; this.setDisplayedRowCount(rows); if(this.isAutoSaveEnabled()){ this.save(); }else{ this.refilter(); } eval(this.getOnCellUpdateEvent()||""); eval(this.getOnAfterRowInsertEvent()); },deleteRow:function(_19f){ ebaAssert(_19f>=0,"\u004dus\u0074 \u0073p\u0065\u0063ify\u0020a \u0072\u006fw t\u006f \u0064e\u006c\u0065t\u0065."); if((this.isRowDeleteEnabled())&&(eval(this.getOnBeforeRowDeleteEvent()||"t\u0072\u0075e"))){ rows=this.getDisplayedRowCount(); var xi=rows-1; this.data.getTable("_\u0064ef\u0061ult").deleteRecord(_19f); rows--; this.setDisplayedRowCount(rows); if(this.isAutoSaveEnabled()){ this.save(); }else{ this.refilter(); } eval(this.getOnCellUpdateEvent()||""); eval(this.getOnAfterRowDeleteEvent()); } },onNextPage:function(){ this.loadNextDataPage(); },loadNextDataPage:function(){ this.loadDataPage(this.getCurrentPageIndex()+1); },onPreviousPage:function(){ this.loadPreviousDataPage(); },loadPreviousDataPage:function(){ this.loadDataPage(this.getCurrentPageIndex()-1); },GetPage:function(_1a1){ ebaErrorReport("G\u0065tP\u0061ge\u0020\u0069\u0073 \u0064e\u0070\u0072\u0065\u0063\u0061\u0074ed please use \u006co\u0061\u0064\u0044\u0061t\u0061\u0050a\u0067\u0065\u0020\u0069nste\u0061\u0064","",EBA_DEBUG); this.loadDataPage(_1a1); },loadDataPage:function(_1a2){ if(this.getPagingMode().toLowerCase()=="st\u0061\u006e\u0064a\u0072d"){ if(_1a2>-1){ this.setCurrentPageIndex(_1a2); this.setDisplayedRowCount(this.getRowsPerPage()); } if(this.getCurrentPageIndex()==0){ this.toolbarPaging.getUiElements()["pr\u0065\u0076i\u006fu\u0073Pa\u0067e"+this.uid].disable(); }else{ this.toolbarPaging.getUiElements()["\u0070rev\u0069\u006fusPag\u0065"+this.uid].enable(); } } this.refilter(); },getSelectedLookupKey:function(){ return this.inputCell.result.attributes(1).value; },getSelectedRow:function(rel){ try{ var nRow=-1; var AC=this.activeCell; if(AC!=null){ nRow=parseInt(AC.getAttribute("xi")); if(rel){ nRow-=this.getfreezetop(); } } return nRow; } catch(err){ _ebaAssert(false,err.message); } },getRowObject:function(_1a6,_1a7){ try{ _ebaAssert((_1a6==0)||(_1a6==1),"\u0057ron\u0067\u0020pane s\u0070e\u0063\u0069\u0066\u0069\u0065d \u0069n g\u0065\u0074R\u006fwO\u0062j\u0065\u0063\u0074"); _ebaAssert((_1a6==0)?(this.freezeColumn>0):true,"T\u0072y\u0069n\u0067\u0020\u0074\u006f g\u0065t \u0074he\u0020l\u0065ft \u0070a\u006e\u0065\u0020\u0077i\u0074\u0068out \u0066r\u0065eze\u0020\u0063ol\u0075mns\u0020\u006f\u006e."); var _1a8=""; switch(parseInt(_1a6)){ case 0: _1a8="\u0078\u006b\u0066"; break; case 1: _1a8="\u0078\u006b"; break; default: _ebaAssert(false,"\u0055n\u006b\u006eo\u0077\u006e \u0070ane"); } return document.getElementById(_1a8+"\u005f"+_1a7); } catch(err){ _ebaAssert(false,err.message); return null; } },getOppositeRowObject:function(_1a9){ try{ _ebaAssert(_1a9!="","\u0049nv\u0061\u006ci\u0064\u0020\u0072\u006f\u0077 id\u0020\u0067\u0069\u0076e\u006e\u002e"); var _1aa=_1a9.indexOf("\u005f"); _ebaAssert(_1aa>=0,"B\u0061d\u0020r\u006f\u0077\u0020\u0069d in\u0020g\u0065tO\u0070p\u006f\u0073i\u0074\u0065R\u006f\u0077O\u0062\u006ae\u0063\u0074"); var _1ab=_1a9.substr(0,_1aa); var _1ac=_1a9.substr(_1aa+1); var _1ad=null; (_1ab=="x\u006b")?_1ad=this.getRowObject(0,_1ac):_1ad=this.getRowObject(1,_1ac); return _1ad; } catch(err){ _ebaAssert(false,err.message); return null; } },getSelectedColumn:function(rel){ try{ var nCol=-1; var AC=this.activeCell; if(AC!=null){ nCol=parseInt(AC.getAttribute("\u0063\u006f\u006c")); if(rel){ nCol-=this.getFrozenLeftColumnCount(); } } return nCol; } catch(err){ _ebaAssert(false,err.message); } },getSelectedColumnObject:function(){ try{ return this.getColumnObject(this.getSelectedColumn()); } catch(err){ _ebaAssert(false,err.message); } },rowCount:function(){ try{ var _1b1=document.getElementById("\u0072\u006f\u0077\u0073"+this.uid); return _1b1.children.length; } catch(err){ _ebaAssert(false,err.message); } },_h_10:function(){ try{ var _1b2=this.getColumnDefinitions(); return _1b2.length; } catch(err){ _ebaAssert(false,err.message); } },getCellText:function(row,col){ try{ var cell=this.getCellObject(row,col); return cell.innerText; } catch(err){ _ebaAssert(false,err.message); } },getCellObject:function(row,col){ var cell=new EBACell(this,row,col); return cell; },getStyleObject:function(id){ var _1ba=new EBAStyle(this,id); return _1ba; },getSelectedRowObject:function(xi){ var obj=null; if(this.Scroller.activeView!=null){ var r=this.Scroller.activeView.ViewNavigator.blockNavigator.currentRow; obj=new EBARow(this,r); } return obj; },getColumnObject:function(_1be){ ebaAssert(_1be>=0,"I\u006ev\u0061li\u0064 c\u006flu\u006dn \u0061\u0063\u0063\u0065\u0073s\u0065d."); var _1bf=null; if(_1be>=0){ _1bf=new EBAColumn(this,_1be); } return _1bf; },getSelectedCellObject:function(){ var obj=null; if(this.Scroller.activeView!=null){ var r=this.Scroller.activeView.ViewNavigator.blockNavigator.currentRow; var c=this.Scroller.activeView.ViewNavigator.blockNavigator.currentColumn; obj=this.getCellObject(r,c); } return obj; },setCellValue:function(row,col,val){ },_h_4:function(){ if(this.activeCell.innerText.replace(/\s/g,"")!=""&&this.autoAdd){ this._h_17(); if(this.active=="Y"){ this._h_21(); } eval(this.getOnRowBlurEvent()); this.insertRow(); this.go("HOME"); this.editCell(); } },position:function(){ var AC=this.activeCell; var EL=this.element; var R1=AC.getClientRects(); var R2=EL.getClientRects(); var _1ca=document.getElementById("\u0062o\u0064y"+this.uid); var R3=_1ca.getClientRects(); var st=R1[0].top-R2[0].top-parseInt(this.head.clientHeight); if(st<0){ _1ca.scrollTop+=st-2; } var st=R1[0].top-R2[0].top+parseInt(this.getRowHeight())-this.body.clientHeight-parseInt(this.head.clientHeight)-0; if(st>0){ _1ca.scrollTop+=st; } var sb=this.scrollbarWidth; var st=R1[0].left-R3[0].left-0; if(st<0){ _1ca.scrollLeft+=st-sb; } var st=R1[0].right-R3[0].left-this.body.clientWidth-0; if(st>0){ _1ca.scrollLeft+=st+4; } },save:function(){ if(this.data.getTable("\u005f\u0064\u0065fault").log.selectNodes("/\u002f"+ns+"\u0064\u0061t\u0061/\u002a").length==0){ return; } if((this.isAutoSaveEnabled())&&!eval(this.getOnBeforeSaveEvent()||"\u0074\u0072u\u0065")){ return; } this.loadingImg.style.display="b\u006co\u0063\u006b"; this.loadingScreen.style.display="\u0062\u006co\u0063\u006b"; var _1ce=this; this.data.getTable("_\u0064efaul\u0074").save(function(){ _1ce._h_62.apply(_1ce,arguments); },this.getOnBeforeSaveEvent()); },_h_62:function(_1cf){ this.loadingScreen.style.display="n\u006fne"; this.loadingImg.style.display="n\u006f\u006e\u0065"; eval(this.getOnAfterSaveEvent()); },_h_5:function(){ },scrollv:function(_1d0){ var vs=document.getElementById("\u0076sc\u0072\u006fll"+this.uid); var _1d2=10; if(vs.scrollHeight-vs.clientHeight!=0){ var t=new Date().valueOf(); var _1d4=(vs.scrollTop)/(vs.scrollHeight-vs.clientHeight); this.Scroller._h_68(_1d4); this.Scroller.speed=(this.lastScrollPercent-_1d4)/(t-this.lastinterval); this.lastScrollPercent=_1d4; if(this.Scroller.speed==0||((numRequestsFilled==numRequests)&&Math.abs(this.Scroller.speed)<0.000001&&t-this.lastinterval>_1d2)||this.interval==null||_1d0){ this.Scroller.render(); this.lastinterval=t; } } return; },scrollh:function(){ var hs=document.getElementById("hsc\u0072\u006f\u006c\u006c"+this.uid); var _1d6=(hs.scrollLeft)/(hs.scrollWidth-hs.clientWidth); this.Scroller._h_67(_1d6); if(this.Scroller.view.midleft.placeholder.parentNode.parentNode.parentNode.childNodes[1].style.visibility!="h\u0069d\u0064e\u006e"){ if(!this.hScrollHasFocus&&!IE){ this.Scroller.swapPanes(false); } } return; },setDisplayedRowCount:function(_1d7){ ebaAssert(!isNaN(_1d7),"\u0064\u0069s\u0070la\u0079\u0065\u0064 ro\u0077 wa\u0073 \u0073e\u0074\u0020\u0074\u006f\u0020\u006e\u0061\u006e"); if(this.Scroller){ this.Scroller.view.midcenter.rows=_1d7; this.Scroller.view.midleft.rows=_1d7; } this.displayedRowCount=_1d7; },getDisplayedRowCount:function(){ ebaAssert(!isNaN(this.displayedRowCount),"d\u0069\u0073\u0070\u006cayed\u0020ro\u0077\u0020\u0063\u006funt\u0020r\u0065\u0074u\u0072\u006e\u0020n\u0061n"); return this.displayedRowCount; },_h_39:function(_1d8){ var _1d9=Eba.Xml.createXmlDoc(); _1d9.loadXML(_1d8); var _1da=_1d9.selectNodes("\u002f\u002fdata[@\u0069\u0064='\u005f\u0064e\u0066aul\u0074'\u005d/e[@\u0078\u0061\u0063=\u0027\u0064\u0027\u005d").length; var _1db=this.data.getTable("\u005fdef\u0061u\u006c\u0074").xmlDoc.selectNodes("/\u002fd\u0061\u0074a\u005b\u0040\u0069d='\u005fde\u0066au\u006c\u0074\u0027]/\u0065").length; while(0!=_1da--){ var _1dc=_1d9.selectSingleNode("//data\u005b@id\u003d'_d\u0065\u0066\u0061ult\u0027\u005d/\u0065\u005b@\u0078ac='\u0064'\u0020and @\u0078i='"+(_1db-_1da)+"'\u005d"); alert(_1dc?_1dc.xml:"n\u0061da"); ebaAssert((null!=_1dc),"\u0054\u0068\u0065 \u0075pda\u0074e\u0047\u0072a\u006d\u0020\u0066\u0072o\u006d t\u0068\u0065\u0020s\u0065\u0072ve\u0072 c\u0061n\u0020\u006f\u006e\u006cy incl\u0075d\u0065\u0020\u0064ele\u0074e i\u006e\u0073tr\u0075\u0063\u0074\u0069o\u006e\u0020f\u006fr \u0074he\u0020\u004e \u0062\u006f\u0074\u0074\u006f\u006d\u006d\u006f\u0073\u0074\u0020r\u006f\u0077\u0073\u002e\u0020D\u0065\u006c\u0065\u0074\u0065 r\u0065q\u0075\u0065\u0073\u0074\u0020\u0066\u006fr\u0020ro\u0077 \u006e\u0075mber ["+(_1db-_1da)+"] \u006eo\u0074\u0020\u0066\u006fu\u006ed\u002e","",EBA_THROW); } var _1dd=Eba.Xml.createXmlDoc(); _1dd.async=false; _1dd.load(gResourcePath+"x\u0073l\u002f\u006d\u0065rg\u0065U\u0070d\u0061\u0074\u0065A\u0074\u0074ri\u0062\u0075\u0074e\u0073\u0058s\u006c\u002e\u0078slt"); var _1de=_1dd.selectSingleNode("\u002f\u002fx\u0073\u006c\u003a\u0074\u0065m\u0070lat\u0065[@n\u0061\u006de='x\u006dl\u0055pd\u0061t\u0065\u0027\u005d/upda\u0074\u0065"); _1de.appendChild(_1d9.selectSingleNode("\u002f\u002f\u0072o\u006f\u0074")); if(_1dd.parseError&&_1dd.parseError.reason!=""){ ebaErrorReport("M\u0065\u0072\u0067\u0065\u0055p\u0064\u0061\u0074\u0065\u0020Fa\u0069l\u0065\u0064\u002e\u003a"+_1dd.parseError.reason,"",EBA_ERROR); } this.data.getTable("\u005fdefaul\u0074").xmlDoc.transformNodeToObject(_1dd,this.data.getTable("_\u0064e\u0066\u0061u\u006c\u0074").xmlDoc); return; }}; EBAGrid.prototype.dispose=function(){ try{ this.element.object=null; this.element=null; this.Declaration.inlinehtml=null; editorXslProc=null; this.model=null; this.API=null; this.Declaration["\u0067\u0072i\u0064"]=null; this.Declaration["col\u0075\u006dn\u0064\u0065\u0066\u0069\u006e\u0069t\u0069o\u006e\u0073"]=null; this.Declaration=null; this.toolbarXml=null; this.frameCssXslProc=null; this.modelInitializerXslProc=null; this.declarationTranslatorXslProc=null; this.rowXslGeneratorXslProc=null; this.frameXslProc=null; this.accessorGeneratorXslProc=null; this.toolbarPagingXml=null; this.Interface=null; if(this.toolbar&&this.toolbar.dispose){ this.toolbar.dispose(); this.toolbar=null; } if(this.toolbarPaging&&this.toolbarPaging.dispose){ this.toolbarPaging.dispose(); this.toolbarPaging=null; } if(this.data&&this.data.dispose){ this.data.dispose(); this.data=null; } for(var v in this.Scroller.view){ try{ this.Scroller.view[v].dispose(); } catch(e){ } } this.Scroller.dispose(); this.Scroller=null; EBAEditorFactory.dispose(); } catch(e){ } }; function gCompareUpdategramNode(_1e0,_1e1){ try{ if(_1e0.baseName!=_1e1.baseName){ return false; } if(_1e0.nodeValue!=_1e1.nodeValue){ return false; } if(_1e0.attributes.length!=_1e1.attributes.length){ return false; } for(var i=0;i<_1e0.attributes.length;i++){ if(_1e0.attributes[i].value!=_1e1.attributes.getNamedItem(_1e0.attributes[i].name).value){ return false; } } return true; } catch(err){ _ebaAssert(false,"\u0043ou\u006cd\u0020n\u006ft\u0020\u0063\u006f\u006dp\u0061r\u0065\u0020\u0075\u0070\u0064\u0061\u0074eg\u0072a\u006d\u0020\u006e\u006fde\u0073.\u0020"+err.message); return false; } } g_LOG_DEFAULT="\u003c"+ns+"gri\u0064 "+xmlns+"\u003e\u003c"+ns+"d\u0061t\u0061sour\u0063\u0065s \u0069\u0064\u003d\u0027i\u0064\u0027><"+ns+"datasource id=\"_default\"><"+ns+"data id=\"_default\"></"+ns+"d\u0061ta></"+ns+"\u0064atasou\u0072\u0063\u0065><\u002f"+ns+"\u0064\u0061\u0074\u0061\u0073\u006f\u0075rc\u0065\u0073\u003e\u003c\u002f"+ns+"\u0067\u0072\u0069d>"; Eba.DataSourceManager=Class.create(); Eba.DataSourceManager.prototype={initialize:function(){ this.tables=new Array(); },add:function(_1e3){ ebaAssert(!this.tables[_1e3.id],"T\u0068\u0069\u0073\u0020ta\u0062\u006ce d\u0061\u0074a sourc\u0065\u0020\u0068\u0061\u0073\u0020\u0061lr\u0065\u0061\u0064\u0079 b\u0065e\u006e\u0020added\u002e","",EBA_THROW); this.tables[_1e3.id]=_1e3; },getTable:function(_1e4){ return this.tables[_1e4]; },xmlDoc:function(){ var _1e5="ht\u0074\u0070:\u002f/\u0077\u0077w.\u0065busine\u0073\u0073\u0061\u0070\u0070\u006c\u0069c\u0061ti\u006f\u006es.c\u0061/eba\u0067\u0072\u0069\u0064#"; var _1e6=Eba.Xml.xmlDocFromString("<"+ns+"datasources xmlns:eba=\""+_1e5+"\"></"+ns+"\u0064\u0061tas\u006fu\u0072\u0063\u0065\u0073\u003e"); for(var i in this.tables){ if(this.tables[i].xmlDoc){ var _1e8=this.tables[i].xmlDoc.selectSingleNode("\u002f\u002f"+ns+"d\u0061t\u0061\u0073\u006f\u0075rce").cloneNode(true); _1e6.selectSingleNode("\u002f"+ns+"\u0064\u0061\u0074\u0061\u0073\u006fu\u0072c\u0065s").appendChild(_1e8); } } return _1e6; },dispose:function(){ for(var _1e9 in this.tables){ this.tables[_1e9].dispose(); } }}; Eba.TableDataSource=Class.create(); Eba.TableDataSource.prototype={initialize:function(_1ea,_1eb,_1ec,_1ed,_1ee,sort,_1f0,_1f1,_1f2){ this.version=3; this.log=Eba.Xml.createXmlDoc(); this.log.loadXML(g_LOG_DEFAULT); this.logData=this.log.selectSingleNode("\u002f/"+ns+"\u0064at\u0061\u0073\u006fur\u0063\u0065[\u0040id\u003d'_de\u0066\u0061ult']\u002f"+ns+"d\u0061ta"); this.id=_1ea; this.pageSize=_1ee; this.minPageSize=10; this.dataCache=new CacheMap(-1,-1); this.requestCache=new CacheMap(-1,-1); this.xmlDoc=null; this.datastructure=null; this.sort=sort; this.sortDir=_1f0||"A\u0073c"; this.onGenerateKey=_1f2; if(_1ed==null){ _1ed=0; } ebaAssert(_1eb!=null&&typeof (_1eb)!="\u0075n\u0064e\u0066in\u0065\u0064","\u0067\u0065\u0074Hand\u006c\u0065r is \u006eo\u0074 spe\u0063ifi\u0065\u0064\u0020\u0066o\u0072 t\u0068\u0065\u0020e\u0062a\u002e\u0074a\u0062\u006c\u0065d\u0061\u0074\u0061s\u006fu\u0072ce","",EBA_THROW); if(_1eb!=null){ if(typeof (_1eb)=="\u0073\u0074ri\u006e\u0067"){ this.ajaxCallbackPool=new Eba.CallbackPool(EBACallbackPool_MAXCONNECTIONS); this.ajaxCallbackPool.context=this; this.getHandler=_1eb; this.postHandler=_1ec; }else{ this.xmlDoc=_1eb; ebaAssert(typeof (this.xmlDoc.xml)!="\u0075\u006ede\u0066\u0069\u006e\u0065d","\u0056\u0061\u006c\u0069d\u0020\u0058ML\u0020\u0072equ\u0069\u0072\u0065d\u0020fo\u0072\u0020new\u0020\u0074a\u0062\u006ce\u0064a\u0074a\u0073o\u0075rce\u002e","",EBA_THROW); this.datastructure=this.xmlDoc.selectSingleNode("\u002f\u002f"+ns+"d\u0061ta\u0073our\u0063e\u005b@\u0069\u0064='"+this.id+"\u0027\u005d/"+ns+"\u0064\u0061t\u0061s\u006fu\u0072ces\u0074\u0072\u0075ct\u0075\u0072\u0065"); this._h_35(); } } this.ajaxCallback=new EBACallback(); var _1f3=Eba.Xml.createXslDoc(); _1f3.async=false; _1f3.load(gResourcePath+"x\u0073\u006c\u002fd\u0061\u0074\u0061Tr\u0061n\u0073la\u0074\u006frXs\u006c.x\u0073\u006ct"); this.dataTranslatorXslProc=Eba.Xml.createXslProcessor(_1f3); _1f3=null; var _1f4=Eba.Xml.createXslDoc(); _1f4.async=false; _1f4.load(gResourcePath+"xsl/updat\u0065gra\u006d\u0054\u0072a\u006es\u006c\u0061\u0074\u006f\u0072X\u0073\u006c.\u0078\u0073\u006ct"); this.updategramTranslatorXslProc=Eba.Xml.createXslProcessor(_1f4); _1f4=null; var _1f5=Eba.Xml.createXslDoc(); _1f5.async=false; _1f5.load(gResourcePath+"xsl/me\u0072ge\u0055\u0070d\u0061\u0074\u0065A\u0074tri\u0062ute\u0073Xs\u006c\u002ex\u0073\u006ct"); this.mergeAttributesXslProc=Eba.Xml.createXslProcessor(_1f5); _1f5=null; var _1f6=Eba.Xml.createXslDoc(); _1f6.async=false; _1f6.load(gResourcePath+"\u0078sl\u002fren\u0075\u006dber.xslt"); this.renumberXslProc=Eba.Xml.createXslProcessor(_1f6); _1f6=null; var _1f7=Eba.Xml.createXslDoc(); _1f7.async=false; _1f7.load(gResourcePath+"xsl/\u0061d\u006a\u0075stX\u0069\u002e\u0078s\u006c\u0074"); this.adjustXiXslProc=Eba.Xml.createXslProcessor(_1f7); _1f7=null; },_h_20:function(){ this.dataCache._h_20(); this.requestCache._h_20(); this.log.loadXML(g_LOG_DEFAULT); this.logData=this.log.selectSingleNode("/\u002f"+ns+"\u0064\u0061tas\u006f\u0075r\u0063e[@\u0069\u0064='_\u0064\u0065\u0066\u0061\u0075\u006ct'\u005d/"+ns+"\u0064ata"); this.xmlDoc=null; },_h_28:function(_1f8,_1f9){ var _1fa=_1f8,lastRow=_1f8+_1f9-1; var _1fb=this.dataCache._h_22(_1fa,lastRow); var _1fc=_1fb.length; return !(_1fc>0); },forceGet:function(_1fd,_1fe,_1ff,_200,_201,_202){ this.errorCallback=_201; this.successCallback=_202; this.context=_1ff; var _203=this.getHandler; (_203.indexOf("\u003f")==-1)?_203+="\u003f":_203+="\u0026"; _203+="Sta\u0072t\u0052e\u0063\u006f\u0072\u0064I\u006e\u0064ex\u003d\u0030\u0026\u0073\u0074art\u003d0&\u0050age\u0053\u0069\u007a\u0065="+_1fe+"\u0026\u0053\u006f\u0072tC\u006f\u006cu\u006d\u006e\u003d"+(this.sort||"")+"\u0026\u0053\u006f\u0072\u0074D\u0069r\u0065\u0063\u0074ion\u003d"+this.sortDir+"\u0026\u0054\u0061b\u006c\u0065\u0049d="+this.id+"&u\u0069d\u003d"+(new Date().getTime()); var _204=this.ajaxCallbackPool._h_59(); ebaAssert(Boolean(_204),"T\u0068\u0065\u0020d\u0061t\u0061\u0073\u006f\u0075rc\u0065\u0020is se\u0072v\u0069ng \u0074\u006f\u006f\u0020m\u0061n\u0079\u0020\u0063o\u006ene\u0063\u0074\u0069o\u006e\u0073\u002e\u0020Ple\u0061s\u0065\u0020tr\u0079\u0020a\u0067\u0061\u0069n lat\u0065\u0072.\u0020\u0023 c\u0075r\u0072\u0065\u006et conne\u0063\u0074i\u006fns\u003a\u0020"+this.ajaxCallbackPool.inUse.length); _204.handler=_203; _204.context=this; _204.onGetComplete=this.getComplete; _204.params=new Eba.GetCompleteEventArgs(0,_1fe-1,0,_1fe,_204,this,_1ff,_200); _204.get(); return; },get:function(_205,_206,_207,_208,_209,_20a){ this.errorCallback=_209; this.successCallback=_20a; if(this.id=="\u005f\u0064ef\u0061\u0075l\u0074"){ var _20b=_205,lastRow=_205+_206-1; var _20c=this.dataCache._h_22(_20b,lastRow); var _20d=_20c.length; ebaAssert(_20d==_20c.length,"n\u0075mCa\u0063h\u0065\u0047\u0061\u0070s !=\u0020\u0067\u0061\u0070\u0073.le\u006eg\u0074\u0068\u0020\u0064es\u0070\u0069\u0074\u0065\u0020\u0073\u0065\u0074\u0074in\u0067\u0020\u0069\u0074 \u0073\u006f\u002e\u0020\u0043\u006fn\u0063u\u0072r\u0065\u006e\u0063\u0079 \u0070r\u006f\u0062lem h\u0061s aris\u0065n\u002e"); if(_20d>0){ for(var i=0;i<_20d;i++){ var low=_20c[i].low; var high=_20c[i].high; ebaAssert(this.getHandler!=null&&typeof (this.getHandler)!="\u0075\u006e\u0064e\u0066i\u006e\u0065\u0064","\u0067\u0065\u0074H\u0061\u006edl\u0065\u0072\u0020n\u006ft\u0020\u0064e\u0066ined i\u006e\u0020t\u0061\u0062le \u0065\u0062\u0061.data\u0073o\u0075rc\u0065",EBA_THROW); var _211=this.getHandler; (_211.indexOf("\u003f")==-1)?_211+="?":_211+="\u0026"; _211+="S\u0074\u0061rt\u0052e\u0063\u006f\u0072\u0064I\u006e\u0064ex="+low+"&\u0073t\u0061r\u0074\u003d"+low+"\u0026Pa\u0067\u0065\u0053\u0069\u007ae\u003d"+(high-low+1)+"&S\u006f\u0072\u0074Co\u006c\u0075\u006d\u006e\u003d"+(this.sort||"")+"\u0026\u0053o\u0072tDirect\u0069\u006f\u006e\u003d"+this.sortDir+"\u0026\u0054ab\u006c\u0065\u0049d\u003d"+this.id+"\u0026\u0075\u0069\u0064="+(new Date().getTime()); var _212=this.ajaxCallbackPool._h_59(); ebaAssert(Boolean(_212),"\u0054\u0068\u0065 data\u0073\u006fu\u0072ce \u0069s \u0073er\u0076\u0069ng\u0020\u0074\u006f\u006f\u0020ma\u006ey c\u006f\u006e\u006e\u0065ctio\u006es\u002e\u0020\u0050l\u0065\u0061se t\u0072y\u0020\u0061ga\u0069n la\u0074e\u0072.\u0020# \u0063u\u0072r\u0065n\u0074\u0020co\u006en\u0065ct\u0069o\u006e\u0073: "+this.ajaxCallbackPool.inUse.length); _212.handler=_211; _212.context=this; _212.onGetComplete=this.getComplete; _212.asynchronous=true; _212.params=new Eba.GetCompleteEventArgs(_20b,lastRow,low,(high-low+1),_212,this,_207,_208); if(typeof (_208)!="\u0066u\u006ec\u0074i\u006f\u006e"){ _212.asynchronous=false; } return _212.get(); } }else{ if(_20b>0||lastRow>0){ var _213=new Eba.GetCompleteEventArgs(_20b,lastRow,_20b,lastRow-_20b+1,null,this,_207,_208); _213.callback.call(_213.context,_213); } } }else{ var _212=this.ajaxCallbackPool._h_59(); ebaAssert(Boolean(_212),"\u0054h\u0065\u0020d\u0061\u0074as\u006f\u0075\u0072ce \u0069\u0073\u0020\u0073e\u0072ving\u0020\u0074\u006f\u006f\u0020\u006d\u0061ny\u0020\u0063\u006f\u006en\u0065\u0063\u0074ion\u0073. \u0050lea\u0073e\u0020\u0074ry \u0061\u0067a\u0069\u006e\u0020\u006ca\u0074\u0065\u0072\u002e #\u0020c\u0075r\u0072ent\u0020c\u006fnne\u0063\u0074\u0069\u006f\u006es\u003a\u0020"+this.ajaxCallbackPool.inUse.length); var _211=this.getHandler; _212.handler=_211; _212.context=this; _212.onGetComplete=this.getComplete; _212.asynchronous=true; _212.params=new Eba.GetCompleteEventArgs(null,null,1,null,_212,this,_207,_208); if(typeof (_208)!="f\u0075\u006ection"){ _212.asynchronous=false; return this.getComplete(_212.get(),_212.params); }else{ _212.get(); } } },getComplete:function(xd,_215){ if(this.id!="\u005f\u0064\u0065faul\u0074"){ this.xmlDoc=null; } if(null==xd||null==xd.xml||""==xd.xml){ ebaAssert(null!=this.errorCallback,"T\u0068\u0065 \u0073e\u0072ve\u0072\u0020\u0072e\u0074u\u0072ned e\u0069\u0074he\u0072\u0020a\u006e \u0065\u0072r\u006fr\u0020\u006fr i\u006e\u0076\u0061\u006c\u0069\u0064 \u0058\u004d\u004c\u0020b\u0075\u0074\u0020t\u0068er\u0065\u0020\u0069s\u0020\u006eo\u0020e\u0072ro\u0072\u0020hand\u006c\u0065\u0072 in\u0020\u0074\u0061\u0062l\u0065data\u0073\u006f\u0075r\u0063e."); if(this.errorCallback){ this.errorCallback.call(this.context); } return; }else{ if(typeof (this.successCallback)=="\u0066\u0075\u006ect\u0069\u006fn"){ this.successCallback.call(this.context); } } var _216=null; if(xd.selectSingleNode("\u002fr\u006fo\u0074")){ this.version=2.8; this.dataTranslatorXslProc.addParameter("\u0073ta\u0072\u0074",_215.startXi,""); this.dataTranslatorXslProc.addParameter("id",this.id,""); var _217=xd.selectSingleNode("/ro\u006ft").getAttribute("f\u0069e\u006cds"); var _218=_217.split("|"); var i=_218.length; var _21a=(i>25?String.fromCharCode(Math.floor(i/26)+97):"")+(String.fromCharCode(i%26+97)); this.dataTranslatorXslProc.addParameter("\u0078\u006b\u0046\u0069e\u006cd",_21a,""); xd=Eba.Xml.transformToXml(xd,this.dataTranslatorXslProc); _216=xd.selectNodes("/\u002f"+ns+"\u0064\u0061taso\u0075r\u0063e[@id\u003d'"+this.id+"\u0027\u005d/"+ns+"\u0064at\u0061\u002f"+ns+"\u0065"); if(_216.length==0){ } }else{ _216=xd.selectNodes("\u002f\u002f"+ns+"\u0064\u0061\u0074\u0061s\u006fu\u0072\u0063\u0065[@i\u0064\u003d\u0027"+this.id+"'\u005d\u002f"+ns+"data\u002f"+ns+"\u0065"); var _21b=xd.selectSingleNode("\u002f/"+ns+"\u0064\u0061taso\u0075r\u0063\u0065[@\u0069d\u003d'"+this.id+"'\u005d\u002f"+ns+"\u0064at\u0061/"+ns+"\u0065"); if(_21b){ ebaAssert(Boolean(_21b.getAttribute("\u0078\u0069")),"\u004eo x\u0069 \u0077\u0061\u0073 re\u0074u\u0072n\u0065d\u0020in\u0020\u0074\u0068\u0065 da\u0074\u0061 from th\u0065 \u0073\u0065rve\u0072.\u0020\u0053er\u0076\u0065\u0072 m\u0075st\u0020\u0072et\u0075rn\u0020xi'\u0073 \u0069n \u0074he\u0020n\u0065\u0077\u0020form\u0061t\u002e","",EBA_THROW); ebaAssert(_215.startXi>=0,"\u0073t\u0061r\u0074\u0058I\u0020\u0069\u0073 in\u0063or\u0072\u0065c\u0074\u002e"); if(_21b.getAttribute("x\u0069")!=_215.startXi){ this.adjustXiXslProc.addParameter("star\u0074\u0069\u006egIn\u0064ex","0",""); this.adjustXiXslProc.addParameter("a\u0064\u006au\u0073\u0074me\u006e\u0074",_215.startXi+1,""); xd.loadXML(Eba.Xml.transformToString(xd,this.adjustXiXslProc,"\u0078\u006d\u006c")); }else{ this.adjustXiXslProc.addParameter("st\u0061rt\u0069\u006eg\u0049\u006e\u0064\u0065\u0078","\u0030",""); this.adjustXiXslProc.addParameter("\u0061dj\u0075st\u006d\u0065\u006et",1,""); xd.loadXML(Eba.Xml.transformToString(xd,this.adjustXiXslProc,"\u0078\u006d\u006c")); } } } if(this.xmlDoc==null){ this.xmlDoc=xd; ebaAssert(xd.xml!="","\u0056alid XM\u004c\u0020w\u0061\u0073 n\u006f\u0074 ret\u0075\u0072\u006e\u0065d fr\u006f\u006d\u0020\u0067\u0065\u0074\u0068an\u0064\u006c\u0065r: "+_215.ajaxCallback.handler,"",EBA_THROW); this.datastructure=xd.selectSingleNode("/\u002f"+ns+"da\u0074\u0061\u0073ource[@\u0069d\u003d'"+this.id+"\u0027]\u002f"+ns+"dat\u0061so\u0075r\u0063\u0065stru\u0063\u0074ur\u0065"); this._h_35(); }else{ var _21c=xd.selectNodes("\u002f/\u0065\u0062\u0061\u003a\u0064at\u0061\u0073o\u0075\u0072\u0063e\u005b\u0040id \u003d\u0020\u0027"+this.id+"\u0027\u005d\u002f\u002f\u0065ba:e"); var _21d=this.xmlDoc.selectSingleNode("\u002f/\u0065b\u0061\u003adat\u0061\u0073\u006f\u0075\u0072\u0063e\u005b\u0040id\u003d'"+this.id+"'\u005d/\u0065\u0062\u0061\u003adata"); var len=_21c.length; for(var i=0;i<len;i++){ if(this.xmlDoc.selectSingleNode("\u002f\u002f\u0065\u0062\u0061\u003a\u0064\u0061taso\u0075\u0072c\u0065\u005b@\u0069d=\u0027"+this.id+"']/eb\u0061:d\u0061\u0074a\u002f\u0065b\u0061:\u0065[@xi='"+_21c[i].getAttribute("x\u0069")+"'\u005d")){ continue; } _21d.appendChild(_21c[i]); } } if(0!=_216.length){ ebaAssert(_216[0].getAttribute("\u0078i")==(_215.startXi),"\u0054h\u0065\u0020geth\u0061\u006ed\u006cer \u0072et\u0075\u0072ne\u0064\u0020\u0061 \u0064\u0069ff\u0065\u0072en\u0074\u0020\u0066\u0069\u0072\u0073t\u0020\u0072o\u0077\u0020t\u0068\u0061\u006e \u0072equ\u0065s\u0074ed\u002e"); var _21f=_215.lastRow; if(_216[_216.length-1].getAttribute("xi")!=(_215.pageSize+_215.startXi-1)){ _21f=parseInt(_216[_216.length-1].getAttribute("xi"))-1; _215.lastPage=true; } this.dataCache.insert(_215.firstRow,_21f); }else{ _215.pageSize=0; } if(null!=_215.ajaxCallback){ this.ajaxCallbackPool.release(_215.ajaxCallback); } if(null!=_215.callback&&null!=_215.context){ _215.callback.call(_215.context,_215); } _215.dispose(); _215=null; },join:function(_220,_221,_222,_223){ },merge:function(xd){ },_h_14:function(_225,_226){ var xi=_226; this.adjustXiXslProc.addParameter("\u0073\u0074ar\u0074ingIndex",parseInt(xi),""); this.adjustXiXslProc.addParameter("\u0061\u0064justmen\u0074",1,""); this.xmlDoc.loadXML(Eba.Xml.transformToString(this.xmlDoc,this.adjustXiXslProc,"\u0078\u006d\u006c")); if(this.log!=null){ this.log.loadXML(Eba.Xml.transformToString(this.log,this.adjustXiXslProc,"x\u006dl")); this.logData=this.log.selectSingleNode("\u002f\u002f"+ns+"\u0064\u0061tas\u006f\u0075r\u0063\u0065\u005b@\u0069d=\u0027\u005fde\u0066aul\u0074\u0027\u005d/"+ns+"d\u0061\u0074a"); } var data=this.xmlDoc.selectSingleNode("\u002f\u002f"+ns+"\u0064at\u0061\u0073\u006furc\u0065\u005b\u0040id\u003d'\u005fd\u0065fau\u006ct\u0027\u005d\u002f"+ns+"dat\u0061"); var _229=_225; var _22a=_229.cloneNode(true); _22a.setAttribute("\u0078\u0069",xi); data.appendChild(_22a); if(this.log!=null){ var _22a=_229.cloneNode(true); _22a.setAttribute("\u0078\u0061\u0063","i"); _22a.setAttribute("\u0078\u0069",xi); this.logData.appendChild(_22a); } },_h_80:function(xi,_22c,_22d){ var _22e=this.xmlDoc.selectSingleNode("//"+ns+"e[@x\u0069\u003d\u0027"+xi+"']"); ebaAssert((null!=_22e),"Could not find the specified node in the data source.\nTableDataSource: "+this.id+"\nRow: "+xi,"",EBA_THROW); var _22f=false; var _230=(_22e.getAttribute(_22c)!=_22d); if(!_230&&!_22f){ return; } _22e.setAttribute(_22c,_22d); var _231="\u0075"; var _232="u"; if(null==this.log){ this.log=Eba.Xml.createXmlDoc(); this.log.async=false; this.log.loadXML(g_LOG_DEFAULT); this.logData=this.log.selectSingleNode("\u002f/"+ns+"d\u0061\u0074\u0061\u0073ou\u0072\u0063e[@\u0069\u0064=\u0027\u005f\u0064e\u0066\u0061u\u006ct']/"+ns+"\u0064\u0061t\u0061"); } var _233=_22e.cloneNode(true); _233.setAttribute("\u0078\u0061c","\u0075"); if(null==this.logData.selectSingleNode("\u002f\u002f"+ns+"\u0065[@\u0078i\u003d\u0027"+xi+"\u0027]")){ this.logData.appendChild(_233); }else{ _233.setAttribute("\u0078\u0061c",this.logData.selectSingleNode("/\u002f"+ns+"\u0065\u005b\u0040\u0078\u0069\u003d'"+xi+"'\u005d").getAttribute("xac")); this.logData.replaceChild(_233,this.log.selectSingleNode("/\u002f"+ns+"\u0065[\u0040\u0078i='"+xi+"\u0027\u005d")); } if((true==this.AutoSave)){ this.save(); } },deleteRecord:function(_234){ var data=this.xmlDoc.selectSingleNode("\u002f\u002f"+ns+"\u0064\u0061\u0074a\u0073\u006f\u0075rc\u0065[\u0040\u0069d=\u0027\u005f\u0064\u0065fau\u006ct'\u005d/"+ns+"\u0064\u0061\u0074\u0061"); this.logData=this.log.selectSingleNode("//"+ns+"data\u0073\u006f\u0075\u0072ce[@\u0069\u0064=\u0027_d\u0065fau\u006c\u0074']/"+ns+"d\u0061\u0074\u0061"); var _236=data.selectSingleNode("*\u005b@\u0078\u0069 \u003d \u0027"+_234+"']"); if(_236==null){ throw "I\u006e\u0064\u0065x\u0020out\u0020of\u0020\u0062\u006fun\u0064\u0073 \u0069\u006e\u0020dele\u0074e\u002e"; } var xDel=this.logData.selectSingleNode("*\u005b@\u0078\u0069='"+_234+"\u0027]"); var sTag=""; if(xDel!=null){ sTag=xDel.getAttribute("\u0078a\u0063"); this.logData.removeChild(xDel); } if(sTag!="i"){ var _239=_236.cloneNode(true); _239.setAttribute("\u0078a\u0063","\u0064"); this.logData.appendChild(_239); } data.removeChild(_236); this.adjustXiXslProc.addParameter("\u0073tar\u0074i\u006eg\u0049ndex",parseInt(_234)+1,""); this.adjustXiXslProc.addParameter("a\u0064\u006aus\u0074m\u0065\u006e\u0074",-1,""); this.xmlDoc.loadXML(Eba.Xml.transformToString(this.xmlDoc,this.adjustXiXslProc,"xm\u006c")); if(this.log!=null){ this.log.loadXML(Eba.Xml.transformToString(this.log,this.adjustXiXslProc,"x\u006d\u006c")); this.logData=this.log.selectSingleNode("//"+ns+"d\u0061ta\u0073o\u0075\u0072ce[@\u0069d\u003d\u0027_de\u0066au\u006c\u0074\u0027]\u002f"+ns+"d\u0061t\u0061"); } },save:function(_23a,_23b){ if(!eval(_23b||"\u0074\u0072ue")){ return; } try{ if(this.onGenerateKey){ var _23c=this.log.selectNodes("//"+ns+"e\u005b@\u0078a\u0063 \u003d\u0020'i']"); var _23d=this.xmlDoc.selectSingleNode("/\u002f"+ns+"\u0064a\u0074as\u006f\u0075r\u0063e\u0073tructu\u0072e").getAttribute("K\u0065ys").split("|"); for(var i=0;i<_23c.length;i++){ var xml=null; for(var j=0;j<_23d.length;j++){ var _241=this.fieldMap[_23d[j]].substring(1); var _242=_23c[i].getAttribute(_241); if(!_242||_242==""){ if(!xml){ xml=eval(this.onGenerateKey); } if(typeof (xml)=="s\u0074r\u0069\u006e\u0067"){ _23c[i].setAttribute(_241,xml); this.xmlDoc.selectSingleNode("\u002f\u002f"+ns+"\u0065[@\u0078\u0069 = '"+_23c[i].getAttribute("\u0078\u0069")+"'\u005d").setAttribute(_241,xml); }else{ try{ var _243=(j>25?String.fromCharCode(Math.floor(j/26)+97):"")+(String.fromCharCode(j%26+97)); _23c[i].setAttribute(_241,xml.selectSingleNode("//"+ns+"e").getAttribute(_243)); this.xmlDoc.selectSingleNode("\u002f\u002f"+ns+"\u0065[\u0040\u0078\u0069 =\u0020'"+_23c[i].getAttribute("\u0078i")+"']").setAttribute(_241,xml.selectSingleNode("\u002f/"+ns+"\u0065").getAttribute(_243)); } catch(e){ ebaAssert(false,"K\u0065\u0079 \u0067\u0065n\u0065r\u0061ti\u006fn\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u002e","",EBA_THROW); } } } } } } if(this.version==2.8){ var _244=this.xmlDoc.selectSingleNode("//"+ns+"\u0064ata\u0073\u006fu\u0072ces\u0074\u0072\u0075\u0063\u0074\u0075\u0072e").getAttribute("\u0046\u0069e\u006c\u0064\u004e\u0061\u006de\u0073").split("\u007c"); var _23c=this.log.selectNodes("\u002f\u002f"+ns+"e\u005b@\u0078\u0061\u0063\u0020=\u0020'i'\u005d"); for(var i=0;i<_23c.length;i++){ for(var j=0;j<_244.length;j++){ var _245=_23c[i].getAttribute(this.fieldMap[_244[j]].substring(1)); if(!_245){ _23c[i].setAttribute(this.fieldMap[_244[j]].substring(1),""); } } } this.updategramTranslatorXslProc.addParameter("\u0078\u006bF\u0069eld",this.fieldMap["\u005fxk"].substring(1),""); this.log=Eba.Xml.transformToXml(this.log,this.updategramTranslatorXslProc); } var _246=this.postHandler; (_246.indexOf("\u003f")==-1)?_246+="?":_246+="&"; _246+="\u0054\u0061\u0062l\u0065\u0049\u0064\u003d"+this.id; _246+="&u\u0069d\u003d"+(new Date().getTime()); var _247=this.ajaxCallbackPool._h_59(); ebaAssert(Boolean(_247),"Th\u0065 \u0064\u0061taso\u0075\u0072\u0063e\u0020\u0069s\u0020serv\u0069\u006eg \u0074oo\u0020man\u0079\u0020\u0063o\u006en\u0065\u0063ti\u006f\u006es. P\u006c\u0065a\u0073e\u0020tr\u0079\u0020\u0061\u0067\u0061\u0069\u006e lat\u0065r.\u0020\u0023 cu\u0072rent \u0063o\u006e\u006eec\u0074i\u006fn\u0073: "+this.ajaxCallbackPool.inUse.length); _247.handler=_246; _247.context=this; _247.onPostComplete=this.saveComplete; _247.params=new Eba.SaveCompleteEventArgs(_23a); if(this.log.documentElement.nodeName=="roo\u0074"){ this.log.loadXML(this.log.xml.replace(/xmlns:eba=\"http:\/\/www.ebusinessapplications.ca\/ebagrid#\"/g,"")); var _244=this.xmlDoc.selectSingleNode("/\u002fe\u0062\u0061:da\u0074asour\u0063\u0065\u0073t\u0072\u0075c\u0074\u0075re").getAttribute("\u0046i\u0065\u006cdNam\u0065\u0073").split("|"); _244.splice(_244.length-1,1); _244=_244.join("|"); this.log.documentElement.setAttribute("\u0066\u0069\u0065ld\u0073",_244); this.log.documentElement.setAttribute("k\u0065\u0079\u0073",_244); } _247.post(this.log,this); this.log=Eba.Xml.createXmlDoc(); this.log.async=false; this.log.loadXML(g_LOG_DEFAULT); this.logData=this.log.selectSingleNode("\u002f\u002f"+ns+"\u0064\u0061ta\u0073\u006fur\u0063\u0065\u005b@\u0069d=\u0027\u005f\u0064ef\u0061u\u006c\u0074\u0027\u005d\u002f"+ns+"da\u0074a"); } catch(err){ throw err; } },saveComplete:function(xd,_249){ try{ if(null!=_249.result){ this._h_39(_249.result); var _24a=this.xmlDoc.selectSingleNode("\u002f\u0072\u006fo\u0074").getAttribute("e-m"); ebaAssert((null==_24a),"D\u0061\u0074\u0061\u0020\u0053a\u0076\u0065 Er\u0072o\u0072:"+_24a,EBA_EM_ATTRIBUTE_ERROR,EBA_ERROR); } _249.callback(); } catch(err){ ebaErrorReport(err,"",EBA_ERROR); } },_h_39:function(_24b){ var _24c=Eba.Xml.createXmlDoc(); _24c.loadXML(_24b.currentUpdategram); var _24d=_24c.selectNodes("\u002f/d\u0061ta\u005b@i\u0064\u003d\u0027\u005f\u0064e\u0066\u0061u\u006c\u0074'\u005d/e\u005b@x\u0061c=\u0027\u0064'\u005d").length; var _24e=this.xmlDoc.selectNodes("\u002f/data[@\u0069d\u003d\u0027_d\u0065\u0066au\u006ct\u0027]/\u0065").length; while(0!=_24d--){ var _24f=_24c.selectSingleNode("//data\u005b@\u0069\u0064=\u0027\u005fdefa\u0075l\u0074'\u005d/e\u005b\u0040\u0078a\u0063\u003d'd\u0027\u0020and \u0040\u0078\u0069='"+(_24e-_24d)+"\u0027\u005d"); alert(_24f?_24f.xml:"na\u0064\u0061"); ebaAssert((null!=_24f),"\u0054\u0068e \u0075p\u0064\u0061\u0074eG\u0072a\u006d \u0066r\u006fm\u0020\u0074\u0068e\u0020\u0073e\u0072\u0076\u0065\u0072 \u0063\u0061n\u0020only i\u006e\u0063l\u0075d\u0065\u0020de\u006c\u0065te instr\u0075ction f\u006fr t\u0068e \u004e \u0062ot\u0074\u006fm\u006d\u006f\u0073\u0074\u0020row\u0073.\u0020De\u006c\u0065\u0074e\u0020re\u0071\u0075est\u0020\u0066or r\u006f\u0077 n\u0075m\u0062er ["+(_24e-_24d)+"]\u0020\u006eot\u0020f\u006fund.","",EBA_THROW); } Eba.Xml.transformToXml(this.xmlDoc,this.mergeAttributesXslProc); },_h_35:function(){ var _250=this.xmlDoc.selectSingleNode("\u002f/"+ns+"da\u0074\u0061\u0073\u006fu\u0072\u0063\u0065"); var cf=0; var ck=0; this.fieldMap=new Array(); var _253=this.datastructure.getAttribute("\u0046\u0069e\u006cd\u004eam\u0065\u0073"); var _254=_253.split("\u007c"); var cF=_254.length; for(var i=0;i<cF;i++){ var _257=_254[i]; ck1=ck%26; ck2=Math.floor(ck/26); this.fieldMap[_257]="@"+(ck2>0?String.fromCharCode(96+ck2):"")+String.fromCharCode(97+ck1); ck++; } },_h_56:function(_258){ var row=this.xmlDoc.selectNodes("/\u002f\u0067rid\u006d\u0065t\u0061\u002f\u0072"); var _25a=this.getRows(); var _25b=this.getColumns(); var r=1; for(var i=0;i<row.length;i++){ var xi=Number(row[i].getAttribute("x\u0069")); for(var f=r;f<xi;f++){ var _260=this.data.createElement("r"); _260.setAttribute("xi",f); meta.insertBefore(_260,row[i]); for(var c=0;c<_25b;c++){ var _262=this.data.createElement("\u0063"); _262.setAttribute("x\u0069",c); _260.appendChild(_262); } } r=xi+1; } },getRows:function(){ return this.xmlDoc.selectNodes("/\u002f"+ns+"\u0064a\u0074\u0061\u0073\u006fur\u0063e\u005b@id\u003d'\u005fde\u0066\u0061\u0075\u006c\u0074'\u005d\u002f"+ns+"d\u0061ta\u002f"+ns+"e").length; },getColumns:function(){ return this.fieldMap.length; },setGetHandlerParameter:function(key,_264){ var _265=this.getHandler.split("\u003f"); var _266=_265.length==2?_265[1].split("\u0026"):new Array(); var _267={}; for(var i=0;i<_266.length;i++){ var pair=_266[i].split("="); _267[unescape(pair[0])]=unescape(pair[1]); } _267[key]=_264; this.getHandler=_265[0]+"?"; for(key in _267){ if(_267[key]){ this.getHandler+=escape(key)+"\u003d"+escape(_267[key])+"&"; } } this.getHandler=this.getHandler.substring(0,this.getHandler.length-1); }}; Eba.TableDataSource.prototype.getChangeLogSize=function(){ if(null==this.log){ return 0; } return this.log.selectNodes("\u002f\u002f"+ns+"e").length; }; Eba.TableDataSource.prototype.getChangeLogXmlDoc=function(){ return this.log; }; Eba.TableDataSource.prototype.getDataXmlDoc=function(){ return this.xmlDoc; }; Eba.TableDataSource.prototype.dispose=function(){ this.log=null; this.logData=null; this.xmlDoc=null; this.datastructure=null; this.dataCache._h_20(); this.dataCache=null; this.requestCache._h_20(); this.requestCache=null; this.dataTranslatorXslProc=null; this.updategramTranslatorXslProc=null; this.mergeAttributesXslProc=null; this.renumberXslProc=null; this.adjustXiXslProc=null; this.onGenerateKey=null; this.ajaxCallbackPool.dispose(); this.ajaxCallbackPool.context=null; this.ajaxCallbackPool=null; }; Eba.TableDataStructure=Class.create(); Eba.TableDataStructure.prototype={initialize:function(xd){ }}; Eba.GetCompleteEventArgs=Class.create(); Eba.GetCompleteEventArgs.prototype={initialize:function(_26b,_26c,_26d,_26e,_26f,_270,obj,_272){ this.firstRow=_26b; this.lastRow=_26c; this.callback=_272; this.dataSource=_270; this.context=obj; this.ajaxCallback=_26f; this.startXi=_26d; this.pageSize=_26e; this.lastPage=false; }}; Eba.GetCompleteEventArgs.prototype.dispose=function(){ this.callback=null; this.context=null; this.dataSource=null; this.ajaxCallback.handler=null; this.ajaxCallback.context=null; this.ajaxCallback.onGetComplete=null; this.ajaxCallback.params=null; this.ajaxCallback==null; }; Eba.SaveCompleteEventArgs=Class.create(); Eba.SaveCompleteEventArgs.prototype={initialize:function(_273){ this.callback=_273; }}; Eba.GetHandlerResolver=Class.create(); Eba.GetHandlerResolver.prototype={initialize:function(){ },_h_61:function(sort,_275,_276,_277){ }}; function rgb(r,g,b){ return "\u0023"+((r*65536)+(g*256)+b).toString(16); } function ebaHover(_27b,_27c,_27d){ if(!_27d){ return; } var id=_27b.getAttribute("i\u0064"); var _27f=id.replace(/__/,"||"); var _280=_27f.split("\u005f"); var row=_280[3]; var uid=_280[5].replace(/\|\|/,"\u005f_"); var _283=document.getElementById("\u0065\u0062\u0061_\u0067\u0072\u0069d_ce\u006c\u006c_"+row+"_1"+"_"+uid); var _284=_283.parentNode.parentNode; var _285=_284.childNodes[_284.childNodes.length-1].firstChild; var id=_285.getAttribute("id"); var _280=id.split("\u005f"); var _286=document.getElementById("\u0065\u0062\u0061\u005f\u0067r\u0069d\u005fc\u0065\u006c\u006c\u005f"+row+"_"+(Number(_280[4])+1)+"_"+uid); var _287=null; if(_286!=null){ _287=_286.parentNode.parentNode; } if(_27c){ _284.style.backgroundColor=EBARowHoverColor; if(_287){ _287.style.backgroundColor=EBARowHoverColor; } }else{ _284.style.backgroundColor=""; if(_287){ _287.style.backgroundColor=""; } } if(_27c){ _27b.style.backgroundColor=EBACellHoverColor; }else{ _27b.style.backgroundColor=""; } } function getDomNode(Node,Path){ if(IE){ } var _28a=Node; var _28b=Path.split("\u002f"); for(var _28c in _28b){ if(_28a.childNodes[Number(_28b[_28c])]!=null){ _28a=_28a.childNodes[Number(_28b[_28c])]; }else{ alert("P\u0061t\u0068 e\u0078\u0070\u0072\u0065ss\u0069\u006f\u006e fail\u0065\u0064."+Path); } var s=""; } return _28a; } function handleKey(o,e){ var evt=(IE)?event:e; var k=evt.keyCode; if(k==86&&evt.ctrlKey){ } if(!evt.ctrlKey){ switch(k){ case 40: o.navigator.move(0,1); break; case 38: o.navigator.move(0,-1); break; case 37: o.navigator.move(-1,0); break; case 39: o.navigator.move(1,0); break; default: o.navigator.edit(); evt.returnValue=false; } } noBubble(); } function scrollv(){ var ms=document.getElementById("myS\u0068\u0065e\u0074"); var uid=ms.object.uid; var vs=document.getElementById("\u0076scr\u006fl\u006c"+uid); var _295=(vs.scrollTop)/(vs.scrollHeight-vs.clientHeight); ms.object.Scroller._h_68(_295); return; } function scrollh(){ var ms=document.getElementById("\u006dy\u0053\u0068ee\u0074"); var uid=ms.object.uid; var hs=document.getElementById("h\u0073cr\u006f\u006cl"+uid); var _299=(hs.scrollLeft)/(hs.scrollWidth-hs.clientWidth); ms.object.Scroller._h_67(_299); return; } function _h_70(_29a){ if(_29a.getBoundingClientRect){ sd=_29a.getBoundingClientRect(); st=sd.top; sb=sd.bottom; sl=sd.left; sr=sd.right; sh=Math.abs(sb-st); sw=Math.abs(sr-sl); } if(document.getBoxObjectFor){ sd=document.getBoxObjectFor(_29a); st=sd.y; sl=sd.x; sw=sd.width; sh=sd.height; } src3.style.top=st-2; src3.style.left=sl-2; src3.style.height=sh; src3.style.width=sw; _29a.style.zIndex=100000; } try{ Node.prototype.swapNode=function(node){ var _29c=this.nextSibling; var _29d=this.parentNode; node.parentNode.replaceChild(this,node); _29d.insertBefore(node,_29c); }; } catch(e){ } function noBubble(e,v){ e.returnValue=false; e.cancelBubble=true; if(v!=null){ e.keyCode=v; } } function _GLScroll(){ var This=_GLGrid(event.srcElement); var EL=This.element; if(This.active==""&&event.button==2){ if(!This.scrolling){ This.X0=event.x; This.Y0=event.y; This.scrolling=true; } var _2a2=document.getElementById("\u0062\u006f\u0064\u0079"+This.element.uniqueID); if(false){ dx=(event.x-This.X0)*0.1; dy=(event.y-This.Y0)*0.1; _2a2.scrollLeft+=dx; _2a2.scrollTop+=dy; }else{ var rEL=EL.getClientRects(); var _2a4=_2a2.firstChild.getClientRects(); var t=rEL[0].top+20; var l=rEL[0].left; var h1=_2a2.offsetHeight-14; var h2=_2a2.scrollHeight+20; var w1=rEL[0].right-l; var w2=_2a4[0].right-_2a4[0].left; dx=(event.x-l)*((w2-w1)/w1); dy=(event.y-t)*((h2-h1)/h1); _2a2.scrollLeft=dx; _2a2.scrollTop=dy; } noBubble(); } } var Align_SAMEHEIGHT=268435456; var Align_SAMEWIDTH=16777216; var Align_ALIGNTOP=1048576; var Align_ALIGNBOTTOM=65536; var Align_ALIGNLEFT=4096; var Align_ALIGNRIGHT=256; var Align_ALIGNMIDDLEVERT=16; var Align_ALIGNMIDDLEHORIZ=1; function Align(_2ab,_2ac,_2ad,oh,ow,oy,ox,show){ oh=oh||0; ow=ow||0; oy=oy||0; ox=ox||0; var a=_2ad; var td,sd,tt,tb,tl,tr,th,tw,st,sb,sl,sr,sh,sw; if(_2ac.getBoundingClientRect){ td=_2ac.getBoundingClientRect(); sd=_2ab.getBoundingClientRect(); tt=td.top; tb=td.bottom; tl=td.left; tr=td.right; th=Math.abs(tb-tt); tw=Math.abs(tr-tl); st=sd.top; sb=sd.bottom; sl=sd.left; sr=sd.right; sh=Math.abs(sb-st); sw=Math.abs(sr-sl); } if(document.getBoxObjectFor){ td=document.getBoxObjectFor(_2ac); sd=document.getBoxObjectFor(_2ab); tt=td.y; tl=td.x; tw=td.width; th=td.height; st=sd.y; sl=sd.x; sw=sd.width; sh=sd.height; } if(a&268435456){ _2ab.style.height=th+oh; } if(a&16777216){ _2ab.style.width=tw+ow; } if(a&1048576){ _2ab.style.top=Eba.Dom.getTop(_2ab)+tt-st+oy; } if(a&65536){ _2ab.style.top=Eba.Dom.getTop(_2ab)+tt-st+th-sh+oy; } if(a&4096){ _2ab.style.left=Eba.Dom.getLeft(_2ab)-sl+tl+ox; } if(a&256){ _2ab.style.left=Eba.Dom.getLeft(_2ab)-sl+tl+tw-sw+ox; } if(a&16){ _2ab.style.top=Eba.Dom.getTop(_2ab)+tt-st+oy+Math.floor((th-sh)/2); } if(a&1){ _2ab.style.left=Eba.Dom.getLeft(_2ab)-sl+tl+ox+Math.floor((tw-sw)/2); } if(show){ src.style.top=st-2; src.style.left=sl-2; src.style.height=sh; src.style.width=sw; tgt.style.top=tt-2; tgt.style.left=tl-2; tgt.style.height=th; tgt.style.width=tw; if(document.getBoundingClientRect){ sd=_2ab.getBoundingClientRect(); st=sd.top; sb=sd.bottom; sl=sd.left; sr=sd.right; sh=Math.abs(sb-st); sw=Math.abs(sr-sl); } if(document.getBoxObjectFor){ sd=document.getBoxObjectFor(_2ab); st=sd.screenY; sl=sd.screenX; sw=sd.width; sh=sd.height; } src2.style.top=st-2; src2.style.left=sl-2; src2.style.height=sh; src2.style.width=sw; } } function AlignOuterBox(_2b5,_2b6,_2b7,oh,ow,oy,ox,show){ oh=oh||0; ow=ow||0; oy=oy||0; ox=ox||0; if(_2b6.getBoundingClientRect){ td=_2b6.getBoundingClientRect(); sd=_2b5.getBoundingClientRect(); tt=td.top; tb=td.bottom; tl=td.left; tr=td.right; th=Math.abs(tb-tt); tw=Math.abs(tr-tl); st=sd.top; sb=sd.bottom; sl=sd.left; sr=sd.right; sh=Math.abs(sb-st); sw=Math.abs(sr-sl); } if(document.getBoxObjectFor){ td=document.getBoxObjectFor(_2b6); sd=document.getBoxObjectFor(_2b5); var _2bd=parseInt(document.defaultView.getComputedStyle(_2b6,"").getPropertyValue("\u0062or\u0064\u0065\u0072\u002d\u006ce\u0066t-\u0077i\u0064t\u0068")); var _2be=parseInt(document.defaultView.getComputedStyle(_2b6,"").getPropertyValue("\u0062\u006f\u0072d\u0065r-t\u006fp\u002dw\u0069\u0064th")); var _2bf=parseInt(document.defaultView.getComputedStyle(_2b5,"").getPropertyValue("b\u006fr\u0064e\u0072-\u0074\u006f\u0070\u002d\u0077\u0069\u0064t\u0068")); var _2c0=parseInt(document.defaultView.getComputedStyle(_2b5,"").getPropertyValue("\u0062\u006frde\u0072-bo\u0074t\u006f\u006d\u002dw\u0069\u0064t\u0068")); var _2c1=parseInt(document.defaultView.getComputedStyle(_2b5,"").getPropertyValue("bor\u0064er-\u006c\u0065\u0066\u0074\u002d\u0077i\u0064\u0074h")); var _2c2=parseInt(document.defaultView.getComputedStyle(_2b5,"").getPropertyValue("b\u006f\u0072d\u0065r-ri\u0067\u0068t\u002dw\u0069d\u0074\u0068")); oy=oy+_2bf-_2be; ox=ox+_2c1-_2bd; } Align(_2b5,_2b6,_2b7,oh,ow,oy,ox,show); } function findX(elem){ var x=0; while(elem.offsetParent){ x+=elem.offsetLeft; elem=elem.offsetParent; } return x; } function findY(elem){ var y=0; while(elem.offsetParent){ y+=elem.offsetTop; elem=elem.offsetParent; } return y; } function showRect(obj){ sd=obj.getBoundingClientRect(); st=sd.top; sb=sd.bottom; sl=sd.left; sr=sd.right; sh=Math.abs(sb-st); sw=Math.abs(sr-sl); src2.style.top=st-2; src2.style.left=sl-2; src2.style.height=sh; src2.style.width=sw; } function xbHighlight(o,x){ if(o.createTextRange){ o.focus(); var r=document.selection.createRange().duplicate(); r.move("c\u0068ara\u0063\u0074er",0-o.value.length); r.move("c\u0068ar\u0061\u0063te\u0072",x); r.moveEnd("\u0074\u0065\u0078\u0074e\u0064\u0069\u0074",1); r.select(); }else{ if(o.setSelectionRange){ o.setSelectionRange(x,o.value.length); } } } function xbPutCur(o,x){ if(o.createTextRange){ o.focus(); var r=document.selection.createRange().duplicate(); r.move("\u0063\u0068\u0061\u0072ac\u0074e\u0072",0-o.value.length); r.move("cha\u0072ac\u0074er",x); r.select(); }else{ if(o.setSelectionRange){ o.setSelectionRange(x,x); } } } function _EbaXmlEncode(str){ str+=""; str=str.replace(/&/g,"&a\u006dp;"); str=str.replace(/'/g,"\u0026ap\u006fs\u003b"); str=str.replace(/\"/g,"&\u0071u\u006f\u0074;"); str=str.replace(/</g,"\u0026lt;"); str=str.replace(/>/g,"&g\u0074;"); str=str.replace(/\n/g,"\u0026\u0023\u0078\u0061\u003b"); return str; } function _EbaHtmlEncode(str){ str+=""; str=str.replace(/&/g,"&am\u0070\u003b"); str=str.replace(/\"/g,"\u0026\u0071\u0075\u006f\u0074\u003b"); str=str.replace(/</g,"&lt;"); str=str.replace(/>/g,"&\u0067\u0074;"); str=str.replace(/\n/g,"\u003cb\u0072>"); return str; } function _EbaConstructValidXpathQuery(_2d0,_2d1){ var _2d2=_2d0.match(/(\"|\')/g); if(_2d2!=null){ var _2d3="\u0063\u006fnc\u0061\u0074\u0028"; var _2d4=""; var _2d5; for(var i=0;i<_2d0.length;i++){ if(_2d0.substr(i,1)=="\""){ _2d5="\u0026a\u0070\u006f\u0073;"; }else{ _2d5="\u0026q\u0075ot\u003b"; } _2d3+=_2d4+_2d5+_EbaXmlEncode(_2d0.substr(i,1))+_2d5; _2d4="\u002c"; } _2d3+=_2d4+"&\u0061\u0070os\u003b&\u0061\u0070\u006f\u0073;"; _2d3+=")"; _2d0=_2d3; }else{ var quot=(_2d1?"\"":""); _2d0=quot+_EbaXmlEncode(_2d0)+quot; } return _2d0; } function _EbaTypeToBoolean(_2d8,_2d9){ if(typeof (_2d9)!="un\u0064\u0065\u0066i\u006e\u0065d"){ if((typeof (_2d8)=="u\u006e\u0064\u0065fi\u006eed")||(_2d8=="")||(_2d8==null)){ _2d8=_2d9; } } _2d8=_2d8.toString()||""; _2d8=_2d8.toUpperCase(); if((_2d8=="Y")||(_2d8=="\u0031")||(_2d8=="TRUE")){ return true; }else{ return false; } } function _EbaBooleanToString(bool){ if(typeof (bool)=="b\u006f\u006f\u006c\u0065an"){ if(bool){ return "\u0031"; }else{ return "0"; } }else{ return bool; } } Eba.getStyle=function(oElm,_2dc){ var _2dd=""; if(document.defaultView&&document.defaultView.getComputedStyle){ _2dd=document.defaultView.getComputedStyle(oElm,"").getPropertyValue(_2dc); }else{ if(oElm.currentStyle){ _2dc=_2dc.replace(/\-(\w)/g,function(_2de,p1){ return p1.toUpperCase(); }); _2dd=oElm.currentStyle[_2dc]; } } return _2dd; }; Eba.close=function(_2e0,func){ return function(){ func.apply(_2e0,arguments); }; }; Eba.closeLater=function(_2e2,func,_2e4){ return function(){ func.apply(_2e2,_2e4); }; }; if(document.implementation.createDocument){ HTMLElement.prototype.getBoundingClientRect=function(_2e5,_2e6){ var td=document.getBoxObjectFor(this); return {top:td.y,left:td.x,bottom:(td.y+td.height),right:(td.x+td.width)}; }; HTMLElement.prototype.getClientRects=function(_2e8,_2e9){ _2e8=_2e8||0; _2e9=_2e9||0; var td=document.getBoxObjectFor(this); return new Array({top:(td.y-_2e8),left:(td.x-_2e9),bottom:(td.y+td.height-_2e8),right:(td.x+td.width-_2e9)}); }; HTMLElement.prototype.insertAdjacentElement=function(pos,node){ switch(pos){ case "be\u0066or\u0065\u0042eg\u0069n": this.parentNode.insertBefore(node,this); break; case "\u0061\u0066t\u0065\u0072\u0042e\u0067\u0069\u006e": this.insertBefore(node,this.firstChild); break; case "\u0062e\u0066or\u0065\u0045\u006ed": this.appendChild(node); break; case "a\u0066te\u0072End": if(this.nextSibling){ this.parentNode.insertBefore(node,this.nextSibling); }else{ this.parentNode.appendChild(node); } break; } }; HTMLElement.prototype.insertAdjacentHTML=function(pos,s){ var r=this.ownerDocument.createRange(); r.setStartBefore(this); var node=r.createContextualFragment(s); this.insertAdjacentElement(pos,node); }; HTMLElement.prototype.insertAdjacentText=function(pos,s){ var node=document.createTextNode(s); this.insertAdjacentElement(pos,node); }; } EBA_EM_ATTRIBUTE_ERROR=1; EBA_XHR_RESPONSE_ERROR=2; EBA_DEBUG="de\u0062u\u0067"; EBA_WARN="w\u0061\u0072n"; EBA_ERROR="\u0065rr\u006f\u0072"; EBA_THROW="\u0074h\u0072\u006fw"; EBA_DEBUG_MODE=false; EBA_ON_ERROR=""; EBA_LAST_ERROR=""; _ebaDebug=false; function _ebaAssert(_2f4,_2f5){ ebaAssert(_2f4,_2f5,"",DEBUG); } function ebaSetOnErrorEvent(_2f6){ EBA_ON_ERROR=_2f6; } function ebaReportError(_2f7,_2f8,_2f9){ ebaErrorReport("\u0064ude\u0020\u0073top\u0020\u0063all\u0069n\u0067 \u0074hi\u0073\u0020me\u0074h\u006fd\u0020\u0069t\u0020is\u0020n\u006f\u0077 \u0063a\u006cle\u0064 \u0065\u0062aE\u0072r\u006f\u0072\u0052\u0065p\u006f\u0072\u0074",""); ebaErrorReport(_2f7,_2f8,_2f9); } function ebaErrorReport(_2fa,_2fb,_2fc){ _2fc=(_2fc)?_2fc:EBA_DEBUG; if(EBA_DEBUG==_2fc&&!EBA_DEBUG_MODE){ return; } var _2fd=_2fa+"\n error code    ["+_2fb+"]\nerror Severity["+_2fc+"\u005d"; LastError=_2fd; if(eval(EBA_ON_ERROR||"\u0074\u0072\u0075e")){ switch(_2fb){ case EBA_EM_ATTRIBUTE_ERROR: confirm(_2fa); break; case EBA_XHR_RESPONSE_ERROR: confirm(_2fa); break; default: window.status=_2fa; break; } } if(EBA_THROW==_2fc){ throw (_2fd); } } function ebaAssert(_2fe,_2ff,_300,_301){ if(!_300){ _300=1; } if(!_301){ _301=EBA_DEBUG; } if(EBA_DEBUG==_301&&!EBA_DEBUG_MODE){ return; } if(false==_2fe){ try{ var _302=document.getElementById("EBAFee\u0064\u0062\u0061\u0063k\u0043\u006fn\u0074\u0061ine\u0072\u0044\u0069v").object; var _303=(false==_2fe); _302.appendDebugInfo("A\u0073\u0073\u0065r\u0074ion\u0020("+_303+")\u003a"+_2ff+" \u002d\u0020"+_300+" \u002d "+_301); } catch(e){ } ebaErrorReport("A\u0073s\u0065\u0072\u0074i\u006f\u006e \u0046ai\u006c\u0065d\u003a"+_2ff,_300,_301); } } Eba.addDebugTools=function(){ var htm="\u003c\u0069n\u0070\u0075\u0074 \u0074y\u0070\u0065=\u0062\u0075t\u0074o\u006e v\u0061\u006cu\u0065\u003d\u0027\u0053ho\u0077\u0020H\u0054M\u004c\u0027 \u006fnc\u006c\u0069ck\u003d'd\u0075mp\u0048\u0054\u004d\u004cC\u006f\u006ete\u006e\u0074(\u0029\u0027\u002f><\u0062r><t\u0065\u0078ta\u0072\u0065a\u0020c\u006f\u006cs=1\u00325\u0020rows=\u00325 \u0069\u0064='l\u006fg\u0027>\u003c/t\u0065\u0078\u0074\u0061\u0072ea>"; var div=document.createElement("di\u0076"); div.innerHTML=htm; document.body.appendChild(div); }; var EBAGridNavigator=Class.create(); EBAGridNavigator.prototype={initialize:function(_306){ }}; var EBAViewNavigator=Class.create(); EBAViewNavigator.prototype={initialize:function(_307){ this.DomNode=_307; this.currentRow=0; this.currentColumn=0; this.currentBlock=null; this.activeView=null; this.top=123; this.left=0; this.bottom=0; this.right=0; this.blockNavigator=new EBABlockNavigator(); this.blockNavigator.onEdit="\u0074hi\u0073.vi\u0065wN\u0061\u0076ig\u0061\u0074\u006f\u0072.e\u0064i\u0074\u0028e\u0076\u0074\u0029;"; this.blockNavigator.onMove="this.\u0076\u0069ew\u004e\u0061\u0076i\u0067\u0061\u0074\u006fr.\u006do\u0076\u0065\u0028)\u003bth\u0069s\u002e\u0076ie\u0077\u004ea\u0076iga\u0074\u006fr\u002ev\u0069e\u0077.o\u0077ne\u0072\u002eact\u0069\u0076e\u0043\u0065l\u006c=\u0074\u0068\u0069\u0073\u002eac\u0074\u0069ve\u0043e\u006cl\u003b"; this.blockNavigator.onMovePastLeftEdge="\u0074\u0068is.v\u0069e\u0077N\u0061vi\u0067\u0061to\u0072.\u0073\u0065tPo\u0073\u0069tio\u006e(t\u0068i\u0073.cu\u0072r\u0065ntRo\u0077+\u0076,th\u0069s\u002e\u0063\u0075\u0072r\u0065n\u0074\u0043o\u006cum\u006e+h\u0029"; this.blockNavigator.onMovePastRightEdge="\u0074h\u0069\u0073.view\u004e\u0061\u0076\u0069ga\u0074o\u0072.\u0073\u0065t\u0050o\u0073i\u0074i\u006fn\u0028th\u0069s.\u0063\u0075rr\u0065\u006etR\u006fw\u002b\u0076,this\u002e\u0063urre\u006et\u0043\u006f\u006c\u0075mn\u002bh)"; this.blockNavigator.onMovePastTopEdge="\u0074\u0068is\u002ev\u0069\u0065w\u004ea\u0076iga\u0074\u006fr\u002e\u0073e\u0074Pos\u0069\u0074ion\u0028\u0074his\u002ecu\u0072\u0072e\u006e\u0074Row+v,th\u0069\u0073.curre\u006et\u0043\u006flum\u006e+h)"; this.blockNavigator.onMovePastBottomEdge="t\u0068is\u002e\u0076iew\u004e\u0061\u0076\u0069\u0067ator\u002ese\u0074P\u006f\u0073i\u0074\u0069on(thi\u0073\u002ecu\u0072re\u006e\u0074Ro\u0077+v\u002ct\u0068is\u002e\u0063u\u0072r\u0065n\u0074Co\u006c\u0075mn+\u0068)"; this.view=null; this.disposal=[]; },_h_65:function(_308,rows,_30a,_30b){ this.startRow=_308; this.rows=_308+rows; this.startColumn=_30a; this.columns=_30a+_30b; },move:function(h,v){ if(this.currentColumn==this.startColumn&&h==-1){ eval(this.onMovePastLeftEdge); return; } if(this.currentColumn==this.columns-1&&h==1){ eval(this.onMovePastRightEdge); return; } if(this.currentRow==this.startRow&&v==-1){ eval(this.onMovePastTopEdge); return; } if(this.currentRow==this.rows-1&&v==1){ eval(this.onMovePastBottomEdge); return; } eval(this.onMove); },setPosition:function(row,_30f){ if(_30f>=this.view.owner.getColumnCount()||_30f<0){ return; } this.currentBlock=this._h_34(row); if(row>=this.startRow&&row<this.startRow+this.rows&&_30f>=this.startColumn&&_30f<this.startColumn+this.columns){ if(this.currentBlock!=null){ var _310=this; this.blockNavigator.DomNode=this.currentBlock; this.blockNavigator.viewNavigator=this; this.disposal.push(function(){ _310.blockNavigator.viewNavigator=null; }); this.currentBlock.navigator=this.blockNavigator; this.disposal.push(function(){ _310.currentBlock.navigator=null; }); this.blockNavigator.rows=this.currentBlock.bottom-this.currentBlock.top+1; this.blockNavigator.setPosition(row,_30f); } }else{ this.currentRow=row; this.currentColumn=_30f; if(_30f<this.startColumn){ eval(this.onMovePastLeftEdge); return; } if(_30f>this.columns-1){ eval(this.onMovePastRightEdge); return; } if(row<this.startRow){ eval(this.onMovePastTopEdge); return; } if(row>this.rows-1){ eval(this.onMovePastBottomEdge); return; } } },_h_34:function(row){ var _312=this.DomNode.childNodes; for(var _313 in _312){ if(row>=_312[_313].top&&row<=_312[_313].bottom){ return _312[_313]; } } return null; },activate:function(_314,e){ var _316=this; _314.navigator=this.blockNavigator; this.disposal.push(function(){ _314.navigator=null; }); this.blockNavigator.viewNavigator=this; this.disposal.push(function(){ _316.blockNavigator.viewNavigator=null; }); this.blockNavigator.activate(_314,e); this.blockNavigator.DomNode=_314; this.blockNavigator.onMovePastLeftEdge="\u0074\u0068\u0069\u0073.\u0076ie\u0077\u004e\u0061v\u0069\u0067\u0061\u0074o\u0072.\u0073etP\u006fsi\u0074\u0069\u006fn\u0028\u0074\u0068i\u0073.\u0063\u0075\u0072r\u0065\u006e\u0074R\u006f\u0077+\u0076,thi\u0073\u002e\u0063u\u0072\u0072ent\u0043\u006f\u006c\u0075\u006dn+\u0068\u0029"; this.blockNavigator.onMovePastRightEdge="\u0074his\u002eviewN\u0061v\u0069ga\u0074or\u002e\u0073etPos\u0069\u0074i\u006f\u006e(thi\u0073.\u0063ur\u0072e\u006etR\u006fw\u002bv,th\u0069\u0073.\u0063u\u0072re\u006e\u0074Co\u006cu\u006dn\u002bh)"; this.blockNavigator.onMovePastTopEdge="\u0074\u0068\u0069\u0073.view\u004eaviga\u0074\u006f\u0072.se\u0074P\u006fs\u0069\u0074io\u006e\u0028\u0074\u0068is.\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u0052\u006f\u0077\u002b\u0076,t\u0068\u0069\u0073\u002ecu\u0072\u0072\u0065ntCol\u0075mn+\u0068)"; this.blockNavigator.onMovePastBottomEdge="thi\u0073.vi\u0065wNav\u0069g\u0061tor.set\u0050\u006f\u0073it\u0069o\u006e(thi\u0073.cu\u0072rent\u0052\u006fw+v\u002cthi\u0073.\u0063\u0075rr\u0065nt\u0043olum\u006e\u002b\u0068\u0029"; },edit:function(e){ var evt=(IE)?event:e; this.view.activeCell=this.blockNavigator.activeCell; eval(this.onEdit); },handleKey:function(o,e){ this.blockNavigator.handleKey(o,e); },mouseMove:function(o,e){ this.blockNavigator.mouseMove(o.e); }}; EBAViewNavigator.prototype.dispose=function(){ this.DomNode=null; var _31d=this.disposal.length; for(var i=0;i<_31d;i++){ this.disposal[i].call(this); this.disposal[i]=null; } this.blockNavigator.dispose(); }; var EBABlockNavigator=Class.create(); EBABlockNavigator.prototype={initialize:function(_31f){ this.DomNode=_31f; this.rows=0; this.columns=0; this.currentRow=0; this.currentColumn=0; this.pathToRow="\u0030\u002f0/"; this.pathToColumn=""; this.pathToCell="\u002f0"; this.getCellObject=function(){ return null; }; },move:function(h,v){ if(this.viewNavigator!=null){ var hs=1; var vs=1; h=(h*hs); v=(v*vs); if(this.currentColumn==this.DomNode.left&&h<0){ eval(this.onMovePastLeftEdge); return; }else{ if(this.currentColumn==this.DomNode.right-1&&h>0){ eval(this.onMovePastRightEdge); return; }else{ if(this.currentRow==this.DomNode.top&&v<0){ eval(this.onMovePastTopEdge); return; }else{ if(this.currentRow==this.DomNode.bottom&&v>0){ eval(this.onMovePastBottomEdge); return; }else{ if(v==-1&&this.currentRow==0){ return; } this.setPosition(this.currentRow+v,this.currentColumn+h); } } } } eval(this.onMove); this._h_70(); } },setPosition:function(row,_325){ this.onBeforeMove?eval(this.onBeforeMove):""; this.currentRow=row; this.currentColumn=_325; this.activeCell=EBACell.getCellElement(this.viewNavigator.view.owner,(row),(_325)); this.viewNavigator.view.owner.activeCell=this.activeCell; ebaAssert(this.activeCell!=null,"s\u0065t\u0050o\u0073i\u0074io\u006e s\u0065t\u0020a\u0063\u0069t\u0076eC\u0065\u006cl\u0020\u0074o\u0020nu\u006cl\u002e"); this._h_70(); },edit:function(e){ var evt=(IE)?event:e; eval(this.onEdit); },handleKey:function(o,e){ var evt=(IE)?event:e; if(!IE){ window.event=evt; } var k=evt.keyCode; var _32c=this.activeCell; k=k+(evt.shiftKey?256:0)+(evt.ctrlKey?512:0); switch(k){ case 35: break; case 36: break; case 547: break; case 548: break; case 13: case 40: this.clearSelect(_32c); this.move(0,1); break; case 269: case 38: this.clearSelect(_32c); this.move(0,-1); break; case 265: case 37: this.clearSelect(_32c); this.move(-1,0); break; case 9: case 39: this.clearSelect(_32c); this.move(1,0); break; case 272: break; case 296: this.move(0,1); this._h_58(_32c); break; case 294: this.move(0,-1); this._h_58(_32c); break; case 293: this.move(-1,0); this._h_58(_32c); break; case 295: this.move(1,0); this._h_58(_32c); break; case 577: break; case 579: case 557: this.viewNavigator.view.owner.Selection.copy(); this.activeCell.focus(); return; break; case 600: case 302: break; case 598: case 301: this.viewNavigator.view.owner.Paste(); break; default: this.edit(e); } noBubble(evt); },_h_58:function(_32d){ if(this.viewNavigator!=null){ this.viewNavigator.view._h_58(this.activeCell,_32d); } },clearSelect:function(){ if(this.viewNavigator!=null){ } },activate:function(_32e,e){ var evt=(IE)?event:e; this.activeCell=this.viewNavigator.view.findActiveCell(evt.srcElement); this.currentRow=EBACell.getRowNumber(this.activeCell); this.currentColumn=EBACell.getColumnNumber(this.activeCell); this.rows=_32e.rows; this.columns=_32e.columns; this.DOMNode=_32e; this.viewNavigator.view.position(); this.viewNavigator.view.owner.Selection.collapse(this.activeCell); },mouseMove:function(o,e){ },_h_70:function(){ this.viewNavigator.view.owner.Selection.collapse(this.activeCell); }}; EBABlockNavigator.prototype.dispose=function(){ this.DomNode=null; }; var EBARowRenderer=Class.create(); EBARowRenderer.prototype={initialize:function(_333,_334,_335,_336,_337,_338){ this.rowHeight=_335||23; this.xmlDataSource=_333; this.firstColumn=_336; this.columns=_337; this.uniqueId=_338; },render:function(_339,rows,_33b,_33c,_33d,_33e){ if(this.xslTemplate==null){ return ""; } var _339=Number(_339)||0; var rows=Number(rows)||0; if(EBA_DEBUG_MODE){ } this.xslTemplate.addParameter("\u0073tar\u0074",_339,""); this.xslTemplate.addParameter("e\u006e\u0064",_339+rows,""); this.xslTemplate.addParameter("act\u0069\u0076\u0065C\u006flum\u006e",_33b,""); this.xslTemplate.addParameter("\u0061\u0063\u0074\u0069v\u0065\u0052ow",_33c,""); this.xslTemplate.addParameter("\u0073or\u0074\u0043\u006f\u006cu\u006dn",_33d,""); this.xslTemplate.addParameter("\u0073\u006fr\u0074\u0044irec\u0074i\u006f\u006e",_33e,""); s2=Eba.Xml.transformToString(this.xmlDataSource.xmlDoc(),this.xslTemplate,"x\u006d\u006c"); return s2.replace(/ATOKENTOREPLACE/g,"&\u006e\u0062sp;"); },dataReady:function(_33f){ },_h_24:function(_340,_341,_342,_343,_344,_345,_346){ _344=_344||0; _345=_345||0; _346=_346||0; _341.addParameter("s\u0068\u006fwI\u006e\u0064\u0069cato\u0072\u0073",_345,""); _341.addParameter("show\u0048\u0065\u0061\u0064e\u0072s",_344,""); _341.addParameter("\u0066irstCo\u006cu\u006dn",_342,""); _341.addParameter("l\u0061\u0073\u0074C\u006f\u006c\u0075mn",_342+_343,""); _341.addParameter("uniq\u0075\u0065I\u0064",this.uniqueId,""); _341.addParameter("ro\u0077\u0048\u006fver",_346,""); var _347=Eba.Xml.transformToXml(_340,_341); ebaAssert((_347.xml!=""),"xmlTemplate is empty.\n","",EBA_THROW); try{ var path=(typeof (gApplicationPath)=="\u0075\u006ed\u0065f\u0069\u006e\u0065d"?window.location.href.substr(0,window.location.href.lastIndexOf("\u002f")+1):gApplicationPath); var imp=_347.selectNodes("//\u0078\u0073\u006c:\u0069mp\u006frt"); for(var i=0;i<imp.length;i++){ imp[i].setAttribute("\u0068\u0072ef",path+"\u0078\u0073\u006c/"+imp[i].getAttribute("\u0068\u0072\u0065\u0066")); } } catch(e){ } this.xslTemplate=Eba.Xml.createXslProcessor(_347); },getViewableRows:function(_34b){ return _34b/this.rowHeight; },getViewableColumns:function(){ },_h_46:function(){ s=Eba.Xml.transformToString(data,rowXsl); }}; EBARowRenderer.prototype.dispose=function(){ this.xslTemplate=null; this.xmlDataSource=null; }; var EBAGroupRenderer=Class.create(); EBAGroupRenderer.prototype={initialize:function(_34c,_34d){ this.xmlDataSource=_34c; this.xslTemplate=_34d; },render:function(){ }}; var EBASurfaceRenderer=Class.create(); EBASurfaceRenderer.prototype={initialize:function(_34e,_34f){ this.xmlDataSource=_34e; this.xslTemplate=_34f; this.collection=null; },_h_63:function(top){ },render:function(top,_352,left,_354){ }}; EBAScroller_RENDERTIMEOUT=50; EBAScroller_VIEWPANES=new Array("t\u006f\u0070left","to\u0070cente\u0072","top\u0072\u0069ght","\u006di\u0064\u006c\u0065\u0066\u0074","\u006di\u0064c\u0065\u006e\u0074\u0065r","\u006di\u0064righ\u0074","bot\u0074\u006fm\u006c\u0065\u0066t","\u0062o\u0074t\u006f\u006dc\u0065nter","b\u006f\u0074\u0074o\u006d\u0072\u0069g\u0068\u0074"); var numRequests=0; var numRequestsFilled=0; var Scroller3x3=Class.create(); Scroller3x3.prototype={initialize:function(owner,_355,_356,top,_358,_359,left,_35b,_35c,rows,_35e,_35f,_360,_361,_362){ this.scrollTop=0; this.scrollLeft=0; this.height=_356; this.width=_355; this.contentHeight=_35c; ebaAssert(!isNaN(this.contentHeight),"c\u006fn\u0074\u0065\u006e\u0074 \u0068e\u0069g\u0068\u0074 \u0069s\u0020\u006e\u0061n"); this.contentWidth=_35b; this.top=Math.min(Math.max(0,top),_356); this.bottom=Math.min(Math.max(0,_359),_356-this.top); this.mid=Math.max(0,_356-this.top-this.bottom); this.left=Math.min(Math.max(0,left),_355); this.right=Math.min(Math.max(0,_358),_355-this.left); this.center=Math.max(0,_355-this.left-this.right); this.rows=rows; this.columns=_35e; this.freezetop=_35f; this.freezeleft=_360; this.freezebottom=_361; this.freezeright=_362; this.swapped=false; this.status=0; this.block=new Array(); this.lastScrollTop=-1; this.owner=owner; this.view={topleft:new Viewport(null,0,this.top,this.left),topcenter:new Viewport(null,1,this.top,this.center),topright:new Viewport(null,2,this.top,this.right),midleft:new Viewport(this.owner,3,this.mid,this.left,top,_358,_359,0),midcenter:new Viewport(this.owner,4,this.mid,this.center,top,_358,_359,left),midright:new Viewport(this.owner,5,this.mid,this.right),bottomleft:new Viewport(null,6,this.bottom,this.left),bottomcenter:new Viewport(null,7,this.bottom,this.center),bottomright:new Viewport(null,8,this.bottom,this.right)}; this._h_65(); this.activeView=null; this.scrollSurface=null; this.startRow=_35f; this.indicatorHeight=23; this.rowHeight=23; this.disposal=[]; },setMainSurfaceWidth:function(_363){ },_h_65:function(){ var _364=0; var _365=null; if(this.implementsStandardPaging()){ _365=this.getRowsPerPage(); _364=_365*this.getCurrentPageIndex(); } this.view.topleft._h_65(0+_364,this.freezetop,0,this.freezeleft); this.view.topcenter._h_65(0+_364,this.freezetop,this.freezeleft,this.columns-this.freezeleft-this.freezeright); this.view.topright._h_65(0+_364,this.freezetop,this.columns-this.freezeright,this.freezeright); this.view.midleft._h_65(_364+this.freezetop,(_365?_365:this.rows)-this.freezebottom-this.freezetop,0,this.freezeleft); this.view.midcenter._h_65(_364+this.freezetop,(_365?_365:this.rows)-this.freezebottom-this.freezetop,this.freezeleft,this.columns-this.freezeleft-this.freezeright); this.view.midright._h_65(_364+this.freezetop,(_365?_365:this.rows)-this.freezebottom-this.freezetop,this.columns-this.freezeright,this.freezeright); this.view.bottomleft._h_65(this.rows-1-this.freezebottom,this.freezebottom,0,this.freezeleft); this.view.bottomcenter._h_65(this.rows-1-this.freezebottom,this.freezebottom,this.freezeleft,this.columns-this.freezeleft-this.freezeright); this.view.bottomright._h_65(this.rows-1-this.freezebottom,this.freezebottom,this.columns-this.freezeright,this.freezeright); },resize:function(_366,_367,top,_369,_36a,left,_36c,_36d){ this.height=_367; this.width=_366; this.contentHeight=_36d; ebaAssert(!isNaN(this.contentHeight),"\u0063on\u0074e\u006e\u0074 h\u0065\u0069gh\u0074 \u0069s\u0020\u006e\u0061n"); this.contentWidth=_36c; this.top=Math.min(Math.max(0,top),_367); this.bottom=Math.min(Math.max(0,_36a),_367-this.top); this.mid=Math.max(0,_367-this.top-this.bottom); this.left=Math.min(Math.max(0,left),_366); this.right=Math.min(Math.max(0,_369),_366-this.left); this.center=Math.max(0,_366-this.left-this.right); this.setHScrollbarRange((_36c<_366?_366-22:_36c)); this.VScrollbar.style.height=_367-22; this.setVScrollbarRange((_36d<_367?_367-22:_36d)); this.view.topleft.setPosition(this.top,this.left); this.view.topcenter.setPosition(this.top,this.center); this.view.topright.setPosition(this.top,this.right); this.view.midleft.setPosition(this.mid,this.left,top,_369,_36a,left); this.view.midcenter.setPosition(this.top,this.left,top,_369,_36a,left); this.view.midright.setPosition(this.mid,this.right); this.view.bottomleft.setPosition(this.bottom,this.left); this.view.bottomcenter.setPosition(this.bottom,this.center); this.view.bottomright.setPosition(this.bottom,this.right); },_h_67:function(_36e){ this.swapPanes(true); this.view.midcenter.element.scrollLeft=Math.round((this.view.midcenter.element.scrollWidth-this.view.midcenter.element.clientWidth)*_36e); },_h_68:function(_36f){ this.swapPanes(false); ebaAssert(!isNaN(_36f),"\u0073\u0063r\u006fllP\u0065\u0072\u0063ent\u0020\u0069\u0073\u004e\u0061N"); this.view.midcenter.element.scrollTop=Math.round((this.view.midcenter.element.scrollHeight-this.view.midcenter.element.clientHeight)*_36f); this.status=1; },_h_81:function(){ },getVisibleRect:function(){ return this.view.midcenter.getVisibleRect(); },_h_9:function(_370){ if(_370){ for(var v in this.view){ if(v!="\u006d\u0069dc\u0065nter"&&v!="mi\u0064\u006c\u0065f\u0074"){ this.view[v].clear(true); } } } this.view.midleft.clear(false,true,false,false); this.view.midcenter.clear(false,false,true); },alignSurfaces:function(){ var fh=this.view.topcenter.surface.element; var hp=this.view.topcenter.placeholder; var ff=this.view.bottomcenter.surface.element; var su=this.view.midcenter.element.firstChild; var da=this.view.midcenter.surface.element; var le=this.view.midleft.placeholder; var lb=this.view.midleft.element; var lh=this.view.topleft.element; var lf=this.view.bottomleft.element; var ri=this.view.midright.placeholder; var rb=this.view.midright.element; var rf=this.view.bottomright.element; var rh=this.view.topright.element; var vp=this.view.midcenter.element; var hb=this.view.topcenter.element; var fb=this.view.bottomcenter.element; ebaAssert(!isNaN(this.contentHeight),"c\u006fnt\u0065n\u0074\u0020\u0068\u0065i\u0067ht is\u0020nan"); da.style.height=this.contentHeight; su.style.height=this.contentHeight; le.style.height=this.contentHeight; ri.style.height=this.contentHeight; da.style.width=this.contentWidth; su.style.width=this.contentWidth; fh.style.width=this.contentWidth-this.right; ff.style.width=this.contentWidth; su.style.backgroundColor="\u0023F\u0046\u0046\u0046\u0046\u0046"; da.style.backgroundColor="#\u0046\u0046\u0046\u0046FF"; Align(su,vp,Align_ALIGNTOP|Align_ALIGNBOTTOM,0,0,0,0); Align(le,su,Align_SAMEHEIGHT|Align_ALIGNTOP|Align_ALIGNLEFT,0,0,this.top,0); Align(lb,vp,Align_SAMEHEIGHT|Align_ALIGNTOP|Align_ALIGNLEFT,-(this.top+this.bottom),0,this.top,0); Align(rb,vp,Align_SAMEHEIGHT|Align_ALIGNTOP|Align_ALIGNRIGHT,-(this.top+this.bottom),0,this.top,0); Align(rf,vp,Align_ALIGNBOTTOM|Align_ALIGNRIGHT); Align(lf,vp,Align_ALIGNBOTTOM|Align_ALIGNLEFT); Align(hb,vp,Align_SAMEWIDTH|Align_ALIGNTOP,0,0,0,0); Align(hp,vp,Align_SAMEWIDTH|Align_ALIGNTOP|Align_ALIGNLEFT,0,0,0,0); Align(fb,vp,Align_ALIGNBOTTOM|Align_ALIGNLEFT,0,0,0,this.left); fh.style.backgroundColor="#F\u0030F\u0030\u00460"; ff.style.backgroundColor="\u0023F0\u0046\u0030\u00460"; Align(lh,vp,Align_ALIGNTOP|Align_ALIGNLEFT); Align(da,su,269488128,0,0,this.top,0); Align(rh,vp,Align_ALIGNTOP|Align_ALIGNRIGHT); this.setHScrollbarRange(this.contentWidth); this.setVScrollbarRange(this.contentHeight); },setHScrollbarRange:function(size){ this.HScrollbar.firstChild.style.width=size; },getHScrollbarRange:function(){ return this.HScrollbar.firstChild.style.width; },setVScrollbarRange:function(size){ this.VScrollbar.firstChild.style.height=size; },getVScrollbarRange:function(){ return this.VScrollbar.firstChild.style.height; },_h_37:function(_384){ _384=document.getElementById(_384.getAttribute("p\u0061\u0072en\u0074\u0069\u0064")); this.view.topleft._h_37(getDomNode(_384,"3"),getDomNode(_384,"3\u002f\u0030"),null); this.view.topcenter._h_37(getDomNode(_384,"\u0037"),getDomNode(_384,"\u0037/\u0030"),getDomNode(_384,"\u0030/\u0030/\u0033")); this.view.topright._h_37(getDomNode(_384,"5"),getDomNode(_384,"5\u002f\u0030"),null); this.view.midleft._h_37(getDomNode(_384,"\u0031"),getDomNode(_384,"\u0031/0"),getDomNode(_384,"0\u002f0/1")); this.view.midcenter._h_37(getDomNode(_384,"0"),getDomNode(_384,"0\u002f0\u002f0"),null); this.view.midright._h_37(getDomNode(_384,"\u0032"),getDomNode(_384,"2/0"),getDomNode(_384,"0\u002f0\u002f\u0032")); this.view.bottomleft._h_37(getDomNode(_384,"\u0034"),getDomNode(_384,"\u0034\u002f0"),null); this.view.bottomcenter._h_37(getDomNode(_384,"\u0038"),getDomNode(_384,"8/\u0030"),getDomNode(_384,"\u0030/\u0030/0\u002f2")); this.view.bottomright._h_37(getDomNode(_384,"\u0036"),getDomNode(_384,"6\u002f\u0030"),null); this.scrollSurface=getDomNode(_384,"0"); },getRowRange:function(){ var top=0; var _386=0; var _387=0; var _388=this.scrollSurface.scrollTop+this.top-this.indicatorHeight; if(_387>this.startRow){ _387--; } if(top<_388){ _387+=Math.floor((_388-top)/this.rowHeight); } _387+=_386; var _389=0; var _38a=0; var _38b=this.scrollSurface.clientHeight-this.top-this.bottom; if(_389<_38b){ _38a+=Math.ceil((_38b-_389)/this.rowHeight); } _38a+=_387; _387=Math.max(_387,0); var pair; if(this.implementsStandardPaging()){ var _38d=0; _38d=this.getRowsPerPage()*this.getCurrentPageIndex(); var _38e=_387+_38d; var last=Math.min(_38a+_38d,_38e+this.getRowsPerPage()-1); pair={first:_38e,last:last}; }else{ pair={first:_387,last:_38a}; } return pair; },fixPanes:function(){ this.swapPanes(true); this.swapPanes(false); },swapPanes:function(_390){ if(_390){ if(!this.swapped){ var _391=this.view.midleft.placeholder; _391.style.left=0; _391.swapNode(this.view.midleft.surface.element); _391.style.top=0-this.view.midcenter.element.scrollTop; var _392=this.view.midright.placeholder; _392.swapNode(this.view.midright.surface.element); _392.style.top=0-this.view.midcenter.element.scrollTop; _392.style.left=0; this.view.topcenter.placeholder.swapNode(this.view.topcenter.surface.element); this.view.bottomcenter.placeholder.swapNode(this.view.bottomcenter.surface.element); this.view.topcenter.surface.element.style.left=this.left; var oy=0; if(!IE){ oy=this.scrollSurface.scrollTop; } Align(this.view.topcenter.surface.element,this.view.topcenter.element,1048576,0,0,oy,0); this.view.topcenter.surface.element.style.zIndex=10000000; this.view.topcenter.element.style.visibility="h\u0069\u0064\u0064\u0065\u006e"; this.view.bottomcenter.surface.element.style.left=this.left; Align(this.view.bottomcenter.surface.element,this.view.bottomcenter.element,1048576,0,0,oy,0); this.view.bottomcenter.surface.element.style.zIndex=10000000; this.view.bottomcenter.element.style.visibility="\u0068i\u0064\u0064e\u006e"; this.view.midleft.element.style.visibility="\u0076i\u0073i\u0062l\u0065"; this.view.midright.element.style.visibility="visi\u0062le"; this.swapped=true; } }else{ if(this.swapped){ this.view.midleft.surface.element.swapNode(this.view.midleft.placeholder); this.view.midleft.placeholder.style.top=-this.view.midcenter.element.scrollHeight+this.top; this.view.midright.surface.element.swapNode(this.view.midright.placeholder); if(IE){ Align(this.view.midright.placeholder,this.view.midright.element,16781312,0,0,0,0); }else{ Align(this.view.midright.placeholder,this.view.midright.element,16781312,0,0,0,this.view.midcenter.element.scrollLeft); } this.view.midright.placeholder.style.top=-(2*this.view.midcenter.element.scrollHeight)+this.top; this.view.topcenter.placeholder.swapNode(this.view.topcenter.surface.element); this.view.bottomcenter.placeholder.swapNode(this.view.bottomcenter.surface.element); this.view.topcenter.surface.element.style.top=0; this.view.topcenter.surface.element.style.left=0-this.view.midcenter.element.scrollLeft; this.view.bottomcenter.surface.element.style.top=0; this.view.bottomcenter.surface.element.style.left=0-this.view.midcenter.element.scrollLeft; this.view.topcenter.element.style.visibility="\u0076i\u0073ib\u006ce"; this.view.bottomcenter.element.style.visibility="v\u0069\u0073\u0069\u0062\u006ce"; this.view.midleft.element.style.visibility="h\u0069\u0064d\u0065\u006e"; this.view.midright.element.style.visibility="hidd\u0065\u006e"; this.view.midleft.placeholder.style.left=this.view.midcenter.element.scrollLeft; this.swapped=false; } } },render:function(){ if(this.scrollSurface.scrollTop!=this.lastScrollTop){ var _394=this.getRowRange(); if(!this._h_48()){ var _395=Eba.closeLater(this,this.renderReady,[]); var _396=window.setTimeout(_395,EBAScroller_RENDERTIMEOUT); this.disposal.push(function(){ _395=null; }); }else{ var vs=document.getElementById("vs\u0063r\u006f\u006cl"+this.owner.uid); var _398=Math.abs(vs.scrollTop+Eba.Dom.getHeight(vs)-Eba.Dom.getHeight(vs.firstChild))<2; this.view.midcenter.adjustScrollableSurfaceIfNotLastPage(true); this.view.midleft.render(_394); this.view.midcenter.render(_394); } numRequests++; } },renderReady:function(){ var _399=this.getRowRange(); var _39a=this.scrollSurface.scrollTop; if(_39a<=this.scrollSurface.scrollTop&&this.scrollSurface.scrollTop<=_39a+this.scrollSurface.clientHeight){ this.view.midleft.render(_399); var t=this.view.midcenter.render(_399); this.view.midcenter.adjustScrollableSurfaceIfNotLastPage(t==false); numRequestsFilled++; } },_h_48:function(){ var _39c=this.getRowRange(); var _39d=this.view.midcenter.cacheMap._h_22(_39c.first,_39c.last); return Boolean(_39d[0]==null); },move:function(h,v){ alert("s\u0063\u0072\u006f\u006c\u006ce\u0072\u0020mo\u0076\u0065"); eval(this.onMove); },flushCache:function(){ for(var _3a0 in EBAScroller_VIEWPANES){ eval("\u0074\u0068\u0069\u0073\u002e\u0076iew."+EBAScroller_VIEWPANES[_3a0]+".\u0066\u006cu\u0073\u0068\u0043ache(\u0029"); } },position:function(){ },getRowsPerPage:function(){ return this.owner.getRowsPerPage(); },getCurrentPageIndex:function(){ return this.owner.getCurrentPageIndex(); },implementsStandardPaging:function(){ return Boolean(this.owner.getPagingMode().toLowerCase()=="standa\u0072d"); }}; Scroller3x3.prototype.setLeftPaneWidth=function(_3a1){ this.left=parseInt(_3a1); }; Scroller3x3.prototype.getLeftPaneWidth=function(){ return this.left; }; Scroller3x3.prototype.dispose=function(){ try{ var _3a2=this.disposal.length; for(var i=0;i<_3a2;i++){ if(typeof (this.disposal[i])=="\u0066u\u006ec\u0074\u0069on"){ this.disposal[i].call(this); } this.disposal[i]=null; } for(var v in this.view){ this.view[v].dispose(); } } catch(e){ } }; var Scroller=Class.create(); Scroller.prototype={initialize:function(_3a5,_3a6,_3a7,_3a8){ this.viewport=_3a7; this.surface=_3a8; },_h_68:function(_3a9){ }}; Viewport_TopLeft=0; Viewport_TopCenter=1; Viewport_TopRight=2; Viewport_MidLeft=3; Viewport_MidCenter=4; Viewport_MidRight=5; Viewport_BottomLeft=6; Viewport_BottomCenter=7; Viewport_BottomRight=8; var Viewport=Class.create(); Viewport.prototype={initialize:function(_3aa,_3ab,_3ac,_3ad,top,_3af,_3b0,left,_3b2,_3b3,_3b4){ this.lag=500; this.lastPause=0; this.height=_3ac; this.width=_3ad; this.surface=_3b3||new Surface(); this.element=_3b2; this.placeholder=_3b4; this.rowHeight=23; this.headerHeight=23; this.lastGoodRow=0; this.surfaceAdjustmentMultiplier=2; this.region=_3ab; top=(Boolean(top)&&!isNaN(top)?top:0); this.top=Math.min(Math.max(0,top),_3ac); ebaAssert(this.top>=0&&!isNaN(this.top),"\u0074his.top \u0069\u006e\u0020\u0076i\u0065w\u0070\u006fr\u0074 i\u0073\u0020\u0062\u0065\u0069\u006eg\u0020\u0063a\u006c\u0063ul\u0061\u0074\u0065d \u0069n\u0063\u006f\u0072r\u0065ctl\u0079.\u0020\u0074h\u0069s.to\u0070\u0020\u0069s\u0020"+this.top+" \u0061\u006e\u0064\u0020t\u006f\u0070 is\u0020"+top+" and \u0068e\u0069gh\u0074\u0020is\u0020"+_3ac); this.bottom=Math.min(Math.max(0,_3b0),_3ac-this.top); this.mid=Math.max(0,_3ac-this.top-this.bottom); this.left=Math.min(Math.max(0,left),_3ad); this.right=Math.min(Math.max(0,_3af),_3ad-this.left); this.center=Math.max(0,_3ad-this.left-this.right); this.lastScrollTop=-1; this.scrollIncrement=0; this.pagingObject=_3aa; this.rowBindingSet="./\u0052\u006f\u0077"; this.columnBindingSet="\u002e/\u0043\u0065l\u006c"; this.ViewNavigator=new EBAViewNavigator(); this.ViewNavigator.view=this; this.ViewNavigator.onEdit="th\u0069\u0073\u002ev\u0069e\u0077\u002ee\u0064\u0069t(\u0065\u0076\u0074)"; this.ViewNavigator.onMove="this\u002e\u0076\u0069\u0065\u0077.\u006d\u006f\u0076\u0065()\u003b\u0074\u0068is\u002e\u0076\u0069\u0065\u0077.a\u0063\u0074\u0069\u0076\u0065Ce\u006c\u006c=\u0074\u0068i\u0073.ac\u0074i\u0076\u0065Cel\u006c"; this.ViewNavigator.onMovePastLeftEdge="t\u0068is.\u0076i\u0065w\u002e\u006fwn\u0065r\u002e\u0073\u0065t\u0050o\u0073\u0069ti\u006f\u006e(\u0074his.\u0063\u0075r\u0072\u0065n\u0074\u0052\u006f\u0077,t\u0068i\u0073.\u0063\u0075r\u0072\u0065\u006et\u0043ol\u0075\u006dn\u0029"; this.ViewNavigator.onMovePastRightEdge="\u0074his.\u0076i\u0065w.o\u0077n\u0065\u0072\u002es\u0065\u0074\u0050os\u0069\u0074\u0069o\u006e\u0028\u0074\u0068is.curre\u006et\u0052\u006f\u0077\u002ct\u0068\u0069\u0073.c\u0075\u0072\u0072en\u0074\u0043\u006f\u006cu\u006d\u006e)"; this.ViewNavigator.onMovePastTopEdge="\u0074h\u0069s.\u0076\u0069e\u0077\u002eo\u0077ner\u002ese\u0074P\u006f\u0073it\u0069\u006fn(\u0074h\u0069\u0073.\u0063u\u0072re\u006e\u0074R\u006f\u0077\u002c\u0074\u0068i\u0073.c\u0075rre\u006e\u0074\u0043\u006f\u006c\u0075\u006dn\u0029"; this.ViewNavigator.onMovePastBottomEdge="th\u0069s\u002ev\u0069e\u0077\u002e\u006f\u0077\u006eer\u002e\u0073etPosi\u0074\u0069on(\u0074\u0068is.\u0063\u0075\u0072\u0072e\u006etRow,t\u0068\u0069\u0073\u002e\u0063u\u0072re\u006e\u0074C\u006flum\u006e\u0029"; this.indicatorHeight=23; this.startRow=0; this.rows=0; this.startColumn=0; this.columns=0; this.activeBlock=null; this.activeCell=null; this.lastPage=false; this.cacheMap=new CacheMap(-1,-1); this.requestCacheMap=new CacheMap(-1,-1); this.EBARowRenderer=null; this.disposal=[]; this.columnResizer=new Eba.ColumnResizer(this.owner); },_h_37:function(_3b5,_3b6,_3b7){ this.surface.element=_3b6; this.element=_3b5; this.placeholder=_3b7; switch(this.region){ case 0: case 1: case 2: case 6: case 7: case 8: this.container=this.surface.element; break; case 3: case 5: this.container=this.placeholder; break; default: this.container=this.element.childNodes[0].childNodes[0].childNodes[1]; } },_h_65:function(_3b8,rows,_3ba,_3bb){ this.startRow=_3b8; this.rows=rows; this.startColumn=_3ba; this.columns=_3bb; this.ViewNavigator._h_65(_3b8,rows,_3ba,_3bb); },setPosition:function(_3bc,_3bd,top,_3bf,_3c0,left){ this.height=_3bc; this.width=_3bd; this.rowHeight=23; this.headerHeight=23; if(this.region==3){ ebaAssert(top>=0&&_3bc>=0,"t\u006fp \u0061n\u0064\u0020h\u0065\u0069\u0067\u0068t a\u0072e \u0069\u006ec\u006f\u0072\u0072\u0065\u0063t\u006cy \u0064\u0065f\u0069ne\u0064\u0020i\u006e\u0020vi\u0065\u0077p\u006f\u0072t\u002es\u0065tPositio\u006e\u002e\u0020Vie\u0077po\u0072\u0074\u0020re\u0067\u0069o\u006e:\u0020"+this.region+"\u002e\u0020(\u0074o\u0070,heig\u0068t\u0029\u0020\u003d\u0020"+top+"\u002c"+_3bc); } this.top=Math.min(Math.max(0,top),_3bc); this.bottom=Math.min(Math.max(0,_3c0),_3bc-this.top); this.mid=Math.max(0,_3bc-this.top-this.bottom); this.left=Math.min(Math.max(0,left),_3bd); this.right=Math.min(Math.max(0,_3bf),_3bd-this.left); this.center=Math.max(0,_3bd-this.left-this.right); },_h_68:function(_3c2){ },getVisibleRect:function(){ return new Rect(this.element.scrollTop,this.element.scrollLeft); },clear:function(_3c3,_3c4,_3c5,_3c6){ if(this.surface.element&&_3c3){ this.surface.element.innerHTML="<\u0064\u0069v><\u002fdi\u0076>"; } if(this.placeholder&&_3c4){ this.placeholder.innerHTML="<di\u0076></d\u0069v>"; } if(this.element&&_3c6){ this.element.innerHTML="<\u0064i\u0076>\u003c/div\u003e"; } if(this.surface.element&&_3c5){ this.element.childNodes[0].childNodes[0].childNodes[1].innerHTML="<\u0064\u0069v\u003e</\u0064\u0069v>"; } this.lastScrollTop=-1; },render:function(_3c7){ var _3c8=this.cacheMap._h_22(_3c7.first,_3c7.last); if(_3c8[0]!=null){ var low=_3c8[0].low; var high=_3c8[0].high; var _3cb=this.requestCacheMap._h_22(low,high); var _3cc=_3cb.length; if(_3cc>0){ for(var i=0;i<_3cc;i++){ var _3ce=_3cb[i].low; var _3cf=_3cb[i].high; if(_3cf-_3ce<10){ _3cf=_3ce+10; } this.requestCacheMap.insert(_3ce,_3cf); var rows=_3cf-_3ce+1; this.EBARowRenderer.xmlDataSource.getTable("_\u0064efaul\u0074").get(_3ce,rows,this,this.dataReady); } } } this.status=0; return (_3c8[0]!=null); },dataReady:function(_3d1){ var vs=document.getElementById("\u0076\u0073c\u0072\u006fl\u006c"+this.owner.uid); var _3d3=(vs.scrollTop)/(vs.scrollHeight-vs.clientHeight); var _3d4=Math.abs(vs.scrollTop+Eba.Dom.getHeight(vs)-Eba.Dom.getHeight(vs.firstChild))<2; if(_3d1.pageSize==0&&this.region==Viewport_MidCenter&&!(_3d1.lastPage||this.lastPage)&&this.owner.getPagingMode().toLowerCase()!="s\u0074a\u006edar\u0064"){ var _3d5=this.owner.getPrimaryDatasourceSize(); var _3d6=_3d5-this.lastGoodRow; this.adjustScrollableSurface(1,-1*_3d6/2); ebaAssert(!isNaN(this.lastGoodRow*this.owner.getRowHeight()),"ST\u0020i\u0073 \u006ea\u006e"); vs.scrollTop=this.lastGoodRow*this.owner.getRowHeight(); this.surfaceAdjustmentMultiplier=1+((this.surfaceAdjustmentMultiplier-1)/2); return; }else{ if(_3d1.pageSize==0&&!(_3d1.lastPage||this.lastPage)&&this.owner.getPagingMode().toLowerCase()!="\u0073\u0074\u0061\u006eda\u0072d"){ return; } } if(!_3d4&&_3d1.pageSize==0&&this.owner.getPagingMode().toLowerCase()!="st\u0061ndar\u0064"){ return; } var low=_3d1.firstRow,high=_3d1.lastRow; this.lastGoodRow=Math.max(high,this.lastGoodRow); this._h_50(low,high); this.cacheMap.insert(low,high); if(!this.lastPage&&_3d1.lastPage&&this.owner.getPagingMode().toLowerCase()!="\u0073\u0074anda\u0072\u0064"){ this.lastPage=true; this.owner.setPrimaryDatasourceSize(_3d1.startXi+_3d1.pageSize); this.owner.setRowCount(_3d1.startXi+_3d1.pageSize-1); this.adjustScrollableSurface(1,0); ebaAssert(!isNaN(Eba.Dom.getHeight(vs.firstChild)-Eba.Dom.getHeight(vs)),"\u0053T\u0020is\u0020\u006e\u0061n"); vs.scrollTop=Eba.Dom.getHeight(vs.firstChild)-Eba.Dom.getHeight(vs); return; } this.adjustScrollableSurfaceIfNotLastPage(); this.owner.setRowCount(_3d1.startXi+_3d1.pageSize-1); },adjustScrollableSurfaceIfNotLastPage:function(_3d8){ if(this.owner.getPagingMode().toLowerCase()=="s\u0074\u0061n\u0064ard"){ return; } var vs=document.getElementById("\u0076s\u0063\u0072\u006fl\u006c"+this.owner.uid); var _3da=Math.abs(vs.scrollTop+Eba.Dom.getHeight(vs)-Eba.Dom.getHeight(vs.firstChild))<2; if(_3d8==null||typeof (_3d8)=="\u0075n\u0064ef\u0069\u006eed"){ _3d8=true; } if(_3da&&this.region==Viewport_MidCenter&&!this.lastPage&&_3d8){ var _3db=vs.scrollTop; this.adjustScrollableSurface(this.surfaceAdjustmentMultiplier,0); ebaAssert(!isNaN(Math.round((this.owner.getcontentHeight()/this.surfaceAdjustmentMultiplier)-(this.owner.getHeight())+23+(this.owner.toolbar?parseInt(this.owner.toolbar.getHeight()):0))),"S\u0054\u0020\u0069\u0073\u0020n\u0061\u006e"); vs.scrollTop=Math.round((this.owner.getcontentHeight()/this.surfaceAdjustmentMultiplier)-(this.owner.getHeight())+23+(this.owner.toolbar?parseInt(this.owner.toolbar.getHeight()):0)); } },adjustScrollableSurface:function(_3dc,_3dd){ if(this.owner.getPagingMode().toLowerCase()=="st\u0061nd\u0061r\u0064"){ return; } var vs=document.getElementById("v\u0073\u0063ro\u006c\u006c"+this.owner.uid); var _3df=(vs.scrollTop)/(vs.scrollHeight-vs.clientHeight); var _3e0=vs.clientHeight; var _3e1=vs.scrollTop; this.owner.setPrimaryDatasourceSize((this.owner.getPrimaryDatasourceSize()*_3dc)+_3dd); this.owner.setDisplayedRowCount(this.owner.getPrimaryDatasourceSize()); var _3e2=this.owner.getPrimaryDatasourceSize()*this.owner.getRowHeight(); this.owner.setcontentHeight(_3e2); this.owner.generateCss(); this.owner.scrollh(); },_h_50:function(top,_3e4,_3e5,star){ var _3e7=_3e4; var rows=_3e7-top+1; var _3e9=this.owner.sortColumnCell; var _3ea=-1,sortDirection="As\u0063"; if(_3e9!=null){ _3ea=_3e9.getAttribute("\u0078i"); } if(this.owner.sortColumn!=null){ sortDirection=this.owner.sortColumn.getSortDirection(); } var _3eb=this.owner.activeCell; var _3ec=0,activeRow=0; if(_3eb!=null){ _3ec=_3eb.getAttribute("co\u006c"); activeRow=_3eb.getAttribute("\u0078i"); } var s=this.EBARowRenderer.render(top,rows,_3ec,activeRow,_3ea,sortDirection); var _3ee=this.implementsStandardPaging()?this.getRowsPerPage()*this.getCurrentPageIndex():0; var _3ef=(top-_3ee)*this.rowHeight; var o=document.createElement("d\u0069\u0076"); o.style.position="\u0061\u0062so\u006cut\u0065"; ebaAssert(Boolean(this.top)&&!isNaN(this.top),"t\u0068\u0069s.t\u006f\u0070 \u0069n \u0076i\u0065\u0077\u0070or\u0074\u0020"+this.region+" i\u0073\u0020N\u0061n\u0020\u006fr \u0075nd\u0065fi\u006eed"); o.style.top=_3ef-this.top+this.rowHeight; Eba.EventManager.attach(o,"\u006d\u006fu\u0073e\u0064\u006f\u0077n",this,Eba.close(this,this.mouseDown),false); Eba.EventManager.attach(o,"\u0064\u0062\u006cclick",this,Eba.close(this,this.activate),false); Eba.EventManager.attach(o,"\u006d\u006fu\u0073\u0065m\u006fve",this,Eba.close(this,this.mouseMove),false); switch(this.region){ case Viewport_TopLeft: case Viewport_MidLeft: case Viewport_BottomLeft: o.style.left=this.left; break; case Viewport_TopCenter: break; case Viewport_MidCenter: case Viewport_BottomCenter: o.className="eb\u0061\u006d\u0069d\u0062l\u006fckc\u006fn\u0074ain\u0065\u0072"+this.owner.uid; break; case Viewport_TopRight: case Viewport_MidRight: case Viewport_BottomRight: o.style.left=this.left; break; } o.setAttribute("de\u0073cr\u0069p\u0074ion","\u0062\u006co\u0063\u006b\u0020cont\u0061iner"); o.top=top; o.bottom=_3e7; o.left=this.startColumn; o.right=this.startColumn+this.columns; o.innerHTML=s; this.container.appendChild(o); o.rows=rows; o.columns=this.columns; },activate:function(_3f1,e){ var evt=Eba.Event; this.activeCell=this.findActiveCell(evt.srcElement); this.activeBlock=_3f1; if(!(this.activeCell)||!(this.activeCell.getAttribute)||(this.activeCell.getAttribute("\u0065b\u0061t\u0079\u0070e")=="co\u006c\u0075mnhe\u0061der")){ return; } this.owner.Scroller.activeView=this; var S=this.owner.Selection; if(evt.shiftKey){ if(!S.selecting){ S.init(this.oldCell); } S.redraw(this.activeCell); }else{ S.init(this.activeCell); this.oldCell=this.activeCell; } this.ViewNavigator.DomNode=this.container; this.ViewNavigator.activate(_3f1,e); eval(this.onFocus); },edit:function(e){ var evt=(IE)?event:e; eval(this.onEdit); },move:function(h,v){ this.position(); eval(this.onMove); },handleKey:function(e){ var evt=(IE)?event:e; if(typeof (this.ViewNavigator.blockNavigator.viewNavigator)=="\u0075nde\u0066i\u006eed"){ this.ViewNavigator.activate(this.activeBlock,e); } this.ViewNavigator.handleKey(this.activeBlock,e); },mouseDown:function(o,e){ var evt=Eba.Event; var _3fe=this.findActiveCell(evt.srcElement); if(_3fe.getAttribute("eba\u0074y\u0070\u0065")=="c\u006f\u006c\u0075m\u006e\u0068e\u0061d\u0065\u0072"){ var __x=evt.clientX; var _400=_3fe.getBoundingClientRect().right; if((__x<_400&&__x>_400-10)){ var _401=this.owner.getColumnObject(parseInt(_3fe.getAttribute("\u0078\u0069"))); this.columnResizer.startResize(this.owner,_401,_3fe,evt); }else{ this._h_26(_3fe); } }else{ if(_3fe.tagName=="SP\u0041N"){ this.activeCell=_3fe; if(!evt.shiftKey){ this.activate(o,e); } } } },_h_58:function(_402,_403){ var S=this.owner.Selection; if(!S.selecting){ S.init(_403); } S.redraw(_402); },clearSelect:function(cell){ var S=this.owner.Selection; S.collapse(cell); },_h_26:function(_407){ var _408=_407.getAttribute("\u0078i"); this.owner.sort(_408); },mouseMove:function(o,e){ var evt=Eba.Event; this.activeCell=this.findActiveCell(evt.srcElement); var __x=evt.clientX; var __y=evt.clientY; if(this.activeCell.tagName!="\u0053\u0050\u0041\u004e"&&this.activeCell.getAttribute("eba\u0074\u0079\u0070e")!="c\u006f\u006c\u0075mnhea\u0064e\u0072"){ return; } var S=this.owner.Selection; if(S.selecting){ if(evt.button==1||evt.button==65535){ S.redraw(this.activeCell); }else{ S.select(this.activeCell); } } if(S.resizingRow){ } if(this.activeCell.getAttribute("ebat\u0079p\u0065")=="c\u006fl\u0075mn\u0068e\u0061\u0064\u0065r"){ var rect=this.activeCell.getBoundingClientRect(); ebaAssert(this.activeCell!=null&&Boolean(this.activeCell),"\u0043\u006f\u0075l\u0064\u006e't\u0020\u0073\u0065\u0074\u0020th\u0065\u0020m\u006f\u0075s\u0065\u0020cu\u0072\u0073\u006f\u0072.\u0020The\u0020HTML\u0020\u0073\u0074\u0072\u0075c\u0074\u0075\u0072e is\u0020\u006e\u006f\u0074\u0020a\u0073\u0020e\u0078pe\u0063ted\u002e"); Eba.EventManager.attach(this.activeCell,"mo\u0075\u0073\u0065ou\u0074",this.activeCell,function(){ this.style.cursor="\u0061\u0075to"; },false); if((__x<rect.right&&__x>rect.right-10)){ this.activeCell.style.cursor="w-r\u0065\u0073\u0069ze"; }else{ this.activeCell.style.cursor="\u0061\u0075t\u006f"; } } evt.cancelBubble=true; evt.returnValue=false; return false; },flushCache:function(){ if(Boolean(this.cacheMap)){ this.cacheMap._h_20(); } if(Boolean(this.requestCacheMap)){ this.requestCacheMap._h_20(); } },position:function(){ var _410=this.owner.Scroller.view.midcenter.element; this.activeCell=this.ViewNavigator.blockNavigator.activeCell; ebaAssert(this.activeCell!=null,"po\u0073\u0069\u0074i\u006fn \u0073e\u0074\u0073\u0020\u0061cti\u0076e\u0043e\u006cl t\u006f\u0020\u006eu\u006c\u006c\u002e"); var AC=this.activeCell; var EL=_410; var _413=this.owner.Scroller; ebaAssert(EL!=null,"E\u004c =\u003d\u0020\u006e\u0075ll"); var sct=_410.scrollTop; var scl=_410.scrollLeft; var R1=AC.getClientRects(sct,scl); var R2=EL.getClientRects(); var _418=this.surface.element; ebaAssert(_418!=null,"o\u0042ody ==\u0020null"); var R3=_418.getClientRects(); var st=R1[0].top-R2[0].top-parseInt(this.top); ebaAssert(!isNaN(st),"st \u0069\u0073 \u006e\u0061n"); if(st<0){ EL.scrollTop+=st-2; var vs=_413.VScrollbar; var _41c=(EL.scrollTop)/(EL.scrollHeight-EL.clientHeight); vs.scrollTop=Math.round((vs.scrollHeight-vs.clientHeight)*_41c); } var st=parseInt(R1[0].bottom-R2[0].bottom+20); ebaAssert(!isNaN(st),"\u0073\u0074 \u0069\u0073\u0020n\u0061\u006e"); if(st>0){ ebaAssert(parseInt(EL.scrollTop)>=0,"S\u0063r\u006f\u006c\u006cT\u006f\u0070 \u0069s\u0020\u006ee\u0067\u0061\u0074\u0069v\u0065\u002e"); var _41d=parseInt(EL.scrollTop)+st; ebaAssert(_41d>0,"Additio\u006e \u0069\u006e\u0020p\u006f\u0073\u0069\u0074\u0069on \u0064\u0069d\u0020not\u0020\u0077\u006f\u0072\u006b"); EL.scrollTop=_41d; ebaAssert(parseInt(EL.scrollTop)>0,"S\u0063r\u006f\u006c\u006c\u0054op w\u0061s \u006eo\u0074\u0020set \u0063\u006fr\u0072\u0065c\u0074\u006c\u0079\u002e\u0020I\u0074 \u0069s\u003a\u0020"+EL.scrollTop+"\u0020\u0064\u0065\u0073pite \u0073\u0074 be\u0069\u006e\u0067 "+st); var vs=_413.VScrollbar; var _41c=(EL.scrollTop)/(EL.scrollHeight-EL.clientHeight); ebaAssert(!isNaN(_41c),"Scro\u006cl\u0065\u0072 \u0074\u0072\u0069ed t\u006f\u0020s\u0063ro\u006c\u006c wi\u0074\u0068 a\u0020n\u0061\u006e\u002e"); vs.scrollTop=Math.round((vs.scrollHeight-vs.clientHeight)*_41c); } var sl=R1[0].left-R2[0].left-parseInt(this.left); ebaAssert(!isNaN(sl),"sl\u0020is\u0020\u006e\u0061\u006e"); if(sl<0){ _413.swapPanes(true); EL.scrollLeft+=sl-1; var hs=document.getElementById("\u0068scr\u006f\u006c\u006c"+this.owner.uid); var _41c=(EL.scrollLeft)/(EL.scrollWidth-EL.clientWidth); hs.scrollLeft=Math.round((hs.scrollWidth-hs.clientWidth)*_41c); _413.swapPanes(false); } var sl=R1[0].right-R2[0].right; ebaAssert(!isNaN(sl),"\u0073l\u0020\u0069s\u0020\u006e\u0061n"); if(sl>=0){ _413.swapPanes(true); EL.scrollLeft+=sl; var hs=_413.HScrollbar; var _41c=(EL.scrollLeft)/(EL.scrollWidth-EL.clientWidth); hs.scrollLeft=Math.round((hs.scrollWidth-hs.clientWidth)*_41c); _413.swapPanes(false); } },getRowsPerPage:function(){ return this.pagingObject.getRowsPerPage(); },getCurrentPageIndex:function(){ return this.pagingObject.getCurrentPageIndex(); },implementsStandardPaging:function(){ return Boolean(this.pagingObject&&this.pagingObject.getPagingMode().toLowerCase()=="st\u0061n\u0064a\u0072\u0064"); }}; Viewport.prototype.findActiveCell=function(_420){ var _421=10; for(var i=0;i<_421&&(_420.tagName!="SPA\u004e"&&(_420.getAttribute)&&(_420.getAttribute("\u0065b\u0061\u0074ype")!="co\u006c\u0075\u006d\u006ehea\u0064\u0065r"));i++){ _420=_420.parentNode; } return _420; }; Viewport.prototype.dispose=function(){ this.element=null; this.placeholder=null; this.container=null; this.activeCell=null; this.surface.dispose(); this.ViewNavigator.view=null; this.ViewNavigator.dispose(); this.ViewNavigator=null; this.columnResizer.dispose(); this.columnResizer=null; this.cacheMap._h_20(); this.cacheMap=null; this.requestCacheMap._h_20(); this.requestCacheMap=null; this.EBARowRenderer.dispose(); this.EBARowRenderer=null; var _423=this.disposal.length; for(var i=0;i<_423;i++){ this.disposal[i].call(this); this.disposal[i]=null; } return; }; var Surface=Class.create(); Surface.prototype={initialize:function(_425,_426,_427){ this.height=_426; this.width=_425; this.element=_427; }}; Surface.prototype.dispose=function(){ this.element=null; }; var Renderer=Class.create(); Renderer.prototype={initialize:function(){ }}; var EBAGridGroup=Class.create(); EBAGridGroup.prototype={initialize:function(_428,_429,top,_42b,_42c,left,_42e){ this.height=_429; this.width=_428; this.top=Math.min(Math.max(0,top),_429); this.bottom=Math.min(Math.max(0,_42c),_429-this.top); this.mid=Math.max(0,_429-this.top-this.bottom); this.left=Math.min(Math.max(0,left),_428); this.right=Math.min(Math.max(0,_42b),_428-this.left); this.center=Math.max(0,_428-this.left-this.right); this.element=_42e; },render:function(){ },_h_51:function(){ var s=myEBAGroupRenderer.render(top,(bottom-top+1),1,5); var o=document.createElement("d\u0069v"); o.style.position="ab\u0073\u006fl\u0075te"; o.style.top=top*this.top; o.onclick=this.activate; o.onkeydown=handleKey; o.style.left=0; o.style.background="#0\u0030\u0066\u0066\u00300"; o.innerHTML="<div class=\"groupheader\">Group</div>"; datapane.childNodes[1].appendChild(o); },_h_47:function(){ },_h_49:function(){ },activate:function(){ alert("\u0061\u0032"); }}; var EBAGridBlockSet=Class.create(); EBAGridBlockSet.prototype={initialize:function(_431,_432,_433){ this.height=_432; this.width=_431; this.element=_433; }}; var EBAGridBlock=Class.create(); EBAGridBlock.prototype={initialize:function(_434,_435,_436){ this.height=_435; this.width=_434; this.element=_436; }}; var EBAGridEditorFactory=Class.create(); EBAGridEditorFactory.prototype={initialize:function(){ this.editors=[]; },getEditor:function(_437,cell,_439,_43a,_43b,_43c){ var _43d=null; if(null==cell){ ebaErrorReport("g\u0065\u0074\u0045d\u0069\u0074or: c\u0065l\u006c\u0020par\u0061\u006d\u0065t\u0065\u0072\u0020\u0069\u0073 \u006eu\u006c\u006c","",EBA_DEBUG); return _43d; } var _43e=_439.selectSingleNode("/sta\u0074\u0065\u002fE\u0042AC\u006f\u006c\u0075\u006dns/\u0045B\u0041\u0043o\u006cumn[@x\u0069=\u0027"+cell.getAttribute("\u0063o\u006c")+"'\u005d"); var _43f=_43e.getAttribute("\u0074y\u0070\u0065"); var _440=_43e.getAttribute("t\u0079\u0070\u0065"); if((typeof (_43e)=="\u0075n\u0064\u0065f\u0069\u006e\u0065d")||(false==_EbaTypeToBoolean(_43e.getAttribute("E\u0064\u0069t\u0061b\u006ce"),true))||(false==_EbaTypeToBoolean(_43e.getAttribute("\u0065di\u0074\u0061bl\u0065"),true))){ return _43d; } var _441="\u0045B\u0041\u0047\u0072\u0069d"+_43f+_440+"Ed\u0069\u0074or"; if(this.editors[_441]!=null){ _43d=this.editors[_441]; }else{ switch(_43f){ case "hc\u006d": return null; case "\u0069cm": return null; case "\u004c\u004f\u004fK\u0055\u0050": _43d=new EBALookupEditor(); break; case "L\u0049S\u0054BO\u0058": _43d=new EBAListboxEditor(); break; case "\u0070\u0063m": _43d=new EBAGridPasswordEditor(); break; case "\u0054E\u0058\u0054\u0041RE\u0041": _43d=new EBAGridTextareaEditor(); break; case "C\u0048E\u0043K\u0042\u004f\u0058": _43d=new EBAGridCheckboxEditor(); break; case "\u0062c\u006d": return _43d; break; default: if(_440=="DA\u0054E"){ _43d=new EBAGridDateEditor(); }else{ if(_440=="\u004e\u0055\u004dBER"){ _43d=new EBAGridNumberEditor(); }else{ _43d=new EBAGridTextEditor(); } } break; } } _43d.context=_437; _43d.owner=_437; _43d.bind(cell,_439,_43a,_43b); this.editors[_441]=_43d; return _43d; }}; EBAGridEditorFactory.prototype.dispose=function(){ for(var _442 in this.editors){ this.editors[_442].dispose(); } }; var EBAEditorFactory=new EBAGridEditorFactory(); var EBAGridEditorSuper=Class.create(); EBAGridEditorSuper.prototype={initialize:function(){ this.element=null; this.data=null; this.metadata=null; this.mask=null; this.decimalSeparator="."; this.owner=null; },render:function(){ },activate:function(){ this.owner.getEditable; },_h_40:function(){ var oY=0; var oX=0; if(MOZ){ oY=this.owner.Scroller.scrollSurface.scrollTop-4; oX=this.owner.Scroller.scrollSurface.scrollLeft-4; } ebaErrorReport("\u0072e\u0067ion "+this.owner.Scroller.activeView.region+"o\u0079\u0020\u005b"+oY+"\u005d\u0020\u006fX \u005b"+oX+"\u005d","",EBA_DEBUG); Align(this.control,this.element,286265344,0,0,-oY,-oX); this.control.focus(); if(this.control.createTextRange){ var _445=this.control.createTextRange(); _445.collapse(false); _445.select(); } },align:function(_446){ Align(); },_h_16:function(){ this.element.focus(); },bind:function(_447,_448,_449,_44a){ this.element=_447; this.data=_449; this.metadata=_448; this.mask=null; this.decimalSeparator="\u002e"; var _44b=null; this.control.value=""; if((_44b)&&_44b.getAttribute("\u0066\u006d")){ this.control.nodeValue=_44b.getAttribute("\u0066\u006d"); }else{ if(_44a){ this.control.value=_44a; }else{ var _44c=this.element.getAttribute("c\u006flA\u0074t\u0072"); var _44d=this.data.getTable("_\u0064\u0065\u0066a\u0075\u006c\u0074").xmlDoc.selectSingleNode("\u002f/"+ns+"dat\u0061\u0073o\u0075r\u0063\u0065[@i\u0064\u003d\u0027\u005f\u0064ef\u0061ult']/"+ns+"da\u0074a\u002f"+ns+"\u0065[\u0040\u0078\u0069="+this.element.getAttribute("\u0078\u0069")+"\u005d\u002f"+_44c); if(_44d){ this.control.value=_44d.nodeValue; } } } this.blur=false; },populate:function(){ },_h_75:function(){ },hide:function(){ this.control.style.top=-2000; },handleKey:function(o,e){ var evt=(IE)?event:e; var k=evt.keyCode; switch(k){ case 27: this.control.onblur=null; this.hide(); this.owner.focus(); break; case 9: this._h_16(); var bn=this.owner.Scroller.activeView.ViewNavigator.blockNavigator; if(IE){ evt.keyCode="\u0020"; } var x=1; if(evt.shiftKey){ x=-1; } bn.move(x,0); bn.activeCell.focus(); noBubble(evt); break; case 40: case 38: break; case 13: this._h_16(); evt.returnValue=false; break; default: } },_h_66:function(_454){ this.editCompleteHandler=_454; }}; EBAGridEditorSuper.prototype.dispose=function(){ }; var EBAGridPasswordEditor=Class.create(); EBAGridPasswordEditor.prototype=Extend(new EBAGridEditorSuper(),{initialize:function(){ this.control=document.createElement("\u0069\u006e\u0070\u0075t"); this.control.object=this; this.control.type="pa\u0073s\u0077o\u0072d"; this.control.style.position="\u0061\u0062sol\u0075te"; this.control.style["to\u0070"]=50; this.control.style.left=0; this.mask=null; this.blur=false; this.element=null; this.metadata=null; document.body.appendChild(this.control); },render:function(){ },_h_40:function(){ this.base_h_40(); this.control.onkeydown=function(e){ this.object.handleKey(this,e); }; this.control.onblur=function(e){ this.object._h_16(); }; },_h_16:function(){ if(this.blur){ return; } this.blur=true; var _457=this.control.value; this.element.focus(); if(this.editCompleteHandler!=null){ var _458=new EBAEditCompleteEventArgs(this,"\u002a\u002a**\u002a**",_457); this.editCompleteHandler.call(this.context,_458); } },bind:function(_459,_45a,_45b){ this.blur=false; this.element=_459; this.metadata=_45a; var _45c=this.element.getAttribute("colA\u0074\u0074r"); var _45d=this.metadata.selectSingleNode("//"+ns+"\u0064\u0061t\u0061s\u006fu\u0072\u0063e\u005b@\u0069d=\u0027\u005fd\u0065fa\u0075\u006c\u0074'\u005d\u002f"+ns+"\u0064a\u0074a/"+ns+"\u0065\u005b\u0040xi="+this.element.getAttribute("\u0078i")+"]/"+_45c); if(_45d){ this.control.value=_45d.nodeValue; } if(_45b){ this.control.value=_45b; } },populate:function(){ },_h_75:function(){ },_h_3:function(){ }}); var EBAGridCheckboxEditor=Class.create(); EBAGridCheckboxEditor.prototype=Extend(new EBAGridEditorSuper(),{initialize:function(){ this.element=null; this.metadata=null; },render:function(){ },_h_40:function(){ if(false==eval(this.owner.getOnCellValidateEvent())){ return; } this.toggle(); this._h_16(); },_h_16:function(){ if(this.editCompleteHandler!=null){ var _45e=new EBAEditCompleteEventArgs(this,this.element.innerHTML,this.element.value); this.editCompleteHandler.call(this.context,_45e); } this.element.focus(); this.context=null; },toggle:function(){ this.element.value=parseInt(this.element.value); var _45f=(this.element.value==0)?1:0; var _460=this.metadata.selectSingleNode("\u002fs\u0074ate/E\u0042A\u0053pr\u0065\u0061d\u0073\u0068\u0065\u0065t/EBACol\u0075m\u006es\u002fEB\u0041\u0043olu\u006d\u006e[@x\u0069\u003d\u0027"+this.element.getAttribute("c\u006fl")+"\u0027\u005d"); var _461=this.metadata.selectSingleNode("\u002f\u002f"+ns+"\u0064atas\u006f\u0075r\u0063\u0065[\u0040\u0069d='"+_460.getAttribute("ds\u002d\u0069d")+"\u0027\u005d/"+ns+"data/*["+_460.getAttribute("vf")+"=\u0027"+_45f+"'\u005d"); var _462=_461.getAttribute(_460.getAttribute("df").substring(1)); var _463=(_45f==0)?"u\u006ech\u0065\u0063\u006b\u0065\u0064":"\u0063\u0068ec\u006b\u0065d"; var _464="<div style=\"overflow:hidden;\"><span class=\"checkbox"+_463+"\" checked=\""+_45f+"\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>"+_EbaHtmlEncode(_462)+"\u003c/\u0073\u0070\u0061n\u003e</d\u0069\u0076\u003e"; var _465=this.element.onclick; this.element.innerHTML=_464; this.element.value=_45f; },bind:function(_466,_467){ this.element=_466; var This=this; this.metadata=_467; if(!this.element.value||this.element.value==""){ this.element.value=0; } },populate:function(){ },_h_75:function(){ },hide:function(){ },_h_3:function(){ }}); var EBAGridTextareaEditor=Class.create(); EBAGridTextareaEditor.prototype=Extend(new EBAGridEditorSuper(),{initialize:function(){ this.control=document.createElement("\u0074\u0065\u0078\u0074a\u0072\u0065\u0061"); this.control.style.position="abso\u006cut\u0065"; this.control.style["t\u006f\u0070"]=-2000; this.control.style.left=-2000; this.control.object=this; document.body.appendChild(this.control); this.blur=false; this.element=null; this.metadata=null; },_h_40:function(){ this.base_h_40(); this.control.onkeydown=function(e){ this.object.handleKey(this,e); }; this.control.onblur=function(e){ this.object._h_16(); }; },render:function(){ },_h_3:function(){ },_h_16:function(){ if(this.blur){ return; } this.blur=true; var _46b=this.control.value; var _46b=this.control.value; var _46c=null; if(_46b.substr(0,1)=="="){ _46c={"\u0066\u006d":_46b}; _46b=""; }else{ _46c={"f\u006d":""}; } this.element.focus(); if(this.editCompleteHandler!=null){ var _46d=new EBAEditCompleteEventArgs(this,_EbaHtmlEncode(_46b),_46b,_46c); this.editCompleteHandler.call(this.context,_46d); } },populate:function(){ },_h_75:function(){ },handleKey:function(o,e){ var evt=(IE)?event:e; var k=evt.keyCode; switch(k){ case 40: break; case 38: break; case 37: break; case 39: break; case 13: evt.cancelBubble=true; evt.returnValue=false; if(IE){ evt.keyCode=32; } if(!evt.shiftKey){ if(MOZ){ var _472=document.createEvent("Ke\u0079E\u0076en\u0074s"); _472.initKeyEvent("\u006b\u0065ydown",true,true,document.defaultView,evt.ctrlKey,evt.altKey,evt.shiftKey,evt.metaKey,0,32); evt.target.dispatchEvent(_472); } this._h_16(); }else{ if(MOZ){ var _472=document.createEvent("\u004b\u0065y\u0045\u0076e\u006e\u0074s"); _472.initKeyEvent("ke\u0079\u0070r\u0065\u0073\u0073",true,true,document.defaultView,evt.ctrlKey,evt.altKey,evt.shiftKey,evt.metaKey,13,0); this.control.dispatchEvent(_472); } if(this.control.createTextRange){ this.control.focus(); var _473=document.selection.createRange(); _473.text="\n"; _473.collapse(false); _473.select(); } } break; case 9: break; case 27: this.control.onblur=null; this.hide(); break; default: } }}); EBAGridTextareaEditor.prototype.dispose=function(){ this.control.object=null; this.control.onkeydown=null; this.control.onblur=null; this.control=null; this.element=null; this.metadata=null; this.owner=null; }; var EBAGridDateEditor=Class.create(); EBAGridDateEditor.prototype=Extend(new EBAGridEditorSuper(),{initialize:function(){ this.control=document.createElement("\u0069\u006e\u0070u\u0074"); this.control.object=this; this.control.style.position="\u0061\u0062\u0073olut\u0065"; this.control.style["to\u0070"]=50; this.control.style.left=0; document.body.appendChild(this.control); this.blur=false; this.element=null; this.metadata=null; this.mask="MM\u004d\u0020\u0064\u002c y\u0079"; this.dateXsl=IE?new ActiveXObject("Msxm\u006c2.\u0044\u004f\u004dDocume\u006e\u0074.3\u002e\u0030"):document.implementation.createDocument("","",null); this.dateXsl.async=false; this.dateXsl.load(gResourcePath+"\u0078s\u006c/d\u0061teEdi\u0074o\u0072\u002e\u0078slt"); },_h_40:function(){ this.base_h_40(); this.control.onkeydown=function(e){ this.object.handleKey(this,e); }; this.control.onblur=function(e){ this.object._h_16(); }; },_h_3:function(val){ var _477=Eba.Xml.createXmlDoc(); _477.loadXML("\u003cr\u006f\u006ft><d\u0061\u0074\u0065>"+val+"\u003c\u002f\u0064at\u0065\u003e<\u006d\u0061\u0073\u006b>"+this.mask+"\u003c/ma\u0073k>\u003c/ro\u006ft>"); var _478=Eba.Xml.transformToString(_477,this.dateXsl); _477=null; return _478; },bind:function(_479,_47a,data,_47c){ this.blur=false; var _47d=_47a.selectSingleNode("/\u0073t\u0061te/E\u0042\u0041\u0043olumns\u002f\u0045\u0042A\u0043\u006flu\u006dn[\u0040xi\u003d'"+_479.getAttribute("col")+"\u0027\u005d"); this.mask=_47d.getAttribute("mas\u006b")||"MM\u004d\u0020d, \u0079y"; this.decimalSeparator=_47d.getAttribute("ds")||"."; this.groupingSeparator=_47d.getAttribute("\u0067\u0073")||"\u002c"; this.element=_479; this.metadata=_47a; this.control.value=""; if((_47d)&&_47d.getAttribute("\u0066m")){ this.control.nodeValue=_47d.getAttribute("\u0066m"); }else{ if(_47c){ this.control.value=_47c; }else{ var _47e=this.element.getAttribute("c\u006f\u006cA\u0074\u0074r"); var _47f=data.getTable("_\u0064\u0065\u0066au\u006c\u0074").xmlDoc.selectSingleNode("//"+ns+"\u0064a\u0074\u0061\u0073\u006f\u0075\u0072\u0063\u0065[\u0040id\u003d'\u005fd\u0065fault'\u005d/"+ns+"d\u0061ta\u002f"+ns+"e[\u0040\u0078i\u003d"+this.element.getAttribute("x\u0069")+"\u005d\u002f"+_47e); if(_47f){ this.control.value=_47f.nodeValue; } } } },_h_16:function(){ if(this.blur){ return; } this.blur=true; var _480={"fm":""}; var _481=this.control.value; if(""==this._h_3(_481)){ _481=this.element.getAttribute("\u0076alu\u0065"); ebaErrorReport("\u005b"+this.control.value+"\u005d\u0020\u0069\u0073\u0020\u006e\u006ft a \u0076\u0061\u006c\u0069d dat\u0065\u002e Only\u0020a valid\u0020\u0064ate\u0020\u0073\u0075\u0063h\u0020\u0061s\u0020\u0027200\u0036\u002d12\u002d05'\u0020\u0063a\u006e \u0062\u0065 e\u006e\u0074\u0065r\u0065d in \u0074\u0068\u0069s\u0020ce\u006cl.","",EBA_ERROR); } var _482=this._h_3(_481); this.element.focus(); if(this.editCompleteHandler!=null){ var _483=new EBAEditCompleteEventArgs(this,_EbaHtmlEncode(_482),_481,_480); this.editCompleteHandler.call(this.context,_483); } },populate:function(){ },_h_75:function(){ }}); EBAGridDateEditor.prototype.dispose=function(){ this.control.object=null; this.control.onkeydown=null; this.control.onblur=null; this.control=null; this.dateXsl=null; this.element=null; this.metadata=null; this.owner=null; this.context=null; }; var EBAGridNumberEditor=Class.create(); EBAGridNumberEditor.prototype=Extend(new EBAGridEditorSuper(),{initialize:function(){ this.control=document.createElement("i\u006eput"); this.control.object=this; document.body.appendChild(this.control); this.control.style.position="a\u0062\u0073\u006f\u006cut\u0065"; this.control.style["to\u0070"]=50; this.control.style.left=0; this.control.onkeydown=function(e){ this.object.handleKey(this,e); }; this.control.onblur=function(e){ this.object._h_16(); }; this.mask="#\u002c#\u00300\u002e00"; this.decimalSeparator="\u002e"; this.groupingSeparator=","; this.blur=false; this.element=null; this.metadata=null; this.numberXsl=Eba.Xml.createXslDoc(); this.numberXsl.async=false; this.numberXsl.load(gResourcePath+"\u0078\u0073l\u002f\u006e\u0075mbe\u0072\u0045d\u0069t\u006f\u0072.xs\u006ct"); this.xmlDoc=Eba.Xml.createXmlDoc(); this.xmlDoc.async=false; },_h_3:function(val){ this.xmlDoc.loadXML("\u003cr\u006f\u006ft><n\u0075mb\u0065r\u003e"+val+"<\u002f\u006eumbe\u0072><ma\u0073\u006b\u003e"+this.mask+"\u003c\u002fma\u0073\u006b><g\u0072o\u0075p>"+this.groupingSeparator+"\u003c\u002fgr\u006fup><\u0064\u0065\u0063\u0069\u006d\u0061l>"+this.decimalSeparator+"<\u002fd\u0065c\u0069ma\u006c\u003e\u003c/root>"); var _487=Eba.Xml.transformToString(this.xmlDoc,this.numberXsl); return _487; xmlDoc=null; },_h_16:function(){ if(this.blur){ return; } this.blur=true; var _488=this.control.value; if("\u004eaN"==this._h_3(_488)){ _488=this.element.getAttribute("val\u0075\u0065"); ebaErrorReport("\u005b"+this.control.value+"]\u0020i\u0073 no\u0074\u0020\u0061\u0020\u0076ali\u0064\u0020\u006eu\u006d\u0062er\u002e O\u006e\u006c\u0079 \u0061\u0020va\u006c\u0069\u0064\u0020\u006e\u0075mb\u0065r\u0020such \u0061\u0073\u0020'15\u00300\u0027 ca\u006e\u0020be\u0020\u0065n\u0074\u0065red i\u006e t\u0068\u0069\u0073\u0020\u0063\u0065ll\u002e","",EBA_ERROR); } var _489=this._h_3(_488); var _48a={"\u0066\u006d":""}; if(this.control.value.substr(0,1)=="\u003d"){ _48a={"fm":this.control.value}; _488=""; _489=""; } this.element.focus(); if(this.editCompleteHandler!=null){ var _48b=new EBAEditCompleteEventArgs(this,_489,_488,_48a); this.editCompleteHandler.call(this.context,_48b); } },bind:function(_48c,_48d,data,_48f){ this.blur=false; var _490=_48d.selectSingleNode("/\u0073\u0074\u0061\u0074e\u002f\u0045\u0042A\u0043o\u006c\u0075m\u006e\u0073/E\u0042\u0041\u0043\u006flumn\u005b@\u0078i='"+_48c.getAttribute("col")+"\u0027]"); this.mask=_490.getAttribute("m\u0061s\u006b")||"\u0023\u002c#00.0\u0030"; this.element=_48c; this.metadata=_48d; this.control.value=""; if((_490)&&_490.getAttribute("\u0066\u006d")){ this.control.nodeValue=_490.getAttribute("\u0066m"); }else{ if(_48f){ this.control.value=_48f; }else{ var _491=_490.getAttribute("\u0078\u0064\u0061t\u0061fld"); var _492=data.getTable("\u005f\u0064e\u0066\u0061\u0075\u006ct").xmlDoc.selectSingleNode("/\u002f"+ns+"\u0064\u0061ta\u0073\u006fur\u0063\u0065\u005b@id=\u0027\u005fde\u0066\u0061\u0075\u006ct'\u005d\u002f"+ns+"d\u0061\u0074\u0061\u002f"+ns+"e\u005b@\u0078i="+this.element.getAttribute("xi")+"]\u002f"+_491); if(_492){ this.control.value=_492.nodeValue; } } } },populate:function(){ },_h_75:function(){ }}); EBAGridNumberEditor.prototype.dispose=function(){ this.control.object=null; this.control.onkeydown=null; this.control.onblur=null; this.control=null; this.element=null; this.metadata=null; this.owner=null; this.context=null; }; var EBAGridTextEditor=Class.create(); EBAGridTextEditor.prototype=Extend(new EBAGridEditorSuper(),{initialize:function(){ this.control=document.createElement("i\u006eput"); this.control.object=this; this.control.style.position="a\u0062so\u006c\u0075\u0074\u0065"; this.control.style["t\u006f\u0070"]=50; this.control.style.left=0; this.control.className="eba\u0069\u006e\u0070u\u0074"; document.body.appendChild(this.control); this.blur=false; this.element=null; this.metadata=null; this.owner=null; },_h_3:function(){ },_h_40:function(){ this.base_h_40(); this.control.onkeydown=function(e){ this.object.handleKey(this,e); }; this.control.onblur=function(e){ this.object._h_16(); }; },_h_16:function(){ if(this.blur){ return; } this.blur=true; var _495=this.control.value; var _496={"\u0066\u006d":""}; if(_495.substr(0,1)=="="){ _496={"\u0066m":_495}; _495=""; } this.element.focus(); if(this.editCompleteHandler!=null){ var _497=new EBAEditCompleteEventArgs(this,_495,_495,_496); this.editCompleteHandler.call(this.owner,_497); } },populate:function(){ },_h_75:function(){ }}); EBAGridTextEditor.prototype.dispose=function(){ this.control.object=null; this.control=null; this.element=null; this.metadata=null; this.owner=null; this.context=null; }; var EBAListboxEditor=Class.create(); EBAListboxEditor.prototype=Extend(new EBAGridEditorSuper(),{initialize:function(){ this.placeholder=document.createElement("div"); document.body.appendChild(this.placeholder); this.editCompleteHandler=null; this.context=null; this.element=null; this.metadata=null; this.prevValue=""; this.blur=false; },bind:function(_498,_499,data){ this.blur=false; this.element=_498; this.metadata=_499; this.data=data; this.prevValue=this.element.getAttribute("\u0076\u0061\u006cu\u0065"); var _49b=this.metadata.selectSingleNode("/s\u0074ate/\u0045BA\u0043ol\u0075mns\u002f\u0045B\u0041Col\u0075\u006d\u006e[\u0040x\u0069=\u0027"+this.element.getAttribute("\u0063\u006fl")+"']"); this.dataTable=this.data.getTable(_49b.getAttribute("\u0044at\u0061so\u0075\u0072ce\u0049\u0064")); this.bindComplete(); },bindComplete:function(){ var _49c=this.metadata.selectSingleNode("\u002fs\u0074a\u0074e\u002f\u0045B\u0041Co\u006cu\u006dn\u0073/\u0045\u0042\u0041\u0043o\u006cum\u006e\u005b@xi='"+this.element.getAttribute("c\u006fl")+"']"); var _49d=this.data.getTable(_49c.getAttribute("\u0044\u0061t\u0061s\u006fur\u0063\u0065Id")).xmlDoc.selectSingleNode("\u002f\u002f"+ns+"\u0064\u0061t\u0061so\u0075r\u0063e[\u0040\u0069\u0064\u003d\u0027"+_49c.getAttribute("\u0044\u0061ta\u0073ourc\u0065\u0049\u0064")+"\u0027]"); var _49e=_49c.getAttribute("Disp\u006c\u0061y\u0046\u0069e\u006cd\u0073"); var _49f=_49c.getAttribute("\u0056a\u006cu\u0065Fie\u006c\u0064"); listboxXslProc.addParameter("Disp\u006c\u0061\u0079F\u0069el\u0064\u0073",_49e,""); listboxXslProc.addParameter("V\u0061lu\u0065\u0046iel\u0064",_49f,""); listboxXslProc.addParameter("\u0076\u0061l",this.element.getAttribute("val\u0075\u0065"),""); this.listXml=Eba.Xml.transformToXml(Eba.Xml.xmlDocFromString(_49d.xml),listboxXslProc); this.placeholder.innerHTML=this.listXml.xml; this.control=this.placeholder.childNodes[0]; this.control.object=this; this.control.style.position="a\u0062\u0073\u006f\u006cute"; this.control.style["to\u0070"]=-1000; this.control.style.left=-1000; this.control.onkeydown=function(e){ this.object.handleKey(this,e); }; this.control.onblur=function(e){ if(this.object!=null){ this.object._h_16(); } }; this.control.className=this.element.className; var oY=0; var oX=0; if(MOZ){ if(this.context.Scroller.activeView.region==3||this.context.Scroller.activeView.region==4){ oY=this.context.Scroller.scrollSurface.scrollTop; } if(this.context.Scroller.activeView.region==1||this.context.Scroller.activeView.region==4){ oX=this.context.Scroller.scrollSurface.scrollLeft; } } Align(this.control,this.element,286265344,0,0,-oY,-oX); this.control.focus(); if(this.control.createTextRange){ var _4a4=this.control.createTextRange(); _4a4.collapse(false); _4a4.select(); } },render:function(){ },_h_40:function(){ },align:function(_4a5){ Align(); },_h_16:function(ok){ if(this.blur||this.selectClicked){ this.selectClicked=false; return; } this.blur=true; var c=this.control; var text="",value=""; if(ok||ok==null){ text=c.options[c.selectedIndex].text; value=c.options[c.selectedIndex].value; }else{ value=this.prevValue; var len=c.options.length; for(var i=0;i<len;i++){ if(c.options[i].value==value){ text=c.options[i].text; } } } c.object=null; this.element.focus(); if(this.editCompleteHandler!=null){ var _4ab=new EBAEditCompleteEventArgs(this,_EbaHtmlEncode(text),value); _4ab.status=(value==this.prevValue?false:true); this.editCompleteHandler.call(this.context,_4ab); } },populate:function(){ },_h_75:function(){ },handleKey:function(o,e){ var evt=(IE)?event:e; var k=evt.keyCode; switch(k){ case 27: this._h_16(false); break; case 40: case 38: evt.cancelBubble=true; return false; case 37: case 39: case 13: case 27: this._h_16(true); break; default: } }}); EBAListboxEditor.prototype.dispose=function(){ this.placeholder=null; this.control.object=null; this.control.onkeydown=null; this.control.onblur=null; this.control=null; this.listXml=null; this.element=null; this.metadata=null; this.owner=null; }; var EBALookupEditor=Class.create(); EBALookupEditor.prototype=Extend(new EBAGridEditorSuper(),{initialize:function(){ this.selectClicked=false; this.bVisible=false; this.placeholder=document.createElement("\u0073\u0070an"); this.placeholder.object=this; this.placeholder.setAttribute("\u0069\u0064","l\u006f\u006fku\u0070\u005f\u0073pan"); this.placeholder.style.position="abso\u006cu\u0074\u0065"; this.placeholder.style.zIndex=10; this.placeholder.style["\u0074op"]=-2000; this.placeholder.style.left=-2000; document.body.appendChild(this.placeholder); this.textcontrol=document.createElement("in\u0070\u0075\u0074"); this.textcontrol.object=this; this.placeholder.appendChild(this.textcontrol); this.textcontrol.onkeydown=function(e){ this.object.handleKey(this,e); }; this.textcontrol.onkeyup=function(e){ this.object.filter(this,e); }; this.textcontrol.onblur=function(e){ this.object._h_16(true); }; this.placeholder.appendChild(document.createElement("sp\u0061\u006e")); this.blur=false; this.element=null; this.metadata=null; this.data=null; this.listXml=null; this.listXmlLower=null; this.editCompleteHandler=null; this.owner=null; var xsl="<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\">"; xsl+="<xsl:output method=\"text\" version=\"4.0\"/><xsl:param name='srchVal'/>"; xsl+="<xsl:template match=\"/\">"+"\u003cx\u0073\u006c\u003aa\u0070p\u006c\u0079\u002dt\u0065m\u0070\u006ca\u0074es \u0073\u0065l\u0065c\u0074\u003d\u0027//\u006fp\u0074\u0069o\u006e\u005b\u0073t\u0061\u0072t\u0073\u002d\u0077i\u0074h\u0028.\u002c\u0024\u0073\u0072\u0063h\u0056a\u006c\u0029\u005d[1]\u0027\u0020\u002f>"+"<\u002fxs\u006c:t\u0065m\u0070lat\u0065\u003e"; xsl+="<xsl:template match=\"option\">"; xsl+="\u003cxs\u006c\u003avalu\u0065\u002do\u0066 \u0073\u0065l\u0065\u0063t\u003d\u0027@\u0072n' \u002f\u003e"+"\u003c/\u0078\u0073\u006c:\u0074\u0065\u006d\u0070\u006cat\u0065\u003e"+"<\u002fxs\u006c:\u0073tyl\u0065\u0073\u0068e\u0065\u0074>"; var _4b4=Eba.Xml.createXslDoc(xsl); this.searchXslProc=Eba.Xml.createXslProcessor(_4b4); _4b4=null; },_h_40:function(){ },_h_3:function(){ },_h_16:function(ok){ if(this.blur){ return; } this.blur=true; var sc=this.selectcontrol; var tc=this.textcontrol; var text="",value=""; if(ok||ok==null){ if(sc.selectedIndex>=0){ value=sc.options[sc.selectedIndex].value; text=sc.options[sc.selectedIndex].text; }else{ value=tc.value; text=value; } }else{ value=this.prevValue; var len=sc.options.length; for(var i=0;i<len;i++){ if(sc.options[i].value==value){ text=sc.options[i].text; } } } this.element.focus(); sc.object=null; sc=null; if(tc.value.substr(0,1)=="\u003d"){ cellMetadata={"f\u006d":tc.value}; value=""; }else{ cellMetadata={"\u0066m":""}; } if(this.editCompleteHandler!=null){ var _4bb=new EBAEditCompleteEventArgs(this,_EbaHtmlEncode(text),value,cellMetadata); _4bb.status=ok||true; this.editCompleteHandler.call(this.owner,_4bb); } },hide:function(){ this.placeholder.style.top=-2000; },_h_27:function(){ this.selectcontrol.style.display="n\u006fne"; this.bVisible=false; },bind:function(_4bc,_4bd,data,_4bf){ this.blur=false; this.element=_4bc; this.metadata=_4bd; this.data=data; this.prevValue=this.element.getAttribute("va\u006c\u0075e"); var _4c0=this.metadata.selectSingleNode("\u002f\u0073t\u0061te/\u0045\u0042ACo\u006c\u0075mns\u002fEBA\u0043\u006fl\u0075\u006d\u006e\u005b@xi\u003d\u0027"+this.element.getAttribute("co\u006c")+"\u0027]"); var _4c1=this.data.getTable(_4c0.getAttribute("D\u0061\u0074aso\u0075r\u0063\u0065\u0049d")); this.dataTable=_4c1; if(this.dataTable.getHandler){ this.dataTable=new Eba.TableDataSource("\u0074empD\u0061\u0074a\u0053o\u0075r\u0063e",_4c1.getHandler,null); if(_4bf){ this.dataTable.setGetHandlerParameter("Sea\u0072c\u0068\u0053\u0074\u0072\u0069ng",_4bf); } this.dataTable.get(null,null,this,Eba.closeLater(this,this.bindComplete,[_4bf])); }else{ this.bindComplete(_4bf); } },bindComplete:function(_4c2){ var _4c3=this.metadata.selectSingleNode("/s\u0074\u0061te\u002f\u0045B\u0041\u0043\u006fl\u0075mns/E\u0042AColu\u006d\u006e\u005b\u0040\u0078\u0069='"+this.element.getAttribute("co\u006c")+"\u0027]"); var _4c4=this.dataTable.xmlDoc.selectSingleNode("/\u002f"+ns+"\u0064ata\u0073\u006f\u0075r\u0063\u0065"); var _4c5=_4c3.getAttribute("Dis\u0070\u006c\u0061\u0079\u0046i\u0065ld\u0073"); var _4c6=_4c3.getAttribute("\u0056\u0061l\u0075eF\u0069eld"); listboxXslProc.addParameter("Disp\u006c\u0061\u0079F\u0069eld\u0073",_4c5,""); listboxXslProc.addParameter("\u0056\u0061l\u0075\u0065Field",_4c6,""); listboxXslProc.addParameter("\u0076\u0061\u006c",_EbaConstructValidXpathQuery(this.element.getAttribute("\u0076alu\u0065"),false),""); this.listXml=Eba.Xml.transformToXml(Eba.Xml.xmlDocFromString(_4c4.xml),listboxXslProc); this.listXmlLower=Eba.Xml.xmlDocFromString(this.listXml.xml.toLowerCase()); this.placeholder.childNodes[1].innerHTML=this.listXml.xml; this.selectcontrol=this.placeholder.childNodes[1].firstChild; this.selectcontrol.object=this; this.selectcontrol.style.display="n\u006f\u006ee"; this.selectcontrol.size=4; this.selectcontrol.onmousedown=function(){ this.object.selectClicked=true; }; this.selectcontrol.onclick=function(){ this.object.textcontrol.value=this.options[this.selectedIndex].text; this.object._h_27(); this.object.textcontrol.focus(); }; this.selectClicked=false; this.bVisible=false; if(typeof (_4c2)!="u\u006e\u0064ef\u0069ne\u0064"&&_4c2!=""){ this.textcontrol.value=_4c2; var rn=this.search(_4c2); this.selectcontrol.selectedIndex=parseInt(rn)-1; xbPutCur(this.textcontrol,1); }else{ var row=_4c4.selectSingleNode("//"+ns+"e\u005b@"+_4c6+"=\u0027"+this.element.getAttribute("\u0076\u0061l\u0075e")+"']"); if(row!=null){ this.textcontrol.value=row.getAttribute(_4c5); var rn=this.search(this.textcontrol.value); this.selectcontrol.selectedIndex=parseInt(rn)-1; }else{ this.textcontrol.value=this.element.getAttribute("v\u0061lue"); this.selectcontrol.selectedIndex=-1; } } this.textcontrol.setAttribute("cla\u0073\u0073\u004ea\u006d\u0065",this.element.getAttribute("c\u006cass\u004e\u0061\u006d\u0065")); var oY=0; var oX=0; if(MOZ){ if(this.owner.Scroller.activeView.region==3||this.owner.Scroller.activeView.region==4){ oY=this.owner.Scroller.scrollSurface.scrollTop; } if(this.owner.Scroller.activeView.region==1||this.owner.Scroller.activeView.region==4){ oX=this.owner.Scroller.scrollSurface.scrollLeft; } } Align(this.placeholder,this.element,286265344,0,0,-oY,-oX); var _4cb=this.placeholder.clientWidth; this.selectcontrol.style.width=_4cb; this.selectcontrol.style.display="in\u006ci\u006e\u0065"; this.textcontrol.style.width=_4cb; this.textcontrol.focus(); },populate:function(){ },_h_75:function(){ },handleKey:function(o,e){ var evt=(IE)?event:e; var k=evt.keyCode; var tc=this.textcontrol; var sc=this.selectcontrol; if(k==27){ this._h_16(false); return; } if(evt.ctrlKey&&k==86){ return; } if(evt.ctrlKey){ return; } switch(k){ case 9: this._h_16(true); break; case 13: evt.returnValue=false; evt.cancelBubble=true; if(IE){ evt.keyCode=32; }else{ evt.preventDefault(); evt.stopPropagation(); var _4d2=document.createEvent("\u004b\u0065\u0079\u0045ve\u006ets"); _4d2.initKeyEvent("\u006b\u0065\u0079\u0064own",true,true,document.defaultView,evt.ctrlKey,evt.altKey,evt.shiftKey,evt.metaKey,0,32); evt.target.dispatchEvent(_4d2); } this._h_16(true); break; default: if(!this.bVisible){ sc.style.display="inl\u0069\u006ee"; } } },search:function(_4d3){ _4d3=_EbaConstructValidXpathQuery(_4d3,false); this.searchXslProc.addParameter("\u0073\u0072ch\u0056a\u006c",_4d3.toLowerCase(),""); var _4d4=Eba.Xml.transformToString(this.listXmlLower,this.searchXslProc); window.status=_4d4; if(""==_4d4){ _4d4=0; }else{ _4d4=parseInt(_4d4); } return _4d4; },filter:function(o,e){ var evt=(IE)?event:e; var k=evt.keyCode; var tc=this.textcontrol; var sc=this.selectcontrol; switch(k){ case 38: if(sc.selectedIndex==-1){ sc.selectedIndex=0; } if(sc.selectedIndex>0){ sc.selectedIndex--; } tc.value=sc.options[sc.selectedIndex].text; xbHighlight(tc,tc.value.length); tc.select(); break; case 40: if(sc.selectedIndex<(sc.length-1)){ sc.selectedIndex++; } tc.value=sc.options[sc.selectedIndex].text; xbHighlight(tc,tc.value.length); tc.select(); break; default: var _4db=tc.value; if(this.dataTable.getHandler){ } lineno=this.search(_4db); if(lineno>0&&k!=8&&k!=46&&(k<188&&k>46)){ sc.selectedIndex=lineno-1; tc.value=sc[sc.selectedIndex].text; xbHighlight(tc,tc.value.length-(tc.value.length-_4db.length)); }else{ sc.selectedIndex=-1; } } }}); EBALookupEditor.prototype.dispose=function(){ this.placeholder.object=null; this.placeholder=null; this.textcontrol.object=null; this.textcontrol.onkeydown=null; this.textcontrol.onkeyup=null; this.textcontrol.onblur=null; this.textcontrol=null; this.element=null; this.metadata=null; this.owner=null; }; var EBAGridFormulaEditor=Class.create(); EBAGridFormulaEditor.prototype=Extend(new EBAGridEditorSuper(),{initialize:function(){ this.control=document.createElement("\u0069np\u0075\u0074"); this.control.object=this; document.body.appendChild(this.control); this.control.style.position="\u0072\u0065l\u0061ti\u0076\u0065"; this.control.style["\u0074op"]=50; this.control.style.left=0; this.control.onkeydown=function(e){ this.object.handleKey(this,e); }; this.control.onblur=function(e){ this.object._h_16(); }; this.mask=null; this.decimalSeparator="."; },_h_3:function(){ xVal=xVal.replace(/[^0-9a-z\.-]/g,""); xVal=maskedToNumber(xVal,this.decimalSeparator)+""; },_h_16:function(){ var _4de=this.control.value; if(this.editCompleteHandler!=null){ var _4df=new EBAEditCompleteEventArgs(this,_4de,_4de,{"\u0066m":_4de}); this.editCompleteHandler.call(this.context,_4df); } this.fromElement.focus(); },bind:function(){ },populate:function(){ },_h_75:function(){ }}); var EBAEditCompleteEventArgs=Class.create(); EBAEditCompleteEventArgs.prototype={initialize:function(obj,_4e1,_h_75,_4e2){ this.editor=obj; this.cell=obj.element; this.databaseValue=_h_75; this.displayValue=_4e1; this.metadata=_4e2; this.status="\u006fk"; this.path="/"; this.column=""; this.row=""; this.source=""; }}; EBAEditCompleteEventArgs.prototype.dispose=function(){ this.editor=null; this.cell=null; this.metadata=null; }; function _GLKeyDown(){ this.shift=(event.keyCode.valueOf()==16?true:false); gEsc=(event.keyCode.valueOf()==27); var This=_GLGrid(event.srcElement); gEsc=(gEsc&&!This.forceValidate); var kv=event.keyCode.valueOf(); if(This.active=="\u0041"){ if(kv==13){ This._h_21(); } return; } This.Key(kv); } function _GLKeyUp(){ this.shift=(event.keyCode.valueOf()==16?false:true); } function _GLKeyPress(){ if(event.keyCode==13){ if(_GLGrid(event.srcElement).textCell.style.display!="b\u006coc\u006b"&&!event.shiftKey){ event.keyCode=27; } } } function _GLMouseWheel(){ var This=_GLGrid(event.srcElement); if(This.rowCount()>0){ This._h_21(); } } var EBABlockNode=Class.create(); EBABlockNode.prototype={initialize:function(low,high,size,_4e9,_4ea){ this.size=size; this.units=_4e9; this.element=_4ea; this.low=low; this.high=high; this.next=null; this.prev=null; },isIn:function(val){ return ((val>=this.low)&&(val<=this.high)); },_h_38:function(){ var next=this.next; if(next!=null&&next.low<=this.high+1){ this.high=Math.max(this.high,next.high); this.low=Math.min(this.low,next.low); var _4ed=next.next; this.next=_4ed; if(_4ed!=null){ _4ed.prev=this; } next.clear(); return true; }else{ return false; } },clear:function(){ this.next=null; this.prev=null; },toString:function(){ return "\u005b"+this.low+"\u002c"+this.high+"]"; }}; var EBAHeightMap=Class.create(); EBAHeightMap.prototype={initialize:function(size,_4ef,_4f0){ this.size=size; this.units=_4ef; this.element=_4f0; this.head=null; this.tail=null; this.debug=new Array(); },insert:function(low,high){ this.debug.push("\u0069\u006e\u0073er\u0074\u0028"+low+"\u002c"+high+")"); var _4f3=new CacheNode(low,high); if(this.head==null){ this.debug.push("\u0065\u006d\u0070\u0074\u0079 \u0063\u0061ch\u0065\u002c\u0020\u0061ddi\u006eg\u0020f\u0069\u0072s\u0074\u0020\u006e\u006f\u0064\u0065"); this.head=_4f3; this.tail=_4f3; }else{ var n=this.head; while(n!=null&&low>n.high+1){ n=n.next; } if(n==null){ this.debug.push("\u0061\u0070pe\u006ed\u0069ng \u006eode\u0020\u0074o e\u006ed"); this.tail.next=_4f3; _4f3.prev=this.tail; this.tail=_4f3; }else{ this.debug.push("\u0069nse\u0072t\u0069n\u0067 new n\u006f\u0064\u0065\u0020bef\u006f\u0072\u0065\u0020"+n.toString()); if(n.prev!=null){ _4f3.prev=n.prev; n.prev.next=_4f3; } _4f3.next=n; n.prev=_4f3; while(_4f3._h_38()){ } if(_4f3.prev==null){ this.head=_4f3; } if(_4f3.next==null){ this.tail=_4f3; } } } },_h_22:function(low,high){ var g=new Array(); var n=this.head; if(this.head==null||this.head.low>high||this.tail.high<low){ g.push(new Range(low,high)); return g; } var _4f9=0; while(n!=null&&n.high<low){ _4f9=n.high+1; n=n.next; } if(n!=null){ do{ if(g.length==0){ if(low<n.low){ g.push(new Range(Math.max(low,_4f9),Math.min(n.low-1,high))); } } if(high>n.high){ if(n.next==null||n.next.low>high){ g.push(new Range(n.high+1,high)); }else{ g.push(new Range(n.high+1,n.next.low-1)); } } n=n.next; }while(n!=null&&n.high<high); }else{ g.push(new Range(this.tail.high+1,high)); } return g; },_h_23:function(low,high){ var gs=this._h_22(low,high); var a=new Array(); for(var i=0;i<gs.length;i++){ a.push(gs[i].toString()); } return a.join(","); },search:function(low,high){ },toString:function(){ var n=this.head; var s=new Array(); while(n!=null){ s.push(n.toString()); n=n.next; } return s.join(","); },_h_18:function(){ return this.debug.join("\u003c\u0042\u0052\u003e"); }}; var Rect=Class.create(); Rect.prototype={initialize:function(t,r,b,l){ this.top=t; this.right=r; this.bottom=b; this.left=l; }}; var Scrollbar=Class.create(); Scrollbar.prototype={initialize:function(_507,_508){ this.scrollTop=0; }}; var Range=Class.create(); Range.prototype={initialize:function(low,high){ this.low=low; this.high=high; },isIn:function(val){ return ((val>=this.low)&&(val<=this.high)); },toString:function(){ return "["+this.low+","+this.high+"\u005d"; }}; var CacheNode=Class.create(); CacheNode.prototype={initialize:function(low,high){ this.low=low; this.high=high; this.next=null; this.prev=null; },isIn:function(val){ return ((val>=this.low)&&(val<=this.high)); },_h_38:function(){ var next=this.next; if(next!=null&&next.low<=this.high+1){ this.high=Math.max(this.high,next.high); this.low=Math.min(this.low,next.low); var _510=next.next; this.next=_510; if(_510!=null){ _510.prev=this; } next.clear(); return true; }else{ return false; } },clear:function(){ this.next=null; this.prev=null; },toString:function(){ return "["+this.low+"\u002c"+this.high+"\u005d"; }}; var CacheMap=Class.create(); CacheMap.prototype={initialize:function(){ this.head=null; this.tail=null; this.debug=new Array(); },insert:function(low,high){ low=Number(low); high=Number(high); this.debug.push("\u0069ns\u0065r\u0074("+low+","+high+"\u0029"); var _513=new CacheNode(low,high); if(this.head==null){ this.debug.push("e\u006d\u0070ty c\u0061\u0063\u0068e,\u0020\u0061\u0064din\u0067 f\u0069\u0072st\u0020node"); this.head=_513; this.tail=_513; }else{ var n=this.head; while(n!=null&&low>n.high+1){ n=n.next; } if(n==null){ this.debug.push("\u0061p\u0070\u0065n\u0064in\u0067\u0020n\u006f\u0064e\u0020to\u0020en\u0064"); this.tail.next=_513; _513.prev=this.tail; this.tail=_513; }else{ this.debug.push("\u0069\u006e\u0073\u0065rtin\u0067 \u006ee\u0077 \u006e\u006f\u0064e b\u0065fo\u0072\u0065 "+n.toString()); if(n.prev!=null){ _513.prev=n.prev; n.prev.next=_513; } _513.next=n; n.prev=_513; while(_513._h_38()){ } if(_513.prev==null){ this.head=_513; } if(_513.next==null){ this.tail=_513; } } } },remove:function(low,high){ low=Number(low); high=Number(high); this.debug.push("inse\u0072t("+low+"\u002c"+high+"\u0029"); if(this.head==null){ }else{ var _517=this.head; while(_517!=null&&low>_517.high){ _517=_517.next; } if(_517==null){ this.debug.push("t\u0068e \u0072an\u0067e wa\u0073 \u006eot f\u006f\u0075n\u0064"); }else{ var end=_517; if(_517.next!=null&&high>_517.next.low){ end=_517.next; var temp=null; while(end!=null&&high>end.high){ temp=end.next; this.removeNode(end); end=temp; } _517.next=null; _517.next=end; end.prev=_517; _517.high=low; end.low=high; if(end.low==end.high&&end==this.tail){ this.tail=end.prev; if(this.tail!=null){ this.tail.next=null; } end=null; } if(_517.low==_517.high&&_517==this.head){ this.head=_517.next; if(this.head!=null){ this.head.prev=null; } _517=null; } }else{ if(_517.low==low&&_517.high==high){ if(_517!=this.head&&_517!=this.tail){ _517.prev.next=_517.next; _517.next.prev=_517.prev; }else{ if(_517==this.head&&_517!=this.tail){ this.head=_517.next; }else{ if(_517==this.tail&&_517!=this.head){ this.head=_517.next; } } } _517=null; }else{ if(_517.low==low){ _517.low=high; }else{ if(_517.high==high){ _517.high=low; }else{ if(_517.high!=low&&_517.low!=high){ var _51a=new CacheNode(high,_517.high); _51a.prev=_517; _51a.next=_517.next; if(_51a.next==null){ this.tail=_51a; } _517.next.prev=_51a; _517.next=_51a; _517.high=low; } } } } } _517=this.head; } } },_h_22:function(low,high){ var g=new Array(); var n=this.head; if(n==null||n.low>high||this.tail.high<low){ g.push(new Range(low,high)); return g; } var _51f=0; while(n!=null&&n.high<low){ _51f=n.high+1; n=n.next; } if(n!=null){ do{ if(g.length==0){ if(low<n.low){ g.push(new Range(Math.max(low,_51f),Math.min(n.low-1,high))); } } if(high>n.high){ if(n.next==null||n.next.low>high){ g.push(new Range(n.high+1,high)); }else{ g.push(new Range(n.high+1,n.next.low-1)); } } n=n.next; }while(n!=null&&n.high<high); }else{ g.push(new Range(this.tail.high+1,high)); } return g; },_h_23:function(low,high){ var gs=this._h_22(low,high); var a=new Array(); for(var i=0;i<gs.length;i++){ a.push(gs[i].toString()); } return a.join("\u002c"); },removeNode:function(node){ if(node.prev!=null){ node.prev.next=node.next; }else{ this.head=node.next; } if(node.next!=null){ node.next.prev=node.prev; }else{ this.tail=node.prev; } node=null; },search:function(low,high){ },toString:function(){ var n=this.head; var s=new Array(); while(n!=null){ s.push(n.toString()); n=n.next; } return s.join("\u002c"); },_h_18:function(){ return this.debug.join("\u003c\u0042R>"); },_h_20:function(){ var node=this.head; while(Boolean(node)){ var next=node.next; delete (node); node=next; } this.head=null; this.tail=null; }}; var EBASelection=Class.create(); EBASelection.prototype={initialize:function(owner){ this.owner=owner; var t=new Date(); this.selecting=false; this.resizingRow=false; this.selected=false; this.r0=0; this.c0=0; this.r1=0; this.c1=0; this.created=false; this.selectedCells=new Array(); this.selectedRows=new Array(); },_h_13:function(){ if(!this.created){ this.created=true; var _52d="<div style=\"\" class=\"ebaselectionbackground\"></div>"; this.box=document.createElement("d\u0069\u0076"); this.box.id="\u0073\u0065le\u0063t\u0062o\u0078"+this.owner.uid; this.box.className="eb\u0061\u0073\u0065\u006cect\u0069onb\u006frd\u0065\u0072"; this.box.style.overflow="h\u0069dde\u006e"; this.box.style.height=10; this.box.style.width=10; this.box.innerHTML=_52d; this.boxtl=document.createElement("d\u0069v"); this.boxtl.id="s\u0065le\u0063tb\u006fxtl"+this.owner.uid; this.boxtl.className="\u0065b\u0061\u0073e\u006c\u0065c\u0074ion\u0062\u006f\u0072d\u0065\u0072"; this.boxtl.style.overflow="\u0068i\u0064d\u0065\u006e"; this.boxtl.style.height=10; this.boxtl.style.width=10; this.boxtl.innerHTML=_52d; this.boxt=document.createElement("di\u0076"); this.boxt.id="\u0073el\u0065c\u0074\u0062o\u0078\u0074"+this.owner.uid; this.boxt.className="\u0065\u0062a\u0073\u0065l\u0065\u0063\u0074\u0069onborder"; this.boxt.style.overflow="hi\u0064\u0064\u0065\u006e"; this.boxt.style.height=10; this.boxt.style.width=10; this.boxt.innerHTML=_52d; this.boxl=document.createElement("div"); this.boxl.id="\u0073e\u006cect\u0062ox\u006c"+this.owner.uid; this.boxl.className="ebase\u006cect\u0069\u006f\u006e\u0062\u006f\u0072der"; this.boxl.style.overflow="\u0068\u0069d\u0064en"; this.boxl.style.height=10; this.boxl.style.width=10; this.boxl.zIndex=10000001; this.boxl.innerHTML=_52d; Eba.EventManager.attach(this.box,"\u006d\u006fu\u0073eo\u0076er",this,Eba.close(this,this.shrink),false); Eba.EventManager.attach(this.box,"mo\u0075\u0073\u0065up",this,Eba.close(this,this.select),false); Eba.EventManager.attach(this.box,"\u0063l\u0069c\u006b",this,Eba.close(this,this.edit),false); Eba.EventManager.attach(this.boxl,"m\u006f\u0075s\u0065ov\u0065\u0072",this,Eba.close(this,this.shrink),false); Eba.EventManager.attach(this.boxl,"\u006d\u006f\u0075\u0073e\u0075\u0070",this,Eba.close(this,this.select),false); Eba.EventManager.attach(this.boxl,"\u0063l\u0069c\u006b",this,Eba.close(this,this.edit),false); Eba.EventManager.attach(this.boxt,"m\u006f\u0075se\u006f\u0076\u0065\u0072",this,Eba.close(this,this.shrink),false); Eba.EventManager.attach(this.boxt,"mo\u0075\u0073\u0065up",this,Eba.close(this,this.select),false); Eba.EventManager.attach(this.boxt,"cl\u0069\u0063k",this,Eba.close(this,this.edit),false); var sv=this.owner.Scroller.view; sv.midcenter.surface.element.appendChild(this.box); sv.topleft.element.appendChild(this.boxtl); sv.topcenter.container.appendChild(this.boxt); sv.midleft.container.firstChild.appendChild(this.boxl); this.clear(); } },shrink:function(e){ var evt=Eba.Event; if(this.endCell!=null&&this.selecting){ var h=this.endCell.clientHeight; var w=this.endCell.clientWidth; var bh=this.box.clientHeight; var bw=this.box.clientWidth; var x=bw-w; var y=bh-h; var row=EBACell.getRowNumber(this.activeCell); var _538=EBACell.getColumnNumber(this.activeCell); if(evt.offsetY<y){ var dy=Math.ceil((y-evt.offsetY)/20); row=row-dy; var _53a=EBACell.getCellElement(this.owner,row,_538); if(_53a!=null){ this.endCell=_53a; } } if(evt.offsetX<x){ var dx=Math.ceil((x-evt.offsetX)/100); _538=_538-1; var _53a=EBACell.getCellElement(this.owner,row,_538); if(_53a!=null){ this.endCell=_53a; } } if(this.box.parentNode==null){ this.created=false; this._h_13(); } this._h_2(); } },collapse:function(cell){ if(cell==null){ return; } this.startCell=cell; this.endCell=null; if(this.box==null){ this.created=false; this._h_13(); } if(this.box.parentNode==null){ this.created=false; this._h_13(); } this._h_2(); this.selecting=false; this.selected=false; },_h_72:function(_53d,_53e){ this.selecting=true; this.selected=true; this.startCell=_53d; this.endCell=_53e; this.shrink(); document.body.attachEvent("ons\u0065\u006cect\u0073\u0074ar\u0074",function(){ return false; }); },_h_8:function(cell){ this.collapse(cell); },_h_60:function(cell){ this.end=cell; this.shrink(); },_h_41:function(cell){ this.collapse(cell); },_h_2:function(){ var _542=this.endCell||this.startCell; if(_542.getAttribute("\u0063o\u006c")>=this.freezeLeft-1&&_542.getAttribute("ro\u0077")>=this.freezeTop-1){ this.box.style.display="b\u006co\u0063k"; AlignSelection(this.box,this.startCell,_542,286265344,3,3,-2,-2); }else{ this.box.style.display="no\u006e\u0065"; } if(this.startCell.getAttribute("\u0063ol")<=this.freezeLeft&&this.startCell.getAttribute("\u0072\u006f\u0077")<=this.freezeTop){ this.boxtl.style.display="\u0062\u006coc\u006b"; AlignSelection(this.boxtl,this.startCell,_542,286265344,3,3,-2,-2); }else{ this.boxtl.style.display="\u006e\u006fne"; } if(this.startCell.getAttribute("\u0072\u006fw")<=this.freezeTop){ this.boxt.style.display="bl\u006f\u0063k"; AlignSelection(this.boxt,this.startCell,_542,286265344,3,3,-2,-2); }else{ this.boxt.style.display="non\u0065"; } if(this.startCell.getAttribute("col")<=this.freezeLeft){ this.boxl.style.display="\u0062\u006c\u006fc\u006b"; AlignSelection(this.boxl,this.startCell,_542,286265344,3,3,-2,-2); }else{ this.boxl.style.display="\u006eone"; } },redraw:function(cell){ if(!this.selecting){ this.startCell=cell; } this.endCell=cell; this.owner.Scroller.view.midcenter.ViewNavigator.blockNavigator.activeCell=cell; this.owner.Scroller.view.midcenter.position(); if(this.endCell!=this.startCell){ this.startCell.blur(); this._h_2(); } },init:function(cell){ this._h_13(); var t=new Date(); this.selecting=true; this.selected=false; this.freezeTop=this.owner.getfreezetop(); this.freezeLeft=this.owner.getFrozenLeftColumnCount(); this.startCell=cell; this.endCell=null; this._h_2(); },clear:function(){ if(!this.box||!this.box.parentNode){ this.created=false; this._h_13(); } this.box.style.display="no\u006ee"; this.box.style.top=-1000; this.box.style.left=-1000; this.box.style.width=1; this.box.style.height=1; this.boxtl.style.display="\u006eo\u006e\u0065"; this.boxtl.style.top=-1000; this.boxtl.style.left=-1000; this.boxtl.style.width=1; this.boxtl.style.height=1; this.boxt.style.display="none"; this.boxt.style.top=-1000; this.boxt.style.left=-1000; this.boxt.style.width=1; this.boxt.style.height=1; this.boxl.style.display="none"; this.boxl.style.top=-1000; this.boxl.style.left=-1000; this.boxl.style.width=1; this.boxl.style.height=1; this.selected=false; this.selecting=false; },copy:function(){ var _546=new EBARowRenderer(this.owner.data,null,23); var _547=xmlDocFromString(this.owner.model.selectSingleNode("s\u0074\u0061\u0074e\u002fEBAC\u006flu\u006d\u006e\u0073").xml); var _548=this.startCell.id.split("_")[1]-1; var _549=this.startCell.id.split("_")[2]-1; if(this.endCell==null){ this.endCell=this.startCell; } var _54a=this.endCell.id.split("_")[1]-0; var _54b=this.endCell.id.split("\u005f")[2]-0; _546._h_24(_547,rowXslGenerator,_549,(_54b-_549),0,0); var clip=_546.render(_548,(_54a-_548)).replace(/\<a /gi,"\u003c\u0073p\u0061\u006e\u0020").replace(/\<\/a/gi,"</sp\u0061\u006e\u0020").replace(/class\=\"acolumn\d*/g,"class=\""); var oF=window.frames["eba\u0063\u006c\u0069p\u0062o\u0061r\u0064"]; var oD=oF.window.document; oD.open(); var _54f="\u003c\u0073\u0074yl\u0065>"+transformToString(this.owner.model,this.owner.frameCssXsl)+"\u003c/\u0073\u0074\u0079le\u003e"; var _550=""; _550+=_54f; oD.write("<h\u0074m\u006c><\u0068\u0065a\u0064\u003e"+_550+"\u003c\u002f\u0068e\u0061d\u003e<b\u006f\u0064\u0079\u003e"+clip+"\u003c\u002f\u0062o\u0064\u0079\u003e\u003c\u002fh\u0074m\u006c>"); oD.close(); var rng=oF.window.document.body.createTextRange(); rng.select(); oF.focus(); },makeXSL:function(){ var G=this.owner; var cols=G.getChildren(); var _554=""; var row=G.getCellObject(this.r0,0).parentNode; for(var r=this.r0;r<=this.r1;r++){ _554+="@\u0078k\u003d"+row.xk+" \u006fr "; row=row.nextSibling; } _554+="0"; var s="<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"><xsl:output method=\"html\"/><xsl:template match = \"*\"><xsl:apply-templates /></xsl:template><xsl:template match = \"/\">"; s+="<table><xsl:for-each select=\"//e["+_554+"]\" ><xsl:sort select=\"@xi\" data-type=\"number\" order=\"ascending\"/><tr>"; for(var c=this.c0;c<=this.c1;c++){ var attr=G.fieldmap[cols[c].xdatafld]; s+="<td><xsl:value-of select=\""+attr+"\" /></td>"; } s+="</t\u0072>\u003c/\u0078sl\u003a\u0066\u006f\u0072-\u0065a\u0063\u0068><\u002ftable>\u003c/\u0078\u0073l:t\u0065\u006dpl\u0061t\u0065\u003e</\u0078\u0073l:\u0073t\u0079lesh\u0065e\u0074>"; return s; },edit:function(e){ var evt=(IE)?event:e; this.owner.edit(evt); },select:function(){ this.selecting=true; if(this.selected){ this.collapse(this.startCell); this.selecting=false; this.selected=false; }else{ this.selecting=false; this.selected=true; } this.owner.Scroller.swapPanes(false); },getRowByCoords:function(_55c){ return (_55c.parentNode.offsetTop/_55c.parentNode.offsetHeight); },getColumnByCoords:function(_55d){ var _55e=(this.indicator?-2:0); if(_55d.parentNode.parentNode.getAttribute("\u0069d").substr(0,6)!="fr\u0065ez\u0065"){ _55e+=2-(this.freezeColumn*3); }else{ _55e+=2; } return Math.floor((_55d.sourceIndex-_55d.parentNode.sourceIndex-_55e)/3); }}; EBASelection.prototype.dispose=function(){ }; function AlignSelection(_55f,_560,_561,_562,oh,ow,oy,ox,show){ oh=oh||0; ow=ow||0; oy=oy||0; ox=ox||0; var a=_562; var td,sd,tt,tb,tl,tr,th,tw,st,sb,sl,sr,sh,sw; if(!_560||!(_560.getBoundingClientRect)){ return; } if(_560.getBoundingClientRect){ ebaAssert(Boolean(_560.parentNode)&&Boolean(_561.parentNode)&&Boolean(_55f.parentNode),"\u0043\u006fuld\u006e\u0027\u0074 \u0061li\u0067\u006e s\u0065le\u0063\u0074io\u006e\u002e \u0054he\u0020pa\u0072entn\u006f\u0064e has \u0076ani\u0073\u0068ed. \u004d\u006f\u0073\u0074\u0020l\u0069\u006b\u0065\u006cy t\u0068\u0069s \u0069\u0073 \u0064\u0075e\u0020t\u006f \u0072\u0065\u0066il\u0074er\u002e"); ad=_560.getBoundingClientRect(); bd=_561.getBoundingClientRect(); sd=_55f.getBoundingClientRect(); at=ad.top; ab=ad.bottom; al=ad.left; ar=ad.right; ah=Math.abs(ab-at); aw=Math.abs(ar-al); bt=bd.top; bb=bd.bottom; bl=bd.left; br=bd.right; bh=Math.abs(bb-bt); bw=Math.abs(br-bl); tt=ad.top; tb=bd.bottom; tl=ad.left; tr=bd.right; th=Math.abs(tb-tt); tw=Math.abs(tr-tl); st=sd.top; sb=sd.bottom; sl=sd.left; sr=sd.right; sh=Math.abs(sb-st); sw=Math.abs(sr-sl); } if(document.getBoxObjectFor){ td=document.getBoxObjectFor(_560); sd=document.getBoxObjectFor(_55f); var _56a=parseInt(document.defaultView.getComputedStyle(_55f,"").getPropertyValue("\u0062\u006frder\u002d\u006cef\u0074\u002d\u0077\u0069\u0064\u0074\u0068")); var _56b=parseInt(document.defaultView.getComputedStyle(_55f,"").getPropertyValue("bo\u0072d\u0065\u0072\u002dt\u006f\u0070\u002dw\u0069\u0064\u0074h")); tt=td.y+_56b; tl=td.x+_56a; tw=td.width; th=td.height; st=sd.y; sl=sd.x; sw=sd.width; sh=sd.height; } if(a&268435456){ _55f.style.height=th+oh; } if(a&16777216){ _55f.style.width=tw+ow; } if(a&1048576){ _55f.style.top=(Eba.Dom.getTop(_55f)+tt-st+oy)+"\u0070x"; } if(a&65536){ _55f.style.top=(Eba.Dom.getTop(_55f)+tt-st+th-sh+oy)+"p\u0078"; } if(a&4096){ _55f.style.left=(Eba.Dom.getLeft(_55f)-sl+tl+ox)+"\u0070x"; } if(a&256){ _55f.style.left=(Eba.Dom.getLeft(_55f)-sl+tl+tw-sw+ox)+"\u0070x"; } if(a&16){ _55f.style.top=(Eba.Dom.getTop(_55f)+tt-st+oy+Math.floor((th-sh)/2))+"\u0070\u0078"; } if(a&1){ _55f.style.left=(Eba.Dom.getLeft(_55f)-sl+tl+ox+Math.floor((tw-sw)/2))+"\u0070x"; } show=false; if(show){ src.style.top=st-2; src.style.left=sl-2; src.style.height=sh; src.style.width=sw; tgt.style.top=tt-2; tgt.style.left=tl-2; tgt.style.height=th; tgt.style.width=tw; if(document.getBoundingClientRect){ sd=_55f.getBoundingClientRect(); st=sd.top; sb=sd.bottom; sl=sd.left; sr=sd.right; sh=Math.abs(sb-st); sw=Math.abs(sr-sl); } if(document.getBoxObjectFor){ sd=document.getBoxObjectFor(_55f); st=sd.screenY; sl=sd.screenX; sw=sd.width; sh=sd.height; } src2.style.top=st-2; src2.style.left=sl-2; src2.style.height=sh; src2.style.width=sw; } } var EBAColumn=Class.create(); EBAColumn.prototype={initialize:function(grid,_56d){ this.grid=grid; this.column=_56d; this.Interface=this.grid.API.selectSingleNode("in\u0074e\u0072\u0066ac\u0065\u0073/in\u0074erf\u0061c\u0065[\u0040\u006e\u0061me\u003d'EB\u0041C\u006f\u006cu\u006dn']"); eval(Eba.Xml.transformToString(this.Interface,grid.accessorGeneratorXslProc)); if(MOZ){ this.ModelNode=this.grid.model.selectSingleNode("\u002f/\u0073t\u0061\u0074e\u002fEB\u0041\u0043o\u006cumn\u0073/E\u0042AC\u006fl\u0075\u006d\u006e["+(parseInt(_56d)+1)+"\u005d"); ebaAssert(Boolean(this.ModelNode),"Fail\u0065\u0064\u0020t\u006f \u0067e\u0074\u0020\u0074\u0068\u0065 \u006d\u006fd\u0065\u006cn\u006f\u0064\u0065\u0020\u0066or\u0020a\u0020c\u006flu\u006dn\u0020\u0077ith xp\u0061th\u003a\u0020"+"//\u0073tat\u0065\u002fEB\u0041C\u006f\u006cumn\u0073\u002f\u0045\u0042\u0041C\u006flu\u006d\u006e["+(_56d+1)+"]"); }else{ this.ModelNode=this.grid.model.selectSingleNode("/\u002f\u0073\u0074ate/\u0045BAColum\u006e\u0073\u002f\u0045\u0042AColu\u006d\u006e["+(_56d)+"\u005d"); ebaAssert(Boolean(this.ModelNode),"Fai\u006ce\u0064\u0020to\u0020ge\u0074 \u0074\u0068e\u0020mo\u0064eln\u006fde\u0020\u0066\u006f\u0072 \u0061\u0020\u0063o\u006c\u0075mn\u0020with \u0078p\u0061\u0074\u0068\u003a\u0020"+"/\u002f\u0073ta\u0074e/E\u0042ACo\u006cu\u006d\u006es\u002f\u0045\u0042ACo\u006c\u0075m\u006e\u005b"+(_56d)+"\u005d"); } this.HeaderElement=EBAColumn.getColumnHeaderElement(grid,_56d); },xGETMODEL:function(){ var node=this.ModelNode; node=node.selectSingleNode("@"+arguments[0]); if(node!=null){ return node.value; } },xSETMODEL:function(){ ebaAssert(Boolean(this.ModelNode),"\u0054here\u0020\u0069s\u0020n\u006f \u006do\u0064e\u006c n\u006fde i\u006e\u0020\u0063\u006flu\u006dn\u002e"); var node=this.ModelNode; if(node!=null){ node.setAttribute(arguments[0],arguments[1][0]); }else{ alert("\u0043\u0061nno\u0074\u0020\u0073et\u0020\u006dod\u0065l pr\u006fp\u0065r\u0074y: "+arguments[0]); } },xGET:function(){ var node=this.grid.model.documentElement; node=node.selectSingleNode(arguments[0]); if(node!=null){ return node.value; } },xSET:function(){ var node=this.grid.model.documentElement; node=node.selectSingleNode(arguments[0]); if(node!=null){ node.nodeValue=arguments[1][0]; } }}; EBAColumn.getColumnHeaderElement=function(grid,_573){ return document.getElementById("eb\u0061\u005f\u0067rid_\u0063\u006flu\u006d\u006e\u0068\u0065\u0061\u0064er_"+_573+"_"+grid.uid); }; Eba.ColumnResizer=function(grid){ this.grid=grid; this.line=document.getElementById("eba\u0067\u0072\u0069\u0064r\u0065s\u0069ze\u006c\u0069\u006ee\u005f"); if(this.line==null){ this.line=document.createElement("\u0064\u0069v"); this.line.id="eba\u0067\u0072\u0069\u0064\u0072esi\u007a\u0065\u006cine_"; document.body.appendChild(this.line); this.line.className="\u0065b\u0061\u0063olum\u006e\u0072\u0065siz\u0065\u006c\u0069\u006ee"; } this.lineStyle=this.line.style; if(gIE){ this.surface=document.getElementById("\u0065bag\u0072\u0069\u0064\u0072\u0065\u0073\u0069z\u0065\u0073\u0075\u0072f\u0061\u0063\u0065_"); if(this.surface==null){ this.surface=document.createElement("d\u0069v"); this.surface.id="e\u0062a\u0067\u0072\u0069d\u0072\u0065\u0073\u0069ze\u0073\u0075\u0072\u0066ace\u005f"; this.surface.className="e\u0062\u0061\u0063\u006f\u006cumnre\u0073\u0069\u007ae\u0073urf\u0061\u0063e"; document.body.appendChild(this.surface); } } }; Eba.ColumnResizer.prototype.startResize=function(grid,_576,_577,_578){ ebaAssert(grid!=null&&_576!=null&&_578!=null,"\u0043o\u0075\u006c\u0064\u006e't \u0073t\u0061rt \u0072\u0065\u0073ize.\u0020\u004fn\u0065\u0020\u006fr \u006d\u006fre\u0020args\u0020a\u0072e n\u0075\u006c\u006c"); this.grid=grid; ebaAssert(_578!=null,"\u0043an'\u0074 res\u0069\u007a\u0065 \u0061\u0020c\u006flu\u006dn\u0020w\u0069th\u006fu\u0074 an\u0020e\u0076e\u006e\u0074\u0020\u006fb\u006a\u0065\u0063\u0074."); var x,y; if(gIE){ x=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft; this.surface.style.visibility="\u0076\u0069s\u0069b\u006c\u0065"; Align(this.surface,this.grid.element,Align_SAMEHEIGHT|Align_SAMEWIDTH|Align_ALIGNTOP|Align_ALIGNLEFT); }else{ x=_578.clientX+window.scrollX; } this.x=x; Align(this.line,_577,Align_ALIGNTOP,0,0,Eba.Dom.getHeight(_577)+1); this.lineStyle.left=x; this.lineStyle.height=parseInt(this.grid.getHeight())-19-(this.grid.toolbar?parseInt(this.grid.toolbar.getHeight()):0); this.lineStyle.visibility="v\u0069sib\u006ce"; this.column=_576; Eba.startDrag(this.line,_578,false,true,this,this.endResize); }; Eba.ColumnResizer.prototype.endResize=function(x,y){ if(gIE){ this.surface.style.visibility="\u0068\u0069dde\u006e"; } this.lineStyle.visibility="\u0068\u0069dde\u006e"; this.lineStyle.top=0; this.lineStyle.left=0; var _57c=parseInt(this.column.getWidth())+x-this.x; if(isNaN(_57c)){ return; } ebaAssert(!isNaN(_57c),"Tryi\u006eg t\u006f\u0020s\u0065\u0074 a c\u006f\u006cumn width\u0020\u0074\u006f a\u0020\u006ean"); if(_57c>10){ this.column.setWidth(_57c); this.grid.generateCss(); this.grid.Scroller.swapPanes(true); this.grid.Scroller.swapPanes(false); } this.grid.Selection.collapse(this.grid.activeCell); }; Eba.ColumnResizer.prototype.dispose=function(){ this.grid=null; this.line=null; this.lineStyle=null; this.surface=null; }; var EBARow=Class.create(); EBARow.prototype={initialize:function(grid,row){ this.grid=grid; this.row=row; this.Interface=this.grid.API.selectSingleNode("i\u006e\u0074\u0065r\u0066\u0061\u0063\u0065\u0073/\u0069\u006eterf\u0061ce\u005b\u0040\u006eame=\u0027\u0045BARo\u0077']"); eval(Eba.Xml.transformToString(this.Interface,grid.accessorGeneratorXslProc)); this.DomNode=document.getElementById("\u0073he\u0065t_"+row); this.DataNode=this.grid.data.getTable("_d\u0065f\u0061\u0075l\u0074").xmlDoc.selectSingleNode("//"+ns+"d\u0061\u0074\u0061\u0073\u006f\u0075r\u0063\u0065[@i\u0064=\u0027_d\u0065\u0066\u0061ul\u0074']\u002f"+ns+"\u0064\u0061ta/"+ns+"\u0065[\u0040x\u0069\u003d"+row+"]"); },xGETMETA:function(){ var node=this.MetaNode; node=node.selectSingleNode("\u0040"+arguments[0]); if(node!=null){ return node.value; } },xSETMETA:function(){ var node=this.MetaNode; if(null==node){ var meta=this.grid.data.selectSingleNode("//\u0072oot\u002f\u0067r\u0069\u0064\u006de\u0074\u0061"); var _582=this.MetaNode=this.grid.data.createNode(1,"\u0072",""); _582.setAttribute("\u0078\u0069",this.row); meta.appendChild(_582); node=this.MetaNode=_582; } if(node!=null){ node.setAttribute(arguments[0],arguments[1][0]); }else{ alert("Cannot s\u0065\u0074 \u0070\u0072o\u0070\u0065r\u0074\u0079\u003a\u0020"+arguments[0]); } },GETDATA:function(){ },SETDATA:function(){ }}; var EBACell=Class.create(); EBACell.prototype={initialize:function(grid,row,_585){ this.grid=grid; this.row=Number(row); this.column=Number(_585); this.Interface=this.grid.API.selectSingleNode("int\u0065\u0072faces/interfac\u0065[@n\u0061\u006de='EB\u0041C\u0065l\u006c\u0027\u005d"); eval(Eba.Xml.transformToString(this.Interface,this.grid.accessorGeneratorXslProc)); this.DomNode=EBACell.getCellElement(this.grid,this.row,this.column); this.columnObject=this.grid.getColumnObject(_585); var _586=this.grid.data.getTable("\u005f\u0064\u0065fa\u0075l\u0074"); this.DataNode=_586.xmlDoc.selectSingleNode("\u002f/"+ns+"\u0064at\u0061s\u006furce[\u0040id\u003d\u0027\u005f\u0064e\u0066a\u0075lt\u0027\u005d/"+ns+"dat\u0061/"+ns+"\u0065[@\u0078i="+this.row+"]\u002f"+_586.fieldMap[this.columnObject.getColumnName()]); },test:function(){ alert(this.row+" -\u0020"+this.column+"\u0020\u002d\u0020"+this.DataNode.value+"\u0020\u002d "+this.column.getColumnName()); },GETDATA:function(){ var node=this.DataNode; if(node!=null){ return node.value; } },SETDATA:function(){ var node=this.DataNode; if(node!=null){ node.value=arguments[1][0]; } },xGETMETA:function(){ if(this.MetaNode==null){ return null; } var node=this.MetaNode; node=node.selectSingleNode("\u0040"+arguments[0]); if(node!=null){ return node.value; } },xSETMETA:function(){ var node=this.MetaNode; if(node!=null){ node.setAttribute(arguments[0],arguments[1][0]); }else{ alert("\u0043\u0061\u006en\u006ft \u0073e\u0074 p\u0072\u006fpe\u0072\u0074\u0079\u003a "+arguments[0]); } },xSETCSS:function(){ var node=this.DomNode; if(node!=null){ node.style.setAttribute(arguments[0],arguments[1][0]); }else{ alert("\u0043an\u006eo\u0074\u0020\u0073\u0065t\u0020\u0070r\u006fp\u0065r\u0074y\u003a "+arguments[0]); } },xGET:function(){ var node=this.grid.model.documentElement; node=node.selectSingleNode(arguments[0]); if(node!=null){ return node.value; } },xSET:function(){ var node=this.grid.model.documentElement; node=node.selectSingleNode(arguments[0]); if(node!=null){ node.nodeValue=arguments[1][0]; } },getStyle:function(){ return this.grid.getStyleObject(this); }}; EBACell.getCellElement=function(grid,row,_590){ return document.getElementById("\u0065b\u0061\u005fgr\u0069d_\u0063\u0065\u006c\u006c_"+row+"\u005f"+_590+"\u005f"+grid.uid); }; EBACell.getRowNumber=function(_591){ return parseInt(_591.getAttribute("xi")); }; EBACell.getColumnNumber=function(_592){ return parseInt(_592.getAttribute("\u0063o\u006c")); }; var EBAStyle=Class.create(); EBAStyle.prototype={initialize:function(_593,id){ this.spreadsheet=_593; this.id=id; this.Interface=this.spreadsheet.API.selectSingleNode("\u0069n\u0074\u0065\u0072\u0066\u0061c\u0065\u0073/interface\u005b\u0040n\u0061\u006de\u003d'E\u0042\u0041S\u0074yle'\u005d"); eval(Eba.Xml.transformToString(this.Interface,_593.accessorGeneratorXslProc)); this.MetaNode=this.spreadsheet.data.selectSingleNode("/\u002f\u0072o\u006ft/sp\u0072\u0065a\u0064\u0073\u0068ee\u0074m\u0065\u0074a/\u0073t\u0079le\u0073\u002f*[@\u0069d\u003d'"+id+"\u0027\u005d"); },xGETMETA:function(){ var node=this.MetaNode; node=node.selectSingleNode("\u0040"+arguments[0]); if(node!=null){ return node.value; } },xSETMETA:function(){ var node=this.MetaNode; if(node!=null){ if(arguments[1][0]!=""&&arguments[1][0]!=null){ node.setAttribute(arguments[0],arguments[1][0]); }else{ node.removeAttribute(arguments[0]); } var _597=this.spreadsheet.logMeta.selectSingleNode("st\u0079\u006ce\u0073\u002f\u0063s[i\u0064\u003d\u0027"+this.id+"\u0027\u005d"); if(_597==null){ _597=this.spreadsheet.model.selectSingleNode("/sta\u0074e/D\u0065\u0066\u0061\u0075\u006c\u0074s\u002fc\u0073").cloneNode(true); var _598=this.spreadsheet.logMeta.selectSingleNode("\u0073t\u0079\u006ces"); _598.appendChild(_597); _597.setAttribute("\u0069d",this.id); } _597.setAttribute("x\u0061\u0063","u"); _597.setAttribute(arguments[0],arguments[1][0]); }else{ alert("\u0043a\u006eno\u0074\u0020\u0073\u0065\u0074\u0020p\u0072o\u0070\u0065rt\u0079\u003a\u0020"+arguments[0]); } },xGET:function(){ var node=this.spreadsheet.model.documentElement; node=node.selectSingleNode(arguments[0]); if(node!=null){ return node.value; } },xSET:function(){ var node=this.spreadsheet.model.documentElement; node=node.selectSingleNode(arguments[0]); if(node!=null){ node.nodeValue=arguments[1][0]; } }}; if(typeof (Eba)=="und\u0065fi\u006ee\u0064"){ Eba={}; } Eba.UiElement=function(xml,xsl,id){ if(arguments.length>0){ this.initialize(xml,xsl,id); } }; Eba.UiElement.method("in\u0069ti\u0061lize",function(xml,xsl,id){ this.m_Xml=xml; this.m_Xsl=xsl; this.m_Id=id; this.m_HtmlElementHandle=null; }); Eba.UiElement.method("\u0067\u0065tH\u0065i\u0067\u0068\u0074",function(){ return this.getHtmlElementHandle().style.height; }); Eba.UiElement.method("\u0073\u0065tHe\u0069ght",function(_5a1){ this.getHtmlElementHandle().style.height=_5a1; }); Eba.UiElement.method("ge\u0074Id",function(){ return this.m_Id; }); Eba.UiElement.method("\u0073e\u0074I\u0064",function(id){ this.m_Id=id; }); Eba.UiElement.method("\u0067e\u0074W\u0069\u0064t\u0068",function(){ return this.getHtmlElementHandle().style.width; }); Eba.UiElement.method("\u0073\u0065\u0074Wid\u0074h",function(_5a3){ this.getHtmlElementHandle().style.width=_5a3; }); Eba.UiElement.method("ge\u0074Xml",function(){ return this.m_Xml; }); Eba.UiElement.method("se\u0074\u0058m\u006c",function(xml){ this.m_Xml=xml; }); Eba.UiElement.method("ge\u0074Xsl",function(){ return this.m_Xsl; }); Eba.UiElement.method("\u0073\u0065t\u0058\u0073\u006c",function(xsl){ this.m_Xsl=xsl; }); Eba.UiElement.method("\u0067et\u0048\u0074\u006dlEle\u006de\u006e\u0074H\u0061nd\u006ce",function(){ if(!this.m_HtmlElementHandle){ this.m_HtmlElementHandle=document.getElementById(this.m_Id); } return this.m_HtmlElementHandle; }); Eba.UiElement.method("se\u0074Ht\u006dlEl\u0065m\u0065\u006e\u0074\u0048\u0061ndle",function(_5a6){ this.m_HtmlElementHandle=_5a6; }); Eba.UiElement.method("hid\u0065",function(){ var tag=this.getHtmlElementHandle(); tag.style.visibility="hi\u0064\u0064en"; tag.style.position="abso\u006c\u0075\u0074\u0065"; }); Eba.UiElement.method("s\u0068ow",function(){ var tag=this.getHtmlElementHandle(); tag.style.visibility="\u0076\u0069s\u0069\u0062le"; }); Eba.UiElement.method("f\u006co\u0061\u0074",function(){ var tag=this.getHtmlElementHandle(); tag.style.position="a\u0062so\u006c\u0075\u0074e"; }); Eba.UiElement.method("\u0073\u0065tX",function(x){ var tag=this.getHtmlElementHandle(); tag.style.left=x; }); Eba.UiElement.method("g\u0065\u0074\u0058",function(){ var tag=this.getHtmlElementHandle(); }); Eba.UiElement.method("s\u0065\u0074Y",function(y){ var tag=this.getHtmlElementHandle(); tag.style.top=y; }); Eba.UiElement.method("\u0072\u0065nde\u0072",function(_5af){ var xsl=this.m_Xsl; if(xsl.indexOf("x\u0073l\u003astyl\u0065sh\u0065et")==-1){ xsl="<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"><xsl:output method=\"xml\" version=\"4.0\" />"+xsl+"</x\u0073\u006c:\u0073\u0074yl\u0065s\u0068\u0065\u0065\u0074>"; } var _5b1=Eba.Xml.createXslDoc(xsl); var _5b2=Eba.Xml.createXmlDoc(this.m_Xml); var html=Eba.Xml.transform(_5b2,_5b1); _5af.insertAdjacentHTML("bef\u006fr\u0065E\u006e\u0064",html); this.attachToTag(); }); Eba.UiElement.method("\u0061tt\u0061chT\u006f\u0054a\u0067",function(){ var _5b4=this.getHtmlElementHandle(); if(_5b4!=null){ _5b4.object=this; } }); Eba.InteractiveUiElement=function(_5b5){ this.enable(); }; Eba.InteractiveUiElement.inherits(Eba.UiElement); Eba.InteractiveUiElement.method("en\u0061\u0062le",function(){ this.m_Enabled=true; }); Eba.InteractiveUiElement.method("disa\u0062le",function(){ this.m_Enabled=false; }); Eba.UiButtonXsl="<xsl:template match=\"button\">"+"<div class=\"EbaButton\" onmousemove=\"return false;\" onmousedown=\"if (this.object.m_Enabled) this.className='EbaButtonDown';\" onmouseup=\"this.className='EbaButton';\" onmouseover=\"if (this.object.m_Enabled) this.className='EbaButtonHighlight';\" onmouseout=\"this.className='EbaButton';\" align=\"center\">"+"<xsl:attribute name=\"image_disabled\">"+"\u003cx\u0073\u006c:\u0063h\u006fo\u0073e>"+"<xsl:when test=\"../../@image_directory\">"+"<xsl:value-of select=\"concat(../../@image_directory,'/',@image_disabled)\" />"+"\u003c/\u0078s\u006c:\u0077h\u0065n>"+"\u003c\u0078s\u006c:\u006fth\u0065\u0072\u0077\u0069s\u0065>"+"<xsl:value-of select=\"@image_disabled\" />"+"<\u002fx\u0073\u006c\u003aot\u0068\u0065rwis\u0065\u003e"+"\u003c/\u0078\u0073l:choose>"+"\u003c/xs\u006c:a\u0074t\u0072\u0069b\u0075te>"+"<xsl:attribute name=\"image_enabled\">"+"<x\u0073l:\u0063hoos\u0065\u003e"+"<xsl:when test=\"../../@image_directory\">"+"<xsl:value-of select=\"concat(../../@image_directory,'/',@image)\" />"+"<\u002f\u0078\u0073l\u003a\u0077\u0068\u0065n>"+"<x\u0073l:o\u0074\u0068\u0065r\u0077i\u0073\u0065>"+"<xsl:value-of select=\"@image\" />"+"\u003c/x\u0073l:\u006fthe\u0072w\u0069s\u0065\u003e"+"<\u002f\u0078\u0073l:\u0063hoo\u0073e>"+"\u003c/\u0078s\u006c:\u0061\u0074\u0074r\u0069\u0062\u0075\u0074\u0065>"+"<xsl:attribute name=\"title\">"+"<xsl:value-of select=\"@tooltip_text\" />"+"\u003c\u002f\u0078s\u006c:a\u0074trib\u0075\u0074\u0065>"+"<xsl:attribute name=\"onclick\">"+"<\u0078s\u006c:v\u0061\u006c\u0075e\u002dof s\u0065le\u0063t='con\u0063a\u0074(\u0026q\u0075\u006ft;\u0076\u0026quot;\u002c&\u0071uot;a\u0026\u0071u\u006ft\u003b\u002c\u0026\u0071\u0075ot\u003br\u0026quot;\u002c&qu\u006ft\u003b\u0020&\u0071\u0075ot\u003b,\u0026\u0071\u0075o\u0074;e\u0026q\u0075\u006f\u0074\u003b,\u0026\u0071u\u006f\u0074;=\u0026qu\u006ft\u003b,&quot\u003b\u0026\u0061p\u006fs\u003b&qu\u006f\u0074;,\u0040\u006fncl\u0069\u0063\u006b_event,\u0026q\u0075ot;&\u0061\u0070\u006f\u0073;\u0026q\u0075ot\u003b,\u0026q\u0075ot\u003b;&\u0071uot;\u002c\u0026\u0071uot;\u0065\u0026\u0071uo\u0074;\u002c&\u0071u\u006ft;\u0076&quot;\u002c&qu\u006f\u0074;a&q\u0075\u006ft\u003b,\u0026\u0071u\u006f\u0074;\u006c\u0026\u0071\u0075\u006ft;,\u0026\u0071\u0075\u006f\u0074\u003b(\u0026\u0071\u0075ot\u003b\u002c&qu\u006ft;\u0074&\u0071\u0075\u006ft;,\u0026\u0071\u0075ot;h\u0026\u0071uot\u003b,&\u0071\u0075ot\u003b\u0069\u0026\u0071\u0075\u006ft;,\u0026q\u0075ot;\u0073&q\u0075\u006f\u0074;,&\u0071\u0075\u006ft\u003b\u002e&qu\u006ft;\u002c&q\u0075o\u0074;\u006f\u0026\u0071\u0075\u006f\u0074\u003b,\u0026q\u0075ot;\u0062&qu\u006ft;\u002c\u0026\u0071uo\u0074;j&\u0071uo\u0074\u003b\u002c\u0026\u0071u\u006ft\u003b\u0065\u0026quo\u0074\u003b,\u0026\u0071\u0075\u006ft\u003b\u0063\u0026\u0071uot\u003b,&\u0071u\u006ft\u003b\u0074\u0026quot;,&quo\u0074;.\u0026\u0071uo\u0074;\u002c\u0026q\u0075ot\u003bo\u0026\u0071u\u006ft\u003b\u002c\u0026quo\u0074;n&quot;\u002c&\u0071uo\u0074;C\u0026qu\u006ft\u003b,\u0026quot\u003bl&\u0071\u0075\u006f\u0074\u003b,&\u0071u\u006f\u0074\u003b\u0069\u0026q\u0075\u006f\u0074;\u002c&quo\u0074\u003bc\u0026\u0071\u0075\u006ft;\u002c&\u0071uo\u0074\u003b\u006b&q\u0075\u006f\u0074\u003b,&\u0071uot;H&\u0071uot\u003b,\u0026\u0071\u0075\u006ft\u003b\u0061\u0026quot;\u002c&\u0071u\u006f\u0074\u003b\u006e&qu\u006f\u0074;,&qu\u006ft\u003bd&\u0071u\u006ft\u003b\u002c\u0026q\u0075\u006ft;\u006c\u0026\u0071\u0075o\u0074\u003b\u002c\u0026\u0071u\u006ft\u003be&qu\u006f\u0074\u003b,\u0026\u0071u\u006f\u0074;r&\u0071u\u006f\u0074\u003b\u002c&\u0071\u0075ot\u003b(&qu\u006f\u0074;\u002c\u0026q\u0075ot\u003be&quo\u0074;,&qu\u006ft\u003b)\u0026quo\u0074;\u002c&\u0071u\u006f\u0074\u003b)&quot;\u002c&\u0071uo\u0074;\u003b\u0026\u0071\u0075ot;,&a\u0070os\u003b\u0026a\u0070\u006f\u0073;)\u0027 \u002f>"+"<\u002f\u0078\u0073\u006c:\u0061tt\u0072i\u0062\u0075te\u003e"+"<xsl:attribute name=\"id\">"+"<xsl:value-of select=\"@id\" />"+"</x\u0073l:a\u0074\u0074\u0072ibu\u0074e\u003e"+"<xsl:attribute name=\"style\">"+"<\u0078sl\u003a\u0063\u0068oo\u0073\u0065>"+"<xsl:when test=\"../../@height\">"+"<xsl:value-of select=\"concat('float:left;width:',../../@height,'px;height:',../../@height - 1,'px')\" />"+"<\u002fx\u0073\u006c\u003aw\u0068\u0065n>"+"\u003c\u0078s\u006c\u003aot\u0068e\u0072w\u0069s\u0065>"+"<xsl:value-of select=\"concat('float:left;width:',@width,'px;height:',@height,'px')\" />"+"<\u002fxs\u006c:ot\u0068erwi\u0073\u0065\u003e"+"</xs\u006c\u003achoos\u0065>"+"\u003c/\u0078\u0073l\u003a\u0061tt\u0072\u0069\u0062\u0075te>"+"<img border=\"0\">"+"<xsl:attribute name=\"src\">"+"<\u0078sl:\u0063h\u006f\u006fse>"+"<xsl:when test=\"../../@image_directory\">"+"<xsl:value-of select=\"concat(../../@image_directory,'/',@image)\" />"+"</\u0078sl\u003awh\u0065\u006e>"+"<\u0078s\u006c:othe\u0072\u0077\u0069se>"+"<xsl:value-of select=\"@image\" />"+"</xs\u006c\u003a\u006fther\u0077\u0069\u0073\u0065>"+"<\u002f\u0078\u0073l:\u0063\u0068oo\u0073\u0065>"+"<\u002fxs\u006c:a\u0074t\u0072\u0069\u0062ut\u0065>"+"<xsl:attribute name=\"style\">"+"<xsl:variable name=\"top_offset\">"+"<\u0078\u0073\u006c\u003a\u0063\u0068\u006fo\u0073\u0065\u003e"+"<xsl:when test=\"@top_offset\">"+"<xsl:value-of select=\"@top_offset\" />"+"</\u0078\u0073\u006c\u003aw\u0068\u0065\u006e>"+"<\u0078\u0073\u006c:o\u0074h\u0065r\u0077\u0069\u0073e>"+"\u0030"+"<\u002f\u0078s\u006c\u003a\u006ft\u0068e\u0072wis\u0065>"+"\u003c\u002f\u0078\u0073l\u003ach\u006fo\u0073e>"+"\u003c/\u0078sl:\u0076a\u0072\u0069\u0061ble\u003e"+"<xs\u006c\u003a\u0063\u0068\u006f\u006f\u0073\u0065>"+"<xsl:when test=\"../../@height\">"+"<xsl:value-of select=\"concat('MARGIN-TOP:',((../../@height - @height) div 2) - 1 + number($top_offset),'px;MARGIN-BOTTOM:0px')\" />"+"\u003c/x\u0073l\u003a\u0077h\u0065\u006e>"+"\u003c\u0078s\u006c\u003ao\u0074h\u0065\u0072\u0077ise\u003e"+"<xsl:value-of select=\"concat('MARGIN-TOP:',(@height - @image_height) div 2,'px;MARGIN-BOTTOM:0','px')\" />"+"</xsl\u003ao\u0074\u0068\u0065r\u0077is\u0065\u003e"+"\u003c/\u0078s\u006c\u003achoo\u0073\u0065>"+"\u003c\u002f\u0078\u0073\u006c:a\u0074t\u0072i\u0062ut\u0065\u003e"+"</i\u006dg>\u003c!\u005b\u0043D\u0041T\u0041\u005b \u005d]\u003e"+"<\u002fdiv\u003e"+"\u003c\u002fx\u0073l:\u0074\u0065mpla\u0074e\u003e"; Eba.UiButton=function(xml,id){ this.initialize(xml,Eba.UiButtonXsl,id); }; Eba.UiButton.inherits(Eba.InteractiveUiElement); Eba.UiButton.method("onC\u006cickHa\u006edl\u0065r",function(_5b8){ if(this.m_Enabled){ eval(_5b8); } }); Eba.UiButton.method("\u0064\u0069\u0073\u0061ble",function(){ this.uber("disa\u0062\u006ce"); var _5b9=this.getHtmlElementHandle(); _5b9.childNodes[0].src=_5b9.getAttribute("im\u0061\u0067e\u005f\u0064isab\u006c\u0065d"); }); Eba.UiButton.method("\u0065\u006e\u0061b\u006c\u0065",function(){ this.uber("\u0065n\u0061b\u006ce"); var _5ba=this.getHtmlElementHandle(); _5ba.childNodes[0].src=_5ba.getAttribute("\u0069\u006d\u0061\u0067e_e\u006eab\u006ce\u0064"); }); Eba.UiBinaryStateButtonXsl="<xsl:template match=\"binarystatebutton\">"+"<div class=\"EbaBinaryStateButton\" onmousemove=\"return false;\" onmousedown=\"if (this.object.m_Enabled) this.className='EbaButtonDown';\" onmouseup=\"(this.object.isChecked()?this.object.check():this.object.uncheck())\" onmouseover=\"if (this.object.m_Enabled) this.className='EbaButtonHighlight';\" onmouseout=\"(this.object.isChecked()?this.object.check():this.object.uncheck())\" align=\"center\">"+"<xsl:attribute name=\"image_disabled\">"+"\u003c\u0078s\u006c:\u0063\u0068oose\u003e"+"<xsl:when test=\"../../@image_directory\">"+"<xsl:value-of select=\"concat(../../@image_directory,'/',@image_disabled)\" />"+"</x\u0073\u006c\u003awh\u0065\u006e\u003e"+"\u003cx\u0073l\u003a\u006f\u0074h\u0065\u0072wis\u0065>"+"<xsl:value-of select=\"@image_disabled\" />"+"</xs\u006c\u003a\u006f\u0074h\u0065rw\u0069\u0073\u0065>"+"</xsl:ch\u006f\u006fse>"+"\u003c\u002fx\u0073\u006c:\u0061t\u0074\u0072i\u0062u\u0074\u0065>"+"<xsl:attribute name=\"image_enabled\">"+"\u003cxsl:cho\u006f\u0073\u0065>"+"<xsl:when test=\"../../@image_directory\">"+"<xsl:value-of select=\"concat(../../@image_directory,'/',@image)\" />"+"\u003c\u002fx\u0073l\u003aw\u0068\u0065n>"+"<x\u0073l\u003ao\u0074her\u0077\u0069se\u003e"+"<xsl:value-of select=\"@image\" />"+"<\u002fxsl\u003aot\u0068\u0065rwise\u003e"+"<\u002fxsl:\u0063\u0068o\u006fse\u003e"+"<\u002f\u0078\u0073l\u003aat\u0074\u0072\u0069b\u0075\u0074e>"+"<xsl:attribute name=\"title\">"+"<xsl:value-of select=\"@tooltip_text\" />"+"</x\u0073l\u003aattrib\u0075\u0074e>"+"<xsl:attribute name=\"onclick\">"+"<xsl:value-of select='concat(\"this.object.toggle();\",&quot;v&quot;,&quot;a&quot;,&quot;r&quot;,&quot; &quot;,&quot;e&quot;,&quot;=&quot;,&quot;&apos;&quot;,@onclick_event,&quot;&apos;&quot;,&quot;;&quot;,&quot;e&quot;,&quot;v&quot;,&quot;a&quot;,&quot;l&quot;,&quot;(&quot;,&quot;t&quot;,&quot;h&quot;,&quot;i&quot;,&quot;s&quot;,&quot;.&quot;,&quot;o&quot;,&quot;b&quot;,&quot;j&quot;,&quot;e&quot;,&quot;c&quot;,&quot;t&quot;,&quot;.&quot;,&quot;o&quot;,&quot;n&quot;,&quot;C&quot;,&quot;l&quot;,&quot;i&quot;,&quot;c&quot;,&quot;k&quot;,&quot;H&quot;,&quot;a&quot;,&quot;n&quot;,&quot;d&quot;,&quot;l&quot;,&quot;e&quot;,&quot;r&quot;,&quot;(&quot;,&quot;e&quot;,&quot;)&quot;,&quot;)&quot;,&quot;;&quot;,&apos;&apos;)' />"+"\u003c/\u0078sl\u003aa\u0074t\u0072\u0069b\u0075\u0074e\u003e"+"<xsl:attribute name=\"id\">"+"<xsl:value-of select=\"@id\" />"+"<\u002f\u0078\u0073l:at\u0074r\u0069bu\u0074\u0065\u003e"+"<xsl:attribute name=\"style\">"+"<\u0078\u0073\u006c:\u0063ho\u006fse>"+"<xsl:when test=\"../../@height\">"+"<xsl:value-of select=\"concat('float:left;width:',../../@height,'px;height:',../../@height - 1,'px')\" />"+"</\u0078sl\u003awhe\u006e>"+"\u003cxs\u006c\u003aot\u0068\u0065\u0072w\u0069se\u003e"+"<xsl:value-of select=\"concat('float:left;width:',@width,'px;height:',@height,'px')\" />"+"</\u0078sl\u003aot\u0068\u0065\u0072\u0077i\u0073e>"+"</x\u0073\u006c\u003a\u0063\u0068o\u006f\u0073\u0065>"+"\u003c\u002f\u0078s\u006c:\u0061t\u0074ribu\u0074\u0065\u003e"+"<img border=\"0\">"+"<xsl:attribute name=\"src\">"+"<x\u0073l:\u0063ho\u006fse\u003e"+"<xsl:when test=\"../../@image_directory\">"+"<xsl:value-of select=\"concat(../../@image_directory,'/',@image)\" />"+"\u003c\u002fxsl\u003awhen>"+"<x\u0073\u006c\u003ao\u0074h\u0065\u0072\u0077\u0069\u0073\u0065\u003e"+"<xsl:value-of select=\"@image\" />"+"\u003c\u002fx\u0073\u006c:\u006fthe\u0072wise>"+"</\u0078\u0073l\u003acho\u006fs\u0065>"+"<\u002fx\u0073l\u003a\u0061\u0074\u0074\u0072i\u0062\u0075\u0074e\u003e"+"<xsl:attribute name=\"style\">"+"<xsl:variable name=\"top_offset\">"+"\u003cxsl:\u0063ho\u006fs\u0065\u003e"+"<xsl:when test=\"@top_offset\">"+"<xsl:value-of select=\"@top_offset\" />"+"</xsl\u003a\u0077\u0068\u0065\u006e\u003e"+"<\u0078sl\u003a\u006fth\u0065\u0072wise\u003e"+"\u0030"+"\u003c/x\u0073\u006c:o\u0074he\u0072\u0077\u0069s\u0065>"+"\u003c\u002f\u0078\u0073\u006c\u003ac\u0068\u006fo\u0073e\u003e"+"\u003c/xsl\u003a\u0076\u0061\u0072i\u0061bl\u0065\u003e"+"\u003cx\u0073l\u003ac\u0068oo\u0073e>"+"<xsl:when test=\"../../@height\">"+"<xsl:value-of select=\"concat('MARGIN-TOP:',((../../@height - @height) div 2) - 1 + number($top_offset),'px;MARGIN-BOTTOM:0px')\" />"+"<\u002fx\u0073\u006c\u003a\u0077h\u0065n\u003e"+"\u003c\u0078\u0073\u006c\u003a\u006fth\u0065\u0072\u0077\u0069se>"+"<xsl:value-of select=\"concat('MARGIN-TOP:',(@height - @image_height) div 2,'px;MARGIN-BOTTOM:0','px')\" />"+"\u003c/\u0078sl\u003aot\u0068\u0065r\u0077i\u0073\u0065>"+"<\u002fxs\u006c:\u0063h\u006f\u006fse\u003e"+"<\u002f\u0078s\u006c\u003aat\u0074\u0072ibute\u003e"+"</\u0069mg\u003e\u003c\u0021[\u0043\u0044ATA[\u0020]]\u003e"+"<\u002f\u0064\u0069\u0076>"+"\u003c\u002f\u0078s\u006c\u003a\u0074emp\u006c\u0061\u0074\u0065\u003e"; Eba.UiBinaryStateButton=function(xml,id){ this.initialize(xml,Eba.UiBinaryStateButtonXsl,id); this.m_Checked=false; }; Eba.UiBinaryStateButton.inherits(Eba.UiButton); Eba.UiBinaryStateButton.method("is\u0043h\u0065\u0063ke\u0064",function(){ return this.m_Checked; }); Eba.UiBinaryStateButton.method("\u0063he\u0063k",function(){ var _5bd=this.getHtmlElementHandle(); _5bd.className="\u0045b\u0061Butto\u006e\u0043\u0068e\u0063k\u0065d"; this.m_Checked=true; }); Eba.UiBinaryStateButton.method("\u0075\u006e\u0063\u0068\u0065c\u006b",function(){ var _5be=this.getHtmlElementHandle(); _5be.className="Eba\u0042\u0075\u0074t\u006fn"; this.m_Checked=false; }); Eba.UiBinaryStateButton.method("\u0074o\u0067\u0067\u006ce",function(){ var _5bf=this.getHtmlElementHandle(); if(_5bf.className=="\u0045b\u0061\u0042ut\u0074on\u0043\u0068ecke\u0064"){ this.uncheck(); }else{ this.check(); } }); Eba.ToolbarXsl="<xsl:template match=\"//toolbar\">"+"<div class=\"EbaToolbar\" style=\"z-index:800\" padding=\"0px\" margin=\"0px\">"+"<xsl:attribute name=\"id\">"+"<xsl:value-of select=\"@id\" />"+"<\u002f\u0078\u0073\u006c:\u0061\u0074t\u0072\u0069b\u0075te\u003e"+"<xsl:attribute name=\"style\">"+"<xsl:value-of select=\"concat('width:',@width,'px;height:',@height,'px')\" />"+"<\u002f\u0078\u0073\u006c\u003a\u0061\u0074tr\u0069\u0062u\u0074e\u003e"+"<!-- <div id=\"ToolbarTitle\" onmousedown=\"this.dragDrop()\" ondblclick=\"this.parentNode.object.dock()\" ondragstart=\"this.parentNode.object.dragStart()\" ondragover=\"this.parentNode.object.dragOver()\"  class=\"EbaToolbarTitle\" style=\"width:100%;height:10px;position:absolute;\">Toolbar</div> "+"<div onmousedown=\"this.dragDrop()\" ondragstart=\"this.parentNode.object.dragStart()\" ondragover=\"this.parentNode.object.dragOver()\" id=\"handle\" style=\"width:10px\" class=\"EbaToolbarHandle\"></div> -->"+"\u003c\u0078\u0073l:app\u006c\u0079-t\u0065\u006d\u0070\u006c\u0061tes /\u003e"+"<\u002fd\u0069\u0076\u003e"+"<\u002f\u0078\u0073\u006c\u003a\u0074\u0065m\u0070late\u003e"+Eba.UiButtonXsl+Eba.UiBinaryStateButtonXsl+"<xsl:template match=\"separator\">"+"\u003c\u0064\u0069\u0076\u0020\u0061lig\u006e=\u0027\u0063\u0065nt\u0065r'>"+"<xsl:attribute name=\"style\">"+"<xsl:value-of select=\"concat('float:left;width:',@width,';height:',@height)\" />"+"</\u0078sl\u003aa\u0074trib\u0075te\u003e"+"<xsl:attribute name=\"id\">"+"<xsl:value-of select=\"@id\" />"+"\u003c/xs\u006c:\u0061tt\u0072\u0069\u0062\u0075te>"+"\u003c\u0069\u006dg\u0020bo\u0072\u0064\u0065\u0072=\u00270\u0027\u003e"+"<xsl:attribute name=\"src\">"+"<xsl:value-of select=\"concat(//@image_directory,'/',@image)\" />"+"\u003c\u002f\u0078s\u006c\u003a\u0061\u0074\u0074\u0072\u0069b\u0075t\u0065>"+"<xsl:attribute name=\"style\">"+"<xsl:value-of select=\"concat('MARGIN-TOP:3','px;MARGIN-BOTTOM:0','px')\" />"+"\u003c\u002fxs\u006c:\u0061\u0074t\u0072\u0069b\u0075\u0074\u0065>"+"\u003c\u002fimg\u003e"+"</\u0064iv\u003e"+"\u003c/\u0078\u0073l\u003atemplat\u0065>"; Eba.Toolbar=function(xml,id){ this.initialize(xml,Eba.ToolbarXsl,id); }; Eba.Toolbar.inherits(Eba.InteractiveUiElement); Eba.Toolbar.method("g\u0065\u0074\u0055i\u0045\u006c\u0065m\u0065\u006et\u0073",function(){ return this.m_UiElements; }); Eba.Toolbar.method("\u0073e\u0074\u0055\u0069El\u0065me\u006e\u0074s",function(_5c2){ this.m_UiElements=_5c2; }); Eba.Toolbar.method("at\u0074\u0061ch\u0042\u0075\u0074\u0074onOb\u006a\u0065\u0063ts",function(){ if(!this.m_UiElements){ this.m_UiElements=new Array(); var tag=this.getHtmlElementHandle(); var _5c4=tag.childNodes; for(var i=0;i<_5c4.length;i++){ var child=_5c4[i]; if(child.nodeType!=3){ var _5c6; switch(child.className){ case ("EbaButt\u006fn"): _5c6=new Eba.UiButton(null,child.id); break; case ("\u0045baB\u0069na\u0072yS\u0074\u0061teBu\u0074t\u006f\u006e"): _5c6=new Eba.UiBinaryStateButton(null,child.id); break; default: _5c6=new Eba.UiElement(null,null,child.id); break; } _5c6.attachToTag(); this.m_UiElements[child.id]=_5c6; } } } }); Eba.Toolbar.method("r\u0065nd\u0065\u0072",function(_5c7){ this.uber("r\u0065n\u0064\u0065r",_5c7); this.attachButtonObjects(); }); Eba.Toolbar.method("\u0064\u0069s\u0061\u0062\u006ce",function(){ for(var i in this.m_UiElements){ if(this.m_UiElements[i].disable){ this.m_UiElements[i].disable(); } } }); Eba.Toolbar.method("\u0065\u006e\u0061\u0062le",function(){ for(var i in this.m_UiElements){ if(this.m_UiElements[i].enable){ this.m_UiElements[i].enable(); } } }); Eba.Toolbar.method("\u0061ttac\u0068ToT\u0061\u0067",function(){ this.uber("at\u0074\u0061\u0063\u0068\u0054o\u0054ag"); this.attachButtonObjects(); }); Eba.Toolbar.method("dr\u0061\u0067\u0053\u0074\u0061\u0072\u0074",function(){ var tag=this.getHtmlElementHandle(); tag.style.position="\u0061\u0062\u0073ol\u0075t\u0065"; var This=this; Eba.Toolbar_DragOver=function(){ This.dragOver(); }; Eba.Toolbar_DragStop=function(){ This.dragStop(); }; document.attachEvent("\u006f\u006emous\u0065mo\u0076\u0065",Eba.Toolbar_DragOver); document.attachEvent("\u006fn\u006d\u006f\u0075\u0073\u0065\u0075p",Eba.Toolbar_DragStop); window.event.cancelBubble=true; window.event.returnValue=false; var _5cc=tag.childNodes[0].style; _5cc.visibility="\u0076i\u0073\u0069bl\u0065"; _5cc.position=""; tag.style.height="4\u0030px"; tag.className="\u0045\u0062aT\u006folba\u0072\u0046\u006coati\u006eg"; }); Eba.Toolbar.method("d\u0072\u0061gO\u0076e\u0072",function(){ var x,y; var tag=this.getHtmlElementHandle(); x=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft; y=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop; tag.style.top=y-12; tag.style.left=x-5; window.event.cancelBubble=true; window.event.returnValue=false; }); Eba.Toolbar.method("dr\u0061\u0067S\u0074\u006f\u0070",function(){ document.detachEvent("on\u006douse\u006dov\u0065",Eba.Toolbar_DragOver); document.detachEvent("\u006fn\u006dou\u0073eup",Eba.Toolbar_DragStop); }); Eba.Toolbar.method("d\u006f\u0063k",function(){ var tag=this.getHtmlElementHandle(); tag.style.position=""; tag.style.height="\u00323px"; tag.style.border=""; tag.className="Eba\u0054\u006folbar"; var _5d0=tag.childNodes[0].style; _5d0.position="\u0061\u0062so\u006cu\u0074e"; _5d0.visibility="\u0068idden"; }); function EBAFeedbackPanel(_5d1,_5d2,_5d3,_5d4){ var _5d5=this; var _5d6; this.clearForm=function(){ setTimeout("d\u006f\u0063\u0075m\u0065\u006et.getEl\u0065men\u0074\u0042\u0079Id\u0028\u0027\u0045\u0042AD\u0065b\u0075\u0067\u0046o\u0072m\u0044\u0069v\u0027\u0029\u002e\u0073\u0074y\u006c\u0065.\u0064\u0069sp\u006c\u0061\u0079\u0020=\u0020'\u006eon\u0065\u0027; do\u0063u\u006d\u0065\u006et\u002eg\u0065t\u0045l\u0065\u006d\u0065\u006e\u0074B\u0079\u0049d\u0028'EBA\u0044eb\u0075gF\u006fr\u006dCo\u006d\u0070l\u0065te\u0044i\u0076'\u0029.s\u0074y\u006ce\u002edis\u0070\u006c\u0061\u0079\u0020= \u0027bloc\u006b'\u003b",1); }; this.toggle=function(){ if(this.FeedbackPanelState){ this.clear(); this.collapse(); }else{ this.clear(); this.expand(); } clearTimeout(this.bumpId); }; this.populate=function(){ var _5d7=105; var _5d8="<table cellpadding=0 cellspacing=0 width=\""+this.DefaultWidth+"\" style=\"margin: 0px; padding: 0px; font-family: Trebuchet MS, Tahoma, Verdana, Arial; font-size: 14px; color: #666666;\">"; _5d8+="<tr><td style=\"padding-left: 25px; padding-right: 28px; padding-top: 90px; cursor: default; margin: 0px;\" height=150 valign=top>"; _5d8+="<div id=EBADebugFormCompleteDiv style=\"display: none;\">Your feedback has been sent.<br><br>Thanks for participating! Feel free to submit more feedback later.<br><br><button style=\"width: 80px; height: 25px;  margin-top: 15px; cursor: pointer;\" onclick=\""+_5d1+".toggle()\">Close</button></div><div id=EBADebugFormDiv>"; _5d8+="Be\u0020p\u0061r\u0074 of\u0020t\u0068e c\u006fn\u0076e\u0072s\u0061\u0074\u0069\u006f\u006e\u0021\u0020H\u0065\u006cp u\u0073 bui\u006cd a b\u0065tte\u0072 \u0073olut\u0069\u006fn\u0020\u0062y \u0073e\u006eding us \u0079\u006fur\u0020c\u006f\u006d\u006d\u0065nt\u0073\u0020\u0061\u006e\u0064\u0020d\u0065\u0062u\u0067 d\u0061\u0074\u0061. \u0053\u0065\u006ed\u0020\u0061\u0073 m\u0061ny\u0020a\u006ed \u0061s \u006f\u0066\u0074en a\u0073 \u0079o\u0075\u0020l\u0069ke\u0021\u003cb\u0072\u003e<br\u003e\u0041ll\u0020\u0066ield\u0073\u0020\u0061\u0072e \u006fp\u0074\u0069o\u006e\u0061l\u002e\u003cb\u0072><b\u0072\u003e"; if(this.SurveyLink.length>3){ _5d8+="Also, fill out our optional <a href=\""+this.SurveyLink+"\" target=\"_blank\"><img src=\"http://developer.ebusiness-apps.com/images/fpanel/extlink.gif\" border=0 width=13 height=7> feedback survey</a> to contribute your thoughts to the process!<br><br>"; _5d7=53; } _5d8+="<font color=#000000><b>Email:</b></font> <input type=\"text\" maxlength=\"100\" name=\"Email\" style=\"width:200px; height:18px; margin-bottom:0px;  font-family: Trebuchet MS, Tahoma; font-size: 14px; border: 1px dotted #CCCCCC; color: #333333;\"><br><br>"; _5d8+="<font color=#000000><b>Comments, suggested features, or bugs encountered:</b></font><br><textarea name=\"Comments\" style=\"width:250px; height:"+_5d7+"px; font-family: Trebuchet MS, Tahoma; font-size: 14px; border: 1px dotted #CCCCCC; color: #333333;\"></textarea><br>"; _5d8+="<input type=Checkbox name=\"SendDebug\" style=\" border: 0px solid #666666;\" checked> <font color=#000000><b>Send debug information!</b></font> <a href=\"#\" onclick=\"alert(document.EBADebugForm['EBADebugInfoData'].value)\">[View it]</a><br>"; _5d8+="<input type=submit name=\"SubmitForm\" value=\"Submit\" style=\"width: 80px; height: 25px;  margin-top: 15px; cursor: pointer;  border: 1px solid #666666;\">&nbsp;"; _5d8+="<button style=\"width: 80px; height: 25px;  margin-top: 15px; cursor: pointer; border: 1px solid #666666;\" onclick=\""+_5d1+".toggle()\">Cancel</button>"; _5d8+="\u003c\u002fd\u0069v\u003e"; _5d8+="\u003c\u002f\u0074\u0064\u003e<\u002ft\u0072>"; _5d8+="<\u002f\u0074abl\u0065\u003e"; _5d8+="<img src=\"http://developer.ebusiness-apps.com/images/fpanel/collapsepanel.gif\" width=129 height=129 style=\"position: absolute; top: "+(parseInt(this.DefaultHeight)-130)+"\u0070x;\u0020le\u0066\u0074\u003a "+(parseInt(this.DefaultWidth)-130)+"px;\" onclick=\""+_5d1+".toggle()\">"; this.feedbackPanel.innerHTML=_5d8; }; this.clear=function(){ this.feedbackPanel.innerHTML="&n\u0062s\u0070;"; }; this.collapse=function(){ if(Math.round(this.CurrentWidth)>Math.round(this.CollapseWidth)){ this.CurrentWidth=this.CurrentWidth-((this.CurrentWidth-this.CollapseWidth)/5); this.CurrentHeight=this.CurrentHeight-((this.CurrentHeight-this.CollapseHeight)/5); this.feedbackPanel.style.width=this.CurrentWidth+"\u0070\u0078"; this.feedbackPanel.style.height=this.CurrentHeight+"\u0070\u0078"; this.feedbackPanel.style.opacity=(this.DefaultOpacity+(this.CurrentWidth/this.DefaultWidth)*(1-this.DefaultOpacity)); this.feedbackPanel.style.filter="\u0061lph\u0061\u0028\u006f\u0070a\u0063ity\u003d"+((this.DefaultOpacity+(this.CurrentWidth/this.DefaultWidth)*(1-this.DefaultOpacity))*100)+"\u0029"; this.intervalId=setTimeout(function(){ _5d5.collapse(); },20); }else{ clearTimeout(this.intervalId); this.feedbackPanel.innerHTML="<img src=\"http://developer.ebusiness-apps.com/images/fpanel/expandpanel.gif\" style=\"padding: 0px; margin: 0px; position: absolute; top: 10px; left: 10px;\">"; this.feedbackPanel.onmousedown=function(){ _5d5.toggle(); }; this.FeedbackPanelState=false; } }; this.expand=function(){ if(Math.round(this.CurrentWidth)<Math.round(this.DefaultWidth)){ this.CurrentWidth=this.CurrentWidth+((this.DefaultWidth-this.CurrentWidth)/5); this.CurrentHeight=this.CurrentHeight+((this.DefaultHeight-this.CurrentHeight)/5); this.feedbackPanel.style.width=this.CurrentWidth+"px"; this.feedbackPanel.style.height=this.CurrentHeight+"p\u0078"; this.feedbackPanel.style.opacity=(this.DefaultOpacity+(this.CurrentWidth/this.DefaultWidth)*(1-this.DefaultOpacity)); this.feedbackPanel.style.filter="a\u006c\u0070ha\u0028o\u0070\u0061\u0063\u0069\u0074\u0079\u003d"+((this.DefaultOpacity+(this.CurrentWidth/this.DefaultWidth)*(1-this.DefaultOpacity))*100)+")"; this.intervalId=setTimeout(function(){ _5d5.expand(); },20); }else{ clearTimeout(this.intervalId); this.FeedbackPanelState=true; this.feedbackPanel.onmousedown=""; this.populate(); } }; this.appendDebugInfo=function(_5d9){ document.EBADebugForm["\u0045\u0042A\u0044\u0065\u0062\u0075\u0067\u0049\u006efoDat\u0061"].value+="\u005b"+(this.DebugLine++)+"\u005d "+_5d9+"\n"; }; this.checkPermission=function(){ if(!document.EBADebugForm["\u0053\u0065n\u0064De\u0062\u0075g"].checked){ document.EBADebugForm["\u0045\u0042AD\u0065\u0062u\u0067I\u006ef\u006f\u0044at\u0061"].value="\u0050\u0065r\u006d\u0069ss\u0069\u006f\u006e t\u006f\u0020\u0074rans\u006di\u0074\u0020\u0064\u0065\u0062ug\u0020\u006e\u006ft\u0020\u0067\u0069v\u0065\u006e."; } }; this.appear=function(){ if(this.InitOpacity<this.DefaultOpacity){ this.InitOpacity+=0.05; setTimeout(function(){ _5d5.appear(); },75); }else{ this.InitOpacity=this.DefaultOpacity; this.bumpId=setTimeout(function(){ _5d5.bump(); },5000); } this.feedbackPanel.style.opacity=this.InitOpacity; this.feedbackPanel.style.filter="\u0061\u006c\u0070\u0068\u0061\u0028opa\u0063\u0069t\u0079="+(this.InitOpacity*100)+")"; }; this.bump=function(){ if(this.BumpIndex<100){ this.BumpIndex+=5; this.CurrentWidth=((this.BumpIndex/100)*this.BumpDistance)+this.CollapseWidth; this.CurrentHeight=((this.BumpIndex/100)*this.BumpDistance)+this.CollapseHeight; this.CurrentWidth=this.CollapseWidth+(this.BumpDistance*Math.sin((this.BumpIndex/100)*3.1415927)); this.CurrentHeight=this.CollapseHeight+(this.BumpDistance*Math.sin((this.BumpIndex/100)*3.1415927)); this.feedbackPanel.style.width=this.CurrentWidth+"px"; this.feedbackPanel.style.height=this.CurrentHeight+"\u0070\u0078"; this.feedbackPanel.style.opacity=(this.DefaultOpacity+(Math.sin((this.BumpIndex/100)*3.1415927))*(1-this.DefaultOpacity)); this.feedbackPanel.style.filter="a\u006cpha\u0028\u006fpac\u0069ty\u003d"+((this.DefaultOpacity+(Math.sin((this.BumpIndex/100)*3.1415927))*(1-this.DefaultOpacity))*100)+"\u0029"; document.getElementById("e\u0062\u0061_e\u0078p\u0061\u006e\u0064\u0050a\u006e\u0065l").style.top=10+(Math.sin((this.BumpIndex/100)*3.1415927)*this.BumpDistance)+"\u0070\u0078"; document.getElementById("eb\u0061\u005fex\u0070\u0061\u006edPane\u006c").style.left=10+(Math.sin((this.BumpIndex/100)*3.1415927)*this.BumpDistance)+"\u0070\u0078"; if(this.BumpIndex<100){ this.bumpId=setTimeout(function(){ _5d5.bump(); },20); }else{ this.BumpIndex=0; this.bumpId=setTimeout(function(){ _5d5.bump(); },45000); } } }; var _5da="<iframe frameborder=0 id=EBAFormPostIframe name=EBAFormPostIframe style=\"width:1px; height: 1px; position: absolute; top: 1px; left: 1px; padding: 0px;\"></iframe><img src=\"http://developer.ebusiness-apps.com/images/fpanel/panelback.gif\" width=1 height=1 style=\"position: absolute; top:0px; left:0px;\"><img id=\"eba_collapsePanel\" src=\"http://developer.ebusiness-apps.com/images/fpanel/collapsepanel.gif\" width=1 height=1 style=\"position: absolute; top:1px; left:1px;\"><form method=post onsubmit=\""+_5d1+"\u002echeck\u0050e\u0072mi\u0073s\u0069on()\u003b\u0020"+_5d1+".clearForm(); \" action=\"http://labs.ebusiness-apps.com/ebafeedback/feedbacksubmit.asp\" target=\"EBAFormPostIframe\" id=EBADebugForm name=EBADebugForm style=\"margin: 0px; padding: 0px;\"><input type=hidden name=EBADebugInfoData value=\"\"><div id='EBAFeedbackPanelDiv' onmousedown='"+_5d1+".toggle()' style=\"z-index: 5000; background-image: url('http://developer.ebusiness-apps.com/images/fpanel/panelback.gif');  background-position: bottom right; width: 140px; height: 140px; position: absolute; top: 1px; left: 1px; cursor: pointer; font-family: Trebuchet MS, Tahoma, Verdana, Arial; font-size: 14px; color: #666666; margin: 0px; padding: 0px;\"><img id=\"eba_expandPanel\" src=\"http://developer.ebusiness-apps.com/images/fpanel/expandpanel.gif\" style=\"padding: 0px; position: absolute; top: 10px; left: 10px; margin: 0px;\"></div></form>"; this.feedbackContainer=document.createElement("\u0064\u0069v"); this.feedbackContainer.innerHTML=_5da; this.feedbackContainer.setAttribute("\u0069\u0064","EBAF\u0065\u0065\u0064b\u0061\u0063\u006bCo\u006et\u0061in\u0065r\u0044i\u0076"); this.feedbackContainer.object=this; document.getElementsByTagName("\u0062\u006f\u0064y").item(0).appendChild(this.feedbackContainer); this.feedbackPanel=document.getElementById("EB\u0041Fe\u0065db\u0061\u0063\u006b\u0050\u0061nel\u0044i\u0076"); this.FeedbackPanelState=false; this.DefaultWidth=434; this.DefaultHeight=473; this.CollapseWidth=140; this.CollapseHeight=140; this.CurrentWidth=140; this.CurrentHeight=140; this.DefaultOpacity=0.9; this.InitOpacity=0; this.SurveyLink=_5d4; this.PanelVersion=1.01; this.DebugLine=0; this.BumpIndex=0; this.BumpDistance=40; this.feedbackPanel.style.opacity=this.InitOpacity; this.feedbackPanel.style.filter="alp\u0068\u0061\u0028opacit\u0079\u003d"+(this.InitOpacity*100)+"\u0029"; this.appendDebugInfo("Pr\u006f\u0064\u0075ct \u004ea\u006de\u003a "+_5d2); this.appendDebugInfo("\u0050\u0072o\u0064uc\u0074\u0020V\u0065rs\u0069on: "+_5d3); this.appendDebugInfo("C\u0075\u0072ren\u0074\u0020\u0055RL\u003a\u0020"+window.location.href); this.appendDebugInfo("ap\u0070Co\u0064\u0065\u004e\u0061\u006de\u003a "+navigator.appCodeName); this.appendDebugInfo("\u0061\u0070\u0070\u004e\u0061m\u0065\u003a\u0020"+navigator.appName); this.appendDebugInfo("a\u0070p\u004d\u0069\u006eorV\u0065\u0072sio\u006e\u0020\u003a "+navigator.appMinorVersion); this.appendDebugInfo("app\u0056e\u0072\u0073ion : "+navigator.appVersion); this.appendDebugInfo("\u0063\u006fok\u0069\u0065\u0045\u006e\u0061\u0062\u006ce\u0064\u0020\u003a "+navigator.cookieEnabled); this.appendDebugInfo("\u0070l\u0061t\u0066\u006fr\u006d \u0020\u003a\u0020"+navigator.platform); this.appendDebugInfo("c\u0070uCl\u0061s\u0073 \u0020: "+navigator.cpuClass); this.appendDebugInfo("\u0075\u0073e\u0072\u0041g\u0065nt \u0020 \u003a "+navigator.userAgent); setTimeout(function(){ _5d5.appear(); },10); } gIE=!Boolean(document.addEventListener); Eba.startDrag=function(_5db,_5dc,_5dd,_5de,_5df,_5e0){ var ddo=new Eba.DragDrop(_5db,_5dc,_5dd,_5de,_5df,_5e0); _5db.dragObject=ddo; }; Eba.DragDrop=function(_5e2,_5e3,_5e4,_5e5,_5e6,_5e7){ this.allowVertDrag=(_5e4!=null?_5e4:true); this.allowHorizDrag=(_5e5!=null?_5e5:true); this.context=_5e6; this.onMouseUpEvent=_5e7; if(_5e2.nodeType==3){ alert("\u0054ex\u0074\u0020\u006e\u006f\u0064\u0065\u0020\u006e\u006ft\u0020\u0073\u0075\u0070\u0070or\u0074\u0065d\u002e U\u0073\u0065\u0020\u0070\u0061re\u006et\u0020elemen\u0074"); } this.element=_5e2; this.zIndex=_5e2.style.zIndex; _5e2.style.zIndex=900; if(gIE){ x=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft; y=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop; }else{ x=_5e3.clientX+window.scrollX; y=_5e3.clientY+window.scrollY; } this.elementOriginTop=parseInt(_5e2.style.top,10); this.elementOriginLeft=parseInt(_5e2.style.left,10); if(isNaN(this.elementOriginLeft)){ this.elementOriginLeft=0; } if(isNaN(this.elementOriginTop)){ this.elementOriginTop=0; } this.originX=x; this.originY=y; var _5e8=this; this.onMouseUpHandle=function(_5e9){ _5e8.onMouseUp.call(_5e8,_5e9); }; this.onMouseMoveHandle=function(_5ea){ _5e8.onMouseMove.call(_5e8,_5ea); }; if(gIE){ document.attachEvent("onm\u006fu\u0073e\u0075p",this.onMouseUpHandle); document.attachEvent("on\u006d\u006f\u0075\u0073\u0065\u006d\u006fve",this.onMouseMoveHandle); window.event.cancelBubble=true; window.event.returnValue=false; }else{ document.addEventListener("\u006d\u006f\u0075seu\u0070",this.onMouseUpHandle,true); document.addEventListener("m\u006f\u0075\u0073e\u006dove",this.onMouseMoveHandle,true); _5e3.preventDefault(); } }; Eba.DragDrop.prototype.onMouseMove=function(_5eb){ var x,y; if(gIE){ x=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft; y=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop; }else{ x=_5eb.clientX+window.scrollX; y=_5eb.clientY+window.scrollY; } if(this.allowHorizDrag){ this.element.style.left=(this.elementOriginLeft+x-this.originX)+"\u0070x"; } if(this.allowVertDrag){ this.element.style.top=(this.elementOriginTop+y-this.originY)+"\u0070x"; } this.x=x; this.y=y; if(gIE){ window.event.cancelBubble=true; window.event.returnValue=false; }else{ _5eb.preventDefault(); } }; Eba.DragDrop.prototype.onMouseUp=function(_5ed){ if(this.onMouseUpEvent!=null){ this.onMouseUpEvent.call(this.context,this.x,this.y); } if(gIE){ document.detachEvent("on\u006d\u006f\u0075\u0073e\u006d\u006f\u0076e",this.onMouseMoveHandle); document.detachEvent("\u006f\u006emou\u0073e\u0075\u0070",this.onMouseUpHandle); }else{ document.removeEventListener("\u006d\u006f\u0075\u0073e\u006do\u0076\u0065",this.onMouseMoveHandle,true); document.removeEventListener("\u006d\u006fu\u0073\u0065\u0075p",this.onMouseUpHandle,true); } this.element.style.zIndex=this.zIndex; this.element.object=null; this.element=null; };